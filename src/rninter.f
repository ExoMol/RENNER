      SUBROUTINE INTPM0 ( ROTSYM , ROTASY , VALSYM , VALASY ,
     1			  COSGM  , SINGM  , DGKDR  ,
     1                    PHIL   , DERL   , PHIR   , DERR   ,
     1                    AMLZ11 , AMLZ22 , AMLZ12 ,
     3                    ACCARR , SPOARR , NFILST , V2MP11 , V2MP12 ,
     1                    KFSYM0 , KFASY0 , KFSYMJ , KFASYJ ,
     1                    LENACC , NUMSYM , NUMASY , NZERSY , NZERAS ,
     1                    LENASO , ISPOSY , ISPOAS , NSPOSY , NSPOAS,
     2                    DIPAC,LENDIP,
     3                    NFAB0,
     4                    NDIPSY,NDIPAS )

C
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10)
C
      REAL*8 DIPAC(LENDIP),
     1       DSYMM(9,2),
     1       DASYM(6,2)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, V2MP11 , V2MP12 ,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      REAL*8 VSYMM(9,2),VASYM(6,2)

      INTEGER NOBAS,MBASP1,LENIW
      INTEGER I,L,LENINT,LENVAL,LENREC,NPHI,INDRC ,
     1       NORECS , ILEN ,ISHFT, JMAXPNS, NSTINT2
      REAL*8 PHIL(NSTINT),
     1   AMLZ11(NSTINT) , AMLZ22(NSTINT) , AMLZ12(NSTINT) ,
     1   DERL(NSTINT),PHIR(NSTINT),DERR(NSTINT),
     1   COSGM(NSTINT*JMAXP1),SINGM(NSTINT*JMAXP1),
     1   DGKDR(NSTINT*JMAXP1),SPOARR(LENASO),
     1   VALSYM(KFSYM0),VALASY(KFASY0),ROTSYM(KFSYMJ),ROTASY(KFASYJ)
      REAL*8  SUM01,SUM02,SUM03,SUM04,SUM05,SUM06,SUM07,SUM08,SUM09,
     1 SUM10,SUM11,SUM12,SUM13,SUM14,SUM15,SUM16,SUM17,SUM18,SUM19,
     2 SUM20,SUM21,SUM22,SUM23,SUM24,SUM25,SUM26,SUM27,SUM28,SUM29,
     3 SUM30,SUM31,ACCARR(LENACC),DER(4),EREST(4)
      REAL*8 FACODD,FACEVE
      INTEGER INDEX1,INDEX2,
     1       IOFFS,IOFFS0,IEND,JOFFS,KOFFSO,KOFFSE,NFCT
C
      include 'isotop.h'
      include 'value.h'
      include 'lzcomp.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9001)
      FACODD=2.0D+00*HSTEP/3.0D+00
      FACEVE=4.0D+00*HSTEP/3.0D+00
C
C READ IN RHO-DEPENDENT FUNCTION VALUES
C
      REWIND NFIL1
      REWIND NFIL3
      READ (NFIL1) (VALSYM(L), L=1,KFSYM0)
      READ (NFIL3) (ROTSYM(L), L=1,KFSYMJ)
      IF (.NOT.SYMM) THEN
          REWIND NFIL2
          READ (NFIL2) (VALASY(L), L=1,KFASY0)
          REWIND NFIL4
          READ (NFIL4) (ROTASY(L), L=1,KFASYJ)
      ENDIF
      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL49
      READ (NFIL46) (COSGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL47) (SINGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL49) (DGKDR(L), L=1,JMAXP1*NSTINT)
C
C
C CALCULATE RHO-DEPENDENT EXPECTATION VALUE FOR THE Z-COMPONENT
C OF THE ELECTRONIC ANGULAR MOMENTUM
C
      XLASQ=XLAMB*XLAMB
      DO 800 I=1,NSTINT
      RHO=DFLOAT(I)*HSTEP
      CORANG=1.0D+00-COS(RHO)
      AMLZ11(I)=XLASQ-(((XLZ14*CORANG+XLZ13)*CORANG+XLZ12)*CORANG
     1         +XLZ11)*CORANG
      AMLZ22(I)=XLASQ-(((XLZ24*CORANG+XLZ23)*CORANG+XLZ22)*CORANG
     1         +XLZ21)*CORANG
800   AMLZ12(I)=XLAMB-(((XLZI4*CORANG+XLZI3)*CORANG+XLZI2)*CORANG
     1         +XLZI1)*CORANG
C
C
C START LOOP OVER K FOR CALCULATING DELTAK=0 MATRIX ELEMENTS
C
      NUMSYM=0
C
      CONPSE=(PLANCK*AVOGNO*1.0D+16)/(8.0D+00*PI*PI*VELLGT)
C
      DO 1410 KP1=1,JMAXP1
      KVAL = KP1 - 1
      INDB=KVAL*NSTINT
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 1400 INDEX1=1,V2MP11
C
      IREC1=(KP1-1)*V2MP11+INDEX1
      READ (NFIL7,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 1200 INDEX2=1,V2MP12
C
      IREC2=(KP1-1)*V2MP12+INDEX2
      READ (NFIL28,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      ZUM01=0.0D+00
      ZUM02=0.0D+00
      ZUM03=0.0D+00
      ZUM04=0.0D+00
      ZUM05=0.0D+00
      ZUM06=0.0D+00
      ZUM07=0.0D+00
      ZUM08=0.0D+00
      ZUM09=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
      SUM36=0.0D+00
      SUM37=0.0D+00
      SUM38=0.0D+00
      SUM39=0.0D+00
      SUM40=0.0D+00
      SUM41=0.0D+00
      SUM42=0.0D+00
      SUM43=0.0D+00
      SUM44=0.0D+00
      SUM45=0.0D+00
C
      SUM46=0.0D+00
      SUM47=0.0D+00
      SUM48=0.0D+00
      SUM49=0.0D+00
      SUM50=0.0D+00
      SUM51=0.0D+00
      SUM52=0.0D+00
      SUM53=0.0D+00
      SUM54=0.0D+00
C
      DO 1100 I=1,NSTINT,2
      INDR=INDB+I
        SQUAKO=COSGM(INDR)*SINGM(INDR)*(AMLZ22(I)-AMLZ11(I))
     1        +2.0D+00*(COSGM(INDR)**2-SINGM(INDR)**2)*AMLZ12(I)
     1        *(KP1-1)
        SQUAKE=COSGM(INDR+1)*SINGM(INDR+1)*(AMLZ22(I+1)-AMLZ11(I+1))
     1        +2.0D+00*(COSGM(INDR+1)**2-SINGM(INDR+1)**2)*AMLZ12(I+1)
     1        *(KP1-1)
      IOFFS1=(I-1)*NFSYM0
      IOFFS2=(I-1)*NFSYMJ
      IOFFA1=(I-1)*NFASY0
      DO 833 IPT=1,2
      IOFFSS=IOFFS1+(IPT-1)*NFSYM0
      IOFFAA=IOFFA1+(IPT-1)*NFASY0
      RHO=DFLOAT(I+IPT-1)*HSTEP
      CANG=1.0D+00-COS(RHO)
      VA =  (((((((GA8*CANG+GA7)*CANG+GA6)*CANG+GA5)*CANG
     1      +GA4)*CANG+GA3)*CANG+GA2)*CANG+GA1)*CANG
      VB =  (((((((HA8*CANG+HA7)*CANG+HA6)*CANG+HA5)*CANG
     1     +HA4)*CANG+HA3)*CANG+HA2)*CANG+HA1)*CANG
      VSYMM(1,IPT)=COSGM(INDR+IPT-1)*SINGM(INDR+IPT-1)*(VB-VA)
      DO 826 LL=2,9
826   VSYMM(LL,IPT)=COSGM(INDR+IPT-1)*SINGM(INDR+IPT-1)
     1             *(VALSYM(IOFFSS+17+LL)-VALSYM(IOFFSS+ 9+LL))
C
      DO 827 LL=1,9
        DSYMM(LL,IPT)=COSGM(INDR+IPT-1)*SINGM(INDR+IPT-1)
     1               *(-VALSYM(IOFFSS+48+LL)+VALSYM(IOFFSS+57+LL))
827   CONTINUE
      IF (.NOT.SYMM) THEN 
        DO 828 LL=1,6
        DASYM(LL,IPT)=COSGM(INDR+IPT-1)*SINGM(INDR+IPT-1) 
     1               *(-VALASY(IOFFAA+35+LL)+VALASY(IOFFAA+41+LL))
828     CONTINUE      
      ENDIF       
C
      IF (SYMM) THEN
         CALL TR15SA(DSYMM(1,IPT))
      ELSE
         CALL TR15A(DSYMM(1,IPT),DASYM(1,IPT))
      ENDIF
C
833   CONTINUE
C
      SOO=-FACODD*(COSGM(INDR)**2-SINGM(INDR)**2)*AMLZ12(I)
      SOE=-FACEVE*(COSGM(INDR+1)**2-SINGM(INDR+1)**2)*AMLZ12(I+1)
      FO1=-FACODD*COSGM(INDR)*SINGM(INDR)
      FE1=-FACEVE*COSGM(INDR+1)*SINGM(INDR+1)
      SUM01=SUM01+FACODD*VALSYM(IOFFS1+ 1)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 1+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM02=SUM02+FACODD*VALSYM(IOFFS1+ 2)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 2+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM03=SUM03+FACODD*VALSYM(IOFFS1+ 3)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 3+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM04=SUM04+FACODD*VALSYM(IOFFS1+ 4)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 4+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM05=SUM05+FACODD*VALSYM(IOFFS1+ 5)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 5+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM06=SUM06+FACODD*VALSYM(IOFFS1+ 6)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 6+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM07=SUM07+FACODD*VALSYM(IOFFS1+ 7)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 7+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM08=SUM08+FACODD*VALSYM(IOFFS1+ 8)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 8+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM09=SUM09+FACODD*VALSYM(IOFFS1+ 9)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 9+NFSYM0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM10=SUM10+FACODD*PHIL(I  )*VSYMM(1,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(1,2)*PHIR(I+1)
      SUM11=SUM11+FACODD*PHIL(I  )*VSYMM(2,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(2,2)*PHIR(I+1)
      SUM12=SUM12+FACODD*PHIL(I  )*VSYMM(3,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(3,2)*PHIR(I+1)
      SUM13=SUM13+FACODD*PHIL(I  )*VSYMM(4,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(4,2)*PHIR(I+1)
      SUM14=SUM14+FACODD*PHIL(I  )*VSYMM(5,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(5,2)*PHIR(I+1)
      SUM15=SUM15+FACODD*PHIL(I  )*VSYMM(6,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(6,2)*PHIR(I+1)
      SUM16=SUM16+FACODD*PHIL(I  )*VSYMM(7,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(7,2)*PHIR(I+1)
      SUM17=SUM17+FACODD*PHIL(I  )*VSYMM(8,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(8,2)*PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*VSYMM(9,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(9,2)*PHIR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+19)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+19+NFSYMJ)
     1          *PHIR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+20)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+20+NFSYMJ)
     2          *PHIR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+21)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+21+NFSYMJ)
     2          *PHIR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+22)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+22+NFSYMJ)
     2          *PHIR(I+1)
      SUM23=SUM23+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+23)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+23+NFSYMJ)
     2          *PHIR(I+1)
      SUM24=SUM24+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+24)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+24+NFSYMJ)
     2          *PHIR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+25)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+25+NFSYMJ)
     2          *PHIR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+26)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+26+NFSYMJ)
     2          *PHIR(I+1)
      SUM27=SUM27+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+27)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+27+NFSYMJ)
     2          *PHIR(I+1)
      IF (KP1 .EQ. 2) THEN
      ZUM01=ZUM01+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 1)-ROTSYM(IOFFS2+10))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 1+NFSYMJ)-ROTSYM(IOFFS2+10+NFSYMJ))
      ZUM02=ZUM02+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 2)-ROTSYM(IOFFS2+11))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 2+NFSYMJ)-ROTSYM(IOFFS2+11+NFSYMJ))
      ZUM03=ZUM03+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 3)-ROTSYM(IOFFS2+12))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 3+NFSYMJ)-ROTSYM(IOFFS2+12+NFSYMJ))
      ZUM04=ZUM04+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 4)-ROTSYM(IOFFS2+13))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 4+NFSYMJ)-ROTSYM(IOFFS2+13+NFSYMJ))
      ZUM05=ZUM05+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 5)-ROTSYM(IOFFS2+14))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 5+NFSYMJ)-ROTSYM(IOFFS2+14+NFSYMJ))
      ZUM06=ZUM06+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 6)-ROTSYM(IOFFS2+15))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 6+NFSYMJ)-ROTSYM(IOFFS2+15+NFSYMJ))
      ZUM07=ZUM07+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 7)-ROTSYM(IOFFS2+16))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 7+NFSYMJ)-ROTSYM(IOFFS2+16+NFSYMJ))
      ZUM08=ZUM08+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 8)-ROTSYM(IOFFS2+17))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 8+NFSYMJ)-ROTSYM(IOFFS2+17+NFSYMJ))
      ZUM09=ZUM09+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 9)-ROTSYM(IOFFS2+18))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 9+NFSYMJ)-ROTSYM(IOFFS2+18+NFSYMJ))
      ENDIF
      SUM28=SUM28+SOO*PHIL(I)*VALSYM(IOFFS1+40)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+40+NFSYM0)*PHIR(I)
      SUM29=SUM29+SOO*PHIL(I)*VALSYM(IOFFS1+41)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+41+NFSYM0)*PHIR(I)
      SUM30=SUM30+SOO*PHIL(I)*VALSYM(IOFFS1+42)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+42+NFSYM0)*PHIR(I)
      SUM31=SUM31+SOO*PHIL(I)*VALSYM(IOFFS1+43)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+43+NFSYM0)*PHIR(I)
      SUM32=SUM32+SOO*PHIL(I)*VALSYM(IOFFS1+44)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+44+NFSYM0)*PHIR(I)
      SUM33=SUM33+SOO*PHIL(I)*VALSYM(IOFFS1+45)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+45+NFSYM0)*PHIR(I)
      SUM34=SUM34+SOO*PHIL(I)*VALSYM(IOFFS1+46)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+46+NFSYM0)*PHIR(I)
      SUM35=SUM35+SOO*PHIL(I)*VALSYM(IOFFS1+47)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+47+NFSYM0)*PHIR(I)
      SUM36=SUM36+SOO*PHIL(I)*VALSYM(IOFFS1+48)*PHIR(I)
     1      +SOE*PHIL(I)*VALSYM(IOFFS1+48+NFSYM0)*PHIR(I)
      SUM37=SUM37+FACODD*PHIL(I)*VALSYM(IOFFS1+31)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+31+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM38=SUM38+FACODD*PHIL(I)*VALSYM(IOFFS1+32)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+32+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM39=SUM39+FACODD*PHIL(I)*VALSYM(IOFFS1+33)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+33+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM40=SUM40+FACODD*PHIL(I)*VALSYM(IOFFS1+34)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+34+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM41=SUM41+FACODD*PHIL(I)*VALSYM(IOFFS1+35)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+35+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM42=SUM42+FACODD*PHIL(I)*VALSYM(IOFFS1+36)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+36+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM43=SUM43+FACODD*PHIL(I)*VALSYM(IOFFS1+37)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+37+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM44=SUM44+FACODD*PHIL(I)*VALSYM(IOFFS1+38)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+38+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM45=SUM45+FACODD*PHIL(I)*VALSYM(IOFFS1+39)*PHIR(I)*DGKDR(INDR)
     1      +FACEVE*PHIL(I)*VALSYM(IOFFS1+39+NFSYM0)*PHIR(I)
     1       *DGKDR(INDR+1)
      SUM46=SUM46
     1     +FACODD*PHIL(I  )*DSYMM(1,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(1,2)*PHIR(I+1)
      SUM47=SUM47
     1     +FACODD*PHIL(I  )*DSYMM(2,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(2,2)*PHIR(I+1)
      SUM48=SUM48
     1     +FACODD*PHIL(I  )*DSYMM(3,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(3,2)*PHIR(I+1)
      SUM49=SUM49
     1     +FACODD*PHIL(I  )*DSYMM(4,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(4,2)*PHIR(I+1)
      SUM50=SUM50
     1     +FACODD*PHIL(I  )*DSYMM(5,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(5,2)*PHIR(I+1)
      SUM51=SUM51
     1     +FACODD*PHIL(I  )*DSYMM(6,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(6,2)*PHIR(I+1)
      SUM52=SUM52
     1     +FACODD*PHIL(I  )*DSYMM(7,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(7,2)*PHIR(I+1)
      SUM53=SUM53
     1     +FACODD*PHIL(I  )*DSYMM(8,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(8,2)*PHIR(I+1)
      SUM54=SUM54
     1     +FACODD*PHIL(I  )*DSYMM(9,1)*PHIR(I  )
     2     +FACEVE*PHIL(I+1)*DSYMM(9,2)*PHIR(I+1)
C
1100  CONTINUE
      NUMSYM=NUMSYM+1
      IOFFS=(NUMSYM-1)*NZERSY
      IOFSO=(NUMSYM-1)*NSPOSY
      IOFDI=(NUMSYM-1)*NDIPSY
      ACCARR(IOFFS+ 1)=-SUM01
      ACCARR(IOFFS+ 2)=-SUM02
      ACCARR(IOFFS+ 3)=-SUM03
      ACCARR(IOFFS+ 4)=-SUM04
      ACCARR(IOFFS+ 5)=-SUM05
      ACCARR(IOFFS+ 6)=-SUM06
      ACCARR(IOFFS+ 7)=-SUM07
      ACCARR(IOFFS+ 8)=-SUM08
      ACCARR(IOFFS+ 9)=-SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
      ACCARR(IOFFS+23)=SUM23
      ACCARR(IOFFS+24)=SUM24
      ACCARR(IOFFS+25)=SUM25
      ACCARR(IOFFS+26)=SUM26
      ACCARR(IOFFS+27)=SUM27
      ACCARR(IOFFS+28)=ZUM01
      ACCARR(IOFFS+29)=ZUM02
      ACCARR(IOFFS+30)=ZUM03
      ACCARR(IOFFS+31)=ZUM04
      ACCARR(IOFFS+32)=ZUM05
      ACCARR(IOFFS+33)=ZUM06
      ACCARR(IOFFS+34)=ZUM07
      ACCARR(IOFFS+35)=ZUM08
      ACCARR(IOFFS+36)=ZUM09
      ACCARR(IOFFS+37)=SUM37
      ACCARR(IOFFS+38)=SUM38
      ACCARR(IOFFS+39)=SUM39
      ACCARR(IOFFS+40)=SUM40
      ACCARR(IOFFS+41)=SUM41
      ACCARR(IOFFS+42)=SUM42
      ACCARR(IOFFS+43)=SUM43
      ACCARR(IOFFS+44)=SUM44
      ACCARR(IOFFS+45)=SUM45
      SPOARR(IOFSO+1)=SUM28
      SPOARR(IOFSO+2)=SUM29
      SPOARR(IOFSO+3)=SUM30
      SPOARR(IOFSO+4)=SUM31
      SPOARR(IOFSO+5)=SUM32
      SPOARR(IOFSO+6)=SUM33
      SPOARR(IOFSO+7)=SUM34
      SPOARR(IOFSO+8)=SUM35
      SPOARR(IOFSO+9)=SUM36
C
      DIPAC(IOFDI+1)=SUM46
      DIPAC(IOFDI+2)=SUM47
      DIPAC(IOFDI+3)=SUM48
      DIPAC(IOFDI+4)=SUM49
      DIPAC(IOFDI+5)=SUM50
      DIPAC(IOFDI+6)=SUM51
      DIPAC(IOFDI+7)=SUM52
      DIPAC(IOFDI+8)=SUM53
      DIPAC(IOFDI+9)=SUM54
C
1200  CONTINUE
1400  CONTINUE
1410  CONTINUE
      IDUMMY=NUMSYM
      NUMSYM=NUMSYM*NZERSY
      ISPOSY=IDUMMY*NSPOSY
      WRITE (NFILST) (ACCARR(L), L=1,NUMSYM)
      WRITE (NFIL29) (SPOARR(L), L=1,ISPOSY)
      WRITE (NFAB0)  (DIPAC(L) , L=1,IDUMMY*NDIPSY)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9002)
      IF (SYMM) RETURN
      IOFFS0=NFSYM0*V2MXP1*V2MXP1
C
C*********************************************************************
C
C THIS IS THE END OF THE CALCULATION FOR THE SYMMETRICAL MOLECULE.
C WE NOW CALCULATE INTEGRALS FOR THE UNSYMMETRICAL CASE.
C
C*********************************************************************
C
C START LOOP OVER K FOR CALCULATING THE DELTAK=0 MATRIX ELEMENTS
C
      NUMASY=0
      DO 2810 KP1=1,JMAXP1
      KVAL = KP1 - 1
      INDB=KVAL*NSTINT
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 2800 INDEX1=1,V2MP11
C
      IREC1=(KP1-1)*V2MP11+INDEX1
      READ (NFIL7,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 2600 INDEX2=1,V2MP12
      IREC2=(KP1-1)*V2MP12+INDEX2
      READ (NFIL28,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      ZUM01=0.0D+00
      ZUM02=0.0D+00
      ZUM03=0.0D+00
      ZUM04=0.0D+00
      ZUM05=0.0D+00
      ZUM06=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
C
      SUM34=0.0D+00
      SUM35=0.0D+00
      SUM36=0.0D+00
      SUM37=0.0D+00
      SUM38=0.0D+00
      SUM39=0.0D+00
C
      DO 2500 I=1,NSTINT,2
      INDR=INDB+I
      IOFFS1=(I-1)*NFSYM0
      IOFFS2=(I-1)*NFSYMJ
      IOFFA1=(I-1)*NFASY0
      IOFFA2=(I-1)*NFASYJ
C    
      DO 111 IPT=1,2
        DO 112 LL=1,9
          DSYMM(LL,IPT)=SINGM(INDR+IPT-1)*COSGM(INDR+IPT-1)*
     1                 (-VALSYM(IOFFS1+NFSYM0*(IPT-1)+48+LL)
     2                  +VALSYM(IOFFS1+NFSYM0*(IPT-1)+57+LL))
112     CONTINUE
        DO 113 LL=1,6
          DASYM(LL,IPT)=SINGM(INDR+IPT-1)*COSGM(INDR+IPT-1)*
     1                 (-VALASY(IOFFA1+NFASY0*(IPT-1)+35+LL)
     2                  +VALASY(IOFFA1+NFASY0*(IPT-1)+41+LL))
113     CONTINUE
        CALL TR15A(DSYMM(1,IPT),DASYM(1,IPT))
111   CONTINUE
C
        SQUAKO=COSGM(INDR)*SINGM(INDR)*(AMLZ22(I)-AMLZ11(I))
     1        +2.0D+00*(COSGM(INDR)**2-SINGM(INDR)**2)*AMLZ12(I)
     1        *(KP1-1)
        SQUAKE=COSGM(INDR+1)*SINGM(INDR+1)*(AMLZ22(I+1)-AMLZ11(I+1))
     1        +2.0D+00*(COSGM(INDR+1)**2-SINGM(INDR+1)**2)*AMLZ12(I+1)
     1        *(KP1-1)
      DO 933 IPT=1,2
      IOFFAA=IOFFA1+(IPT-1)*NFASY0
             DO 932 LL=1,6
932          VASYM(LL,IPT)=COSGM(INDR+IPT-1)*SINGM(INDR+IPT-1)
     1             *(VALASY(IOFFAA+12+LL)-VALASY(IOFFAA+ 6+LL))
933   CONTINUE
C
      SOO=-FACODD*(COSGM(INDR)**2-SINGM(INDR)**2)*AMLZ12(I)
      SOE=-FACEVE*(COSGM(INDR+1)**2-SINGM(INDR+1)**2)*AMLZ12(I+1)
      FO1=-FACODD*COSGM(INDR)*SINGM(INDR)
      FE1=-FACEVE*COSGM(INDR+1)*SINGM(INDR+1)
      SUM01=SUM01+FACODD*VALASY(IOFFA1+ 1)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 1+NFASY0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM02=SUM02+FACODD*VALASY(IOFFA1+ 2)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 2+NFASY0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM03=SUM03+FACODD*VALASY(IOFFA1+ 3)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 3+NFASY0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM04=SUM04+FACODD*VALASY(IOFFA1+ 4)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 4+NFASY0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM05=SUM05+FACODD*VALASY(IOFFA1+ 5)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 5+NFASY0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM06=SUM06+FACODD*VALASY(IOFFA1+ 6)*DGKDR(INDR)
     1           *(DERL(I  )*PHIR(I  )-PHIL(I  )*DERR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 6+NFASY0)*DGKDR(INDR+1)
     1           *(DERL(I+1)*PHIR(I+1)-PHIL(I+1)*DERR(I+1))
      SUM07=SUM07+FACODD*PHIL(I  )*VASYM(1,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(1,2)*PHIR(I+1)
      SUM08=SUM08+FACODD*PHIL(I  )*VASYM(2,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(2,2)*PHIR(I+1)
      SUM09=SUM09+FACODD*PHIL(I  )*VASYM(3,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(3,2)*PHIR(I+1)
      SUM10=SUM10+FACODD*PHIL(I  )*VASYM(4,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(4,2)*PHIR(I+1)
      SUM11=SUM11+FACODD*PHIL(I  )*VASYM(5,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(5,2)*PHIR(I+1)
      SUM12=SUM12+FACODD*PHIL(I  )*VASYM(6,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(6,2)*PHIR(I+1)
      SUM13=SUM13+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+13)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+13+NFASYJ)
     2          *PHIR(I+1)
      SUM14=SUM14+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+14)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+14+NFASYJ)
     2          *PHIR(I+1)
      SUM15=SUM15+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+15)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+15+NFASYJ)
     2          *PHIR(I+1)
      SUM16=SUM16+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+16)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+16+NFASYJ)
     2          *PHIR(I+1)
      SUM17=SUM17+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+17)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+17+NFASYJ)
     2          *PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+18)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+18+NFASYJ)
     2          *PHIR(I+1)
      IF (KP1 .EQ. 2) THEN
      ZUM01=ZUM01+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 1)-ROTASY(IOFFA2+ 7))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 1+NFASYJ)-ROTASY(IOFFA2+ 7+NFASYJ))
      ZUM02=ZUM02+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 2)-ROTASY(IOFFA2+ 8))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 2+NFASYJ)-ROTASY(IOFFA2+ 8+NFASYJ))
      ZUM03=ZUM03+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 3)-ROTASY(IOFFA2+ 9))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 3+NFASYJ)-ROTASY(IOFFA2+ 9+NFASYJ))
      ZUM04=ZUM04+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 4)-ROTASY(IOFFA2+10))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 4+NFASYJ)-ROTASY(IOFFA2+10+NFASYJ))
      ZUM05=ZUM05+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 5)-ROTASY(IOFFA2+11))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 5+NFASYJ)-ROTASY(IOFFA2+11+NFASYJ))
      ZUM06=ZUM06+FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 6)-ROTASY(IOFFA2+12))
     1           +FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 6+NFASYJ)-ROTASY(IOFFA2+12+NFASYJ))
      ENDIF
      SUM19=SUM19+SOO*PHIL(I)*VALASY(IOFFA1+30)*PHIR(I)
     1          +SOE*PHIL(I+1)*VALASY(IOFFA1+30+NFASY0)*PHIR(I+1)
      SUM20=SUM20+SOO*PHIL(I)*VALASY(IOFFA1+31)*PHIR(I)
     1          +SOE*PHIL(I+1)*VALASY(IOFFA1+31+NFASY0)*PHIR(I+1)
      SUM21=SUM21+SOO*PHIL(I)*VALASY(IOFFA1+32)*PHIR(I)
     1          +SOE*PHIL(I+1)*VALASY(IOFFA1+32+NFASY0)*PHIR(I+1)
      SUM22=SUM22+SOO*PHIL(I)*VALASY(IOFFA1+33)*PHIR(I)
     1          +SOE*PHIL(I+1)*VALASY(IOFFA1+33+NFASY0)*PHIR(I+1)
      SUM23=SUM23+SOO*PHIL(I)*VALASY(IOFFA1+34)*PHIR(I)
     1          +SOE*PHIL(I+1)*VALASY(IOFFA1+34+NFASY0)*PHIR(I+1)
      SUM24=SUM24+SOO*PHIL(I)*VALASY(IOFFA1+35)*PHIR(I)
     1          +SOE*PHIL(I+1)*VALASY(IOFFA1+35+NFASY0)*PHIR(I+1)
      SUM25=SUM25+FACEVE*PHIL(I)*VALASY(IOFFA1+21)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+21+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM26=SUM26+FACEVE*PHIL(I)*VALASY(IOFFA1+22)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+22+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM27=SUM27+FACEVE*PHIL(I)*VALASY(IOFFA1+23)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+23+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM28=SUM28+FACEVE*PHIL(I)*VALASY(IOFFA1+24)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+24+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM29=SUM29+FACEVE*PHIL(I)*VALASY(IOFFA1+25)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+25+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM30=SUM30+FACEVE*PHIL(I)*VALASY(IOFFA1+26)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+26+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM31=SUM31+FACEVE*PHIL(I)*VALASY(IOFFA1+27)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+27+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM32=SUM32+FACEVE*PHIL(I)*VALASY(IOFFA1+28)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+28+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
      SUM33=SUM33+FACEVE*PHIL(I)*VALASY(IOFFA1+29)*PHIR(I)*DGKDR(INDR)
     1          +FACODD*PHIL(I+1)*VALASY(IOFFA1+29+NFASY0)*PHIR(I+1)
     2          *DGKDR(INDR+1)
C
      SUM34=SUM34
     1     +FACODD*PHIL(I  )*DASYM(1,1)*PHIR(I)
     1     +FACEVE*PHIL(I+1)*DASYM(1,2)*PHIR(I+1)
      SUM35=SUM35
     1     +FACODD*PHIL(I  )*DASYM(2,1)*PHIR(I)
     1     +FACEVE*PHIL(I+1)*DASYM(2,2)*PHIR(I+1)
      SUM36=SUM36
     1     +FACODD*PHIL(I  )*DASYM(3,1)*PHIR(I)
     1     +FACEVE*PHIL(I+1)*DASYM(3,2)*PHIR(I+1)
      SUM37=SUM37
     1     +FACODD*PHIL(I  )*DASYM(4,1)*PHIR(I)
     1     +FACEVE*PHIL(I+1)*DASYM(4,2)*PHIR(I+1)
      SUM38=SUM38
     1     +FACODD*PHIL(I  )*DASYM(5,1)*PHIR(I)
     1     +FACEVE*PHIL(I+1)*DASYM(5,2)*PHIR(I+1)
      SUM39=SUM39
     1     +FACODD*PHIL(I  )*DASYM(6,1)*PHIR(I)
     1     +FACEVE*PHIL(I+1)*DASYM(6,2)*PHIR(I+1)
C
2500  CONTINUE
      NUMASY=NUMASY+1
      IOFSO=(NUMASY-1)*NSPOAS
      IOFFS=(NUMASY-1)*NZERAS
      IOFDI=(NUMASY-1)*NDIPAS
      ACCARR(IOFFS+ 1)=-SUM01
      ACCARR(IOFFS+ 2)=-SUM02
      ACCARR(IOFFS+ 3)=-SUM03
      ACCARR(IOFFS+ 4)=-SUM04
      ACCARR(IOFFS+ 5)=-SUM05
      ACCARR(IOFFS+ 6)=-SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=ZUM01
      ACCARR(IOFFS+20)=ZUM02
      ACCARR(IOFFS+21)=ZUM03
      ACCARR(IOFFS+22)=ZUM04
      ACCARR(IOFFS+23)=ZUM05
      ACCARR(IOFFS+24)=ZUM06
      ACCARR(IOFFS+25)=SUM25
      ACCARR(IOFFS+26)=SUM26
      ACCARR(IOFFS+27)=SUM27
      ACCARR(IOFFS+28)=SUM28
      ACCARR(IOFFS+29)=SUM29
      ACCARR(IOFFS+30)=SUM30
      ACCARR(IOFFS+31)=SUM31
      ACCARR(IOFFS+32)=SUM32
      ACCARR(IOFFS+33)=SUM33
      SPOARR(IOFSO+1)=SUM19
      SPOARR(IOFSO+2)=SUM20
      SPOARR(IOFSO+3)=SUM21
      SPOARR(IOFSO+4)=SUM22
      SPOARR(IOFSO+5)=SUM23
      SPOARR(IOFSO+6)=SUM24
C
      DIPAC(IOFDI+1)=SUM34
      DIPAC(IOFDI+2)=SUM35
      DIPAC(IOFDI+3)=SUM36
      DIPAC(IOFDI+4)=SUM37
      DIPAC(IOFDI+5)=SUM38
      DIPAC(IOFDI+6)=SUM39
C
2600  CONTINUE
2800  CONTINUE
2810  CONTINUE
      IDUMMY=NUMASY
      NUMASY=NUMASY*NZERAS
      ISPOAS=IDUMMY*NSPOAS
      WRITE (NFILST) (ACCARR(L), L=1,NUMASY)
      WRITE (NFIL29) (SPOARR(L), L=1,ISPOAS)
      WRITE (NFAB0)  (DIPAC(L) , L=1,IDUMMY*NDIPAS)
      IF (IPRINT .NE. 0) WRITE (NFIL6,9003)
      RETURN
9001  FORMAT(1H0,' RENTEL.IPM.INF   DK=0 INTEGRATION ROUTINE ENTERED'/)
9002  FORMAT(1H0,' RENTEL.IPM.INF   SYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=0'/)
9003  FORMAT(1H0,' RENTEL.IPM.INF   UNSYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=0'/)
      END
C
C
      SUBROUTINE INTPM1 ( ROTSYM , ROTASY , COSGM , SINGM , DGKDR ,
     1                   PHIL   , DERL   , PHIR   , DERR   ,
     1                   AMLZ12 , ACCARR ,
     1                   NFILST , V2MP11 , V2MP12 ,
     1                   KFSYMJ , KFASYJ ,
     1                   LENACC , NUMSYM , NUMASY ,
     1                   NONESY , NONEAS,
     1                   DIPAC,LENDIP,
     1                   NFAB1,
     2                   NDIPSY,NDIPAS )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10)
C
      REAL*8 DIPAC(LENDIP),
     1       DSYMM(9,2),
     2       DASYM(6,2)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, V2MP11 , V2MP12 ,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1 ,
     5       JMAXPNS, NSTINT2
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 PHIL(NSTINT),
     1      DERL(NSTINT),PHIR(NSTINT),DERR(NSTINT),
     1      COSGM(NSTINT*JMAXP1) , SINGM(NSTINT*JMAXP1),
     1      DGKDR(NSTINT*JMAXP1) ,
     1      ROTSYM(KFSYMJ),ROTASY(KFASYJ),
     1      AMLZ12(NSTINT)
      REAL*8  SUM01,SUM02,SUM03,SUM04,SUM05,SUM06,SUM07,SUM08,SUM09,
     1 SUM10,SUM11,SUM12,SUM13,SUM14,SUM15,SUM16,SUM17,SUM18,SUM19,
     2 SUM20,SUM21,SUM22,SUM23,SUM24,SUM25,SUM26,SUM27,SUM28,SUM29,
     3 SUM30,SUM31,ACCARR(LENACC)
      REAL*8 FACODD,FACEVE
      INTEGER INDEX1,INDEX2,
     1       IOFFS,IOFFS0,IEND,JOFFS,KOFFSO,KOFFSE,NFCT
C
      include 'isotop.h'
      include 'value.h'
      include 'lzcomp.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
C
	JMAXPNS = JMAXP1 *NSTINT
	NSTINT2 = NSTINT
      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL48
      REWIND NFIL49
      READ (NFIL46) (COSGM(L), L=1,JMAXPNS)
      READ (NFIL47) (SINGM(L), L=1,JMAXPNS)
      READ (NFIL49) (DGKDR(L), L=1,JMAXPNS)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9001)
      FACOD0=2.0D+00*HSTEP/3.0D+00
      FACEV0=4.0D+00*HSTEP/3.0D+00
C
      XFACT=-2.0D+00
      DO 800 I=1,NSTINT
      RHO=DFLOAT(I)*HSTEP
      CORANG=1.0D+00-COS(RHO)
800   AMLZ12(I)=XFACT*(XLAMB-(((XLZI4*CORANG+XLZI3)*CORANG+XLZI2)
     1         *CORANG+XLZI1)*CORANG)
C
C START LOOP OVER K FOR CALCULATING DELTAK=1 MATRIX ELEMENTS
C
      NUMSYM=0
      DO 1410 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB=K1VAL*NSTINT
C
C
      DO 1405 KDEL=-1,1,2
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 1405
      K2VAL = K2P1 - 1
      INDB2=K2VAL*NSTINT
C
C
      XKK=DFLOAT(K1VAL+K2VAL)
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 1400 INDEX1=1,V2MP11
C
      IREC1=(K1P1-1)*V2MP11+INDEX1
      READ (NFIL7,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 1200 INDEX2=1,V2MP12
C
      IREC2=(K2P1-1)*V2MP12+INDEX2
      READ (NFIL28,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
C
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
C
      DO 1100 I=1,NSTINT,2
      INDR=INDB+I
      INDR2=INDB2+I
C
      DO 112 IPT=1,2
      IOFFS=( I-1 + IPT-1 )*NFSYMJ
      IOFFA=( I-1 + IPT-1 )*NFASYJ
      DO 113 LL=1,9
        DSYMM(LL,IPT)=1/SQRT(2.00D+00)*(
     1     COSGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)*ROTSYM(IOFFS+53+LL)
     2    -SINGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)*ROTSYM(IOFFS+62+LL)
     3    +KDEL*ROTSYM(IOFFS+71+LL)
     4    *(COSGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)+
     5      SINGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)))
113   CONTINUE
      IF (.NOT.SYMM) THEN
      DO 114 LL=1,6
        DASYM(LL,IPT)=1/SQRT(2.00D+00)*(
     1     COSGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)*ROTASY(IOFFA+40+LL)
     2    -SINGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)*ROTASY(IOFFA+46+LL)
     3    +KDEL*ROTASY(IOFFA+52+LL)
     4    *(COSGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)+
     5      SINGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)))
114   CONTINUE
      ENDIF
      IF (SYMM) THEN
         CALL TR15SS(DSYMM(1,IPT))
      ELSE
         CALL  TR15A(DSYMM(1,IPT),DASYM(1,IPT))
      ENDIF
112   CONTINUE
C      
      IOFFS=(I-1)*NFSYMJ
      FACODD=FACOD0*(SINGM(INDR)*COSGM(INDR2)-SINGM(INDR2)
     1             *COSGM(INDR))
      FACEVE=FACEV0*(SINGM(INDR+1)*COSGM(INDR2+1)-SINGM(INDR2+1)
     1             *COSGM(INDR+1))
      FACTKO=XKK*FACODD+FACOD0*AMLZ12(I)*(COSGM(INDR)*COSGM(INDR2)
     1       +SINGM(INDR)*SINGM(INDR2))
      FACTKE=XKK*FACEVE+FACEV0*AMLZ12(I+1)*(COSGM(INDR+1)
     1      *COSGM(INDR2+1)+SINGM(INDR+1)*SINGM(INDR2+1))
      FACXRO=-FACOD0*(COSGM(INDR2)*COSGM(INDR)+SINGM(INDR2)
     1      *SINGM(INDR))*(DGKDR(INDR)+DGKDR(INDR2))
      FACXRE=-FACEV0*(COSGM(INDR2+1)*COSGM(INDR+1)+SINGM(INDR2+1)
     1      *SINGM(INDR+1))*(DGKDR(INDR+1)+DGKDR(INDR2+1))
      SUM01=SUM01+FACTKO*PHIL(I  )*ROTSYM(IOFFS+28)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+28+NFSYMJ)*PHIR(I+1)
      SUM02=SUM02+FACTKO*PHIL(I  )*ROTSYM(IOFFS+29)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+29+NFSYMJ)*PHIR(I+1)
      SUM03=SUM03+FACTKO*PHIL(I  )*ROTSYM(IOFFS+30)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+30+NFSYMJ)*PHIR(I+1)
      SUM04=SUM04+FACTKO*PHIL(I  )*ROTSYM(IOFFS+31)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+31+NFSYMJ)*PHIR(I+1)
      SUM05=SUM05+FACTKO*PHIL(I  )*ROTSYM(IOFFS+32)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+32+NFSYMJ)*PHIR(I+1)
      SUM06=SUM06+FACTKO*PHIL(I  )*ROTSYM(IOFFS+33)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+33+NFSYMJ)*PHIR(I+1)
      SUM07=SUM07+FACTKO*PHIL(I  )*ROTSYM(IOFFS+34)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+34+NFSYMJ)*PHIR(I+1)
      SUM08=SUM08+FACTKO*PHIL(I  )*ROTSYM(IOFFS+35)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTSYM(IOFFS+35+NFSYMJ)*PHIR(I+1)
      SUM09=SUM09+FACODD*ROTSYM(IOFFS+36)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+36+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+36)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+36+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM10=SUM10+FACODD*ROTSYM(IOFFS+37)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+37+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+37)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+37+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM11=SUM11+FACODD*ROTSYM(IOFFS+38)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+38+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+38)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+38+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM12=SUM12+FACODD*ROTSYM(IOFFS+39)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+39+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+39)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+39+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM13=SUM13+FACODD*ROTSYM(IOFFS+40)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+40+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+40)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+40+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM14=SUM14+FACODD*ROTSYM(IOFFS+41)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+41+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+41)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+41+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM15=SUM15+FACODD*ROTSYM(IOFFS+42)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+42+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+42)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+42+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM16=SUM16+FACODD*ROTSYM(IOFFS+43)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+43+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+43)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+43+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM17=SUM17+FACODD*ROTSYM(IOFFS+44)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTSYM(IOFFS+44+NFSYMJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+44)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+44+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*ROTSYM(IOFFS+45)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+45+NFSYMJ)*PHIR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*ROTSYM(IOFFS+46)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+46+NFSYMJ)*PHIR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*ROTSYM(IOFFS+47)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+47+NFSYMJ)*PHIR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*ROTSYM(IOFFS+48)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+48+NFSYMJ)*PHIR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*ROTSYM(IOFFS+49)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+49+NFSYMJ)*PHIR(I+1)
      SUM23=SUM23+FACODD*PHIL(I  )*ROTSYM(IOFFS+50)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+50+NFSYMJ)*PHIR(I+1)
      SUM24=SUM24+FACODD*PHIL(I  )*ROTSYM(IOFFS+51)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+51+NFSYMJ)*PHIR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*ROTSYM(IOFFS+52)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+52+NFSYMJ)*PHIR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*ROTSYM(IOFFS+53)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+53+NFSYMJ)*PHIR(I+1)
C
      SUM27=SUM27
     1     +FACOD0*PHIL(I  )*DSYMM(1,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(1,2)*PHIR(I+1)
      SUM28=SUM28
     1     +FACOD0*PHIL(I  )*DSYMM(2,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(2,2)*PHIR(I+1)
      SUM29=SUM29
     1     +FACOD0*PHIL(I  )*DSYMM(3,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(3,2)*PHIR(I+1)
      SUM30=SUM30
     1     +FACOD0*PHIL(I  )*DSYMM(4,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(4,2)*PHIR(I+1)
      SUM31=SUM31
     1     +FACOD0*PHIL(I  )*DSYMM(5,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(5,2)*PHIR(I+1)
      SUM32=SUM32
     1     +FACOD0*PHIL(I  )*DSYMM(6,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(6,2)*PHIR(I+1)
      SUM33=SUM33
     1     +FACOD0*PHIL(I  )*DSYMM(7,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(7,2)*PHIR(I+1)
      SUM34=SUM34
     1     +FACOD0*PHIL(I  )*DSYMM(8,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(8,2)*PHIR(I+1)
      SUM35=SUM35
     1     +FACOD0*PHIL(I  )*DSYMM(9,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DSYMM(9,2)*PHIR(I+1)
C
1100  CONTINUE
      NUMSYM=NUMSYM+1
      IOFFS=(NUMSYM-1)*NONESY
      IOFDI=(NUMSYM-1)*NDIPSY
      ACCARR(IOFFS+ 1)=SUM01
      ACCARR(IOFFS+ 2)=SUM02
      ACCARR(IOFFS+ 3)=SUM03
      ACCARR(IOFFS+ 4)=SUM04
      ACCARR(IOFFS+ 5)=SUM05
      ACCARR(IOFFS+ 6)=SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
      ACCARR(IOFFS+23)=SUM23
      ACCARR(IOFFS+24)=SUM24
      ACCARR(IOFFS+25)=SUM25
      ACCARR(IOFFS+26)=SUM26
C
      DIPAC(IOFDI+1)=SUM27
      DIPAC(IOFDI+2)=SUM28
      DIPAC(IOFDI+3)=SUM29
      DIPAC(IOFDI+4)=SUM30
      DIPAC(IOFDI+5)=SUM31
      DIPAC(IOFDI+6)=SUM32
      DIPAC(IOFDI+7)=SUM33
      DIPAC(IOFDI+8)=SUM34
      DIPAC(IOFDI+9)=SUM35
C
1200  CONTINUE
1400  CONTINUE
1405  CONTINUE
1410  CONTINUE
      WRITE (NFILST) (ACCARR(L), L=1,NUMSYM*NONESY)
      WRITE (NFAB1)  (DIPAC(L) , L=1,NUMSYM*NDIPSY)
      NUMSYM=NUMSYM*NONESY
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9002)
      IF (SYMM) RETURN
      IOFFS0=NFSYM0*V2MXP1*V2MXP1
C
C*********************************************************************
C
C THIS THE THE END OF THE CALCULATION FOR THE SYMMETRICAL MOLECULE.
C WE NOW CALCULATE INTEGRALS FOR THE UNSYMMETRICAL CASE.
C
C*********************************************************************
C
C START LOOP OVER K FOR CALCULATING THE DELTA K=1 MATRIX ELEMENTS
C
      NUMASY=0
      DO 2810 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB=K1VAL*NSTINT
C
C
      DO 2805 KDEL=-1,1,2
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 2805
      K2VAL = K2P1 - 1
      INDB2=K2VAL*NSTINT
C
C
      XKK=DFLOAT(K1VAL+K2VAL)
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 2800 INDEX1=1,V2MP11
C
      IREC1=(K1P1-1)*V2MP11+INDEX1
      READ (NFIL7,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 2600 INDEX2=1,V2MP12
      IREC2=(K2P1-1)*V2MP12+INDEX2
      READ (NFIL28,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00 
C
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
C
      DO 2500 I=1,NSTINT,2
      INDR=INDB+I
      INDR2=INDB2+I
C
      DO 212 IPT=1,2
      IOFFS=( I-1 + IPT-1 )*NFSYMJ
      IOFFA=( I-1 + IPT-1 )*NFASYJ
      DO 213 LL=1,9
        DSYMM(LL,IPT)=1/SQRT(2.00D+00)*(
     1     COSGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)*ROTSYM(IOFFS+53+LL)
     2    -SINGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)*ROTSYM(IOFFS+62+LL)
     3    +KDEL*ROTSYM(IOFFS+71+LL)
     4    *(COSGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)+
     5      SINGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)))
213   CONTINUE
      DO 214 LL=1,6
        DASYM(LL,IPT)=1/SQRT(2.00D+00)*(
     1     COSGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)*ROTASY(IOFFA+40+LL)
     2    -SINGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)*ROTASY(IOFFA+46+LL)
     3    +KDEL*ROTASY(IOFFA+52+LL)
     4    *(COSGM(INDR+IPT-1)*COSGM(INDR2+IPT-1)+
     5      SINGM(INDR+IPT-1)*SINGM(INDR2+IPT-1)))
214   CONTINUE
      CALL  TR15A(DSYMM(1,IPT),DASYM(1,IPT))
212   CONTINUE
C
      IOFFS=(I-1)*NFASYJ
      FACODD=FACOD0*(SINGM(INDR)*COSGM(INDR2)-SINGM(INDR2)
     1             *COSGM(INDR))
      FACEVE=FACEV0*(SINGM(INDR+1)*COSGM(INDR2+1)-SINGM(INDR2+1)
     1             *COSGM(INDR+1))
      FACTKO=XKK*FACODD+FACOD0*AMLZ12(I)*(COSGM(INDR)*COSGM(INDR2)
     1                 +SINGM(INDR)*SINGM(INDR2))
      FACTKE=XKK*FACEVE+FACEV0*AMLZ12(I+1)*(COSGM(INDR+1)
     1      *COSGM(INDR2+1)+SINGM(INDR+1)*SINGM(INDR2+1))
      SUM01=SUM01+FACTKO*PHIL(I  )*ROTASY(IOFFS+19)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+19+NFASYJ)*PHIR(I+1)
      SUM02=SUM02+FACTKO*PHIL(I  )*ROTASY(IOFFS+20)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+20+NFASYJ)*PHIR(I+1)
      SUM03=SUM03+FACTKO*PHIL(I  )*ROTASY(IOFFS+21)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+21+NFASYJ)*PHIR(I+1)
      SUM04=SUM04+FACTKO*PHIL(I  )*ROTASY(IOFFS+22)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+22+NFASYJ)*PHIR(I+1)
      SUM05=SUM05+FACTKO*PHIL(I  )*ROTASY(IOFFS+23)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+23+NFASYJ)*PHIR(I+1)
      SUM06=SUM06+FACTKO*PHIL(I  )*ROTASY(IOFFS+24)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+24+NFASYJ)*PHIR(I+1)
      SUM07=SUM07+FACTKO*PHIL(I  )*ROTASY(IOFFS+25)*PHIR(I  )
     1          +FACTKE*PHIL(I+1)*ROTASY(IOFFS+25+NFASYJ)*PHIR(I+1)
      SUM08=SUM08+FACODD*ROTASY(IOFFS+26)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTASY(IOFFS+26+NFASYJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+26)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+26+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM09=SUM09+FACODD*ROTASY(IOFFS+27)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTASY(IOFFS+27+NFASYJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+27)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+27+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM10=SUM10+FACODD*ROTASY(IOFFS+28)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTASY(IOFFS+28+NFASYJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+28)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+28+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM11=SUM11+FACODD*ROTASY(IOFFS+29)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTASY(IOFFS+29+NFASYJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+29)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+29+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM12=SUM12+FACODD*ROTASY(IOFFS+30)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTASY(IOFFS+30+NFASYJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+30)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+30+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM13=SUM13+FACODD*ROTASY(IOFFS+31)*
     1            (PHIL(I  )*DERR(I  )-PHIR(I  )*DERL(I  ))
     1          +FACEVE*ROTASY(IOFFS+31+NFASYJ)*
     1            (PHIL(I+1)*DERR(I+1)-PHIR(I+1)*DERL(I+1))
     1          +FACXRO*ROTSYM(IOFFS+31)*PHIL(I)*PHIR(I)
     1          +FACXRE*ROTSYM(IOFFS+31+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM14=SUM14+FACODD*PHIL(I  )*ROTASY(IOFFS+32)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+32+NFASYJ)*PHIR(I+1)
      SUM15=SUM15+FACODD*PHIL(I  )*ROTASY(IOFFS+33)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+33+NFASYJ)*PHIR(I+1)
      SUM16=SUM16+FACODD*PHIL(I  )*ROTASY(IOFFS+34)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+34+NFASYJ)*PHIR(I+1)
      SUM17=SUM17+FACODD*PHIL(I  )*ROTASY(IOFFS+35)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+35+NFASYJ)*PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*ROTASY(IOFFS+36)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+36+NFASYJ)*PHIR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*ROTASY(IOFFS+37)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+37+NFASYJ)*PHIR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*ROTASY(IOFFS+38)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+38+NFASYJ)*PHIR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*ROTASY(IOFFS+39)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+39+NFASYJ)*PHIR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*ROTASY(IOFFS+40)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+40+NFASYJ)*PHIR(I+1)
C
      SUM23=SUM23
     1     +FACOD0*PHIL(I  )*DASYM(1,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DASYM(1,2)*PHIR(I+1)
      SUM24=SUM24
     1     +FACOD0*PHIL(I  )*DASYM(2,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DASYM(2,2)*PHIR(I+1)
      SUM25=SUM25
     1     +FACOD0*PHIL(I  )*DASYM(3,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DASYM(3,2)*PHIR(I+1)
      SUM26=SUM26
     1     +FACOD0*PHIL(I  )*DASYM(4,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DASYM(4,2)*PHIR(I+1)
      SUM27=SUM27
     1     +FACOD0*PHIL(I  )*DASYM(5,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DASYM(5,2)*PHIR(I+1)
      SUM28=SUM28
     1     +FACOD0*PHIL(I  )*DASYM(6,1)*PHIR(I  )
     2     +FACEV0*PHIL(I+1)*DASYM(6,2)*PHIR(I+1)
C
2500  CONTINUE
      NUMASY=NUMASY+1
      IOFFS=(NUMASY-1)*NONEAS
      IOFDI=(NUMASY-1)*NDIPAS
      ACCARR(IOFFS+ 1)=SUM01
      ACCARR(IOFFS+ 2)=SUM02
      ACCARR(IOFFS+ 3)=SUM03
      ACCARR(IOFFS+ 4)=SUM04
      ACCARR(IOFFS+ 5)=SUM05
      ACCARR(IOFFS+ 6)=SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
C     
      DIPAC(IOFDI+1)=SUM23
      DIPAC(IOFDI+2)=SUM24
      DIPAC(IOFDI+3)=SUM25
      DIPAC(IOFDI+4)=SUM26
      DIPAC(IOFDI+5)=SUM27
      DIPAC(IOFDI+6)=SUM28
C
2600  CONTINUE
2800  CONTINUE
2805  CONTINUE
2810  CONTINUE
      WRITE (NFILST) (ACCARR(L), L=1,NUMASY*NONEAS)
      WRITE (NFAB1)  (DIPAC(L) , L=1,NUMASY*NDIPAS)
      NUMASY=NUMASY*NONEAS
      IF (IPRINT .NE. 0) WRITE (NFIL6,9003)
      RETURN
9001  FORMAT(1H0,' RENTEL.IPM.INF   DK=1 INTEGRATION ROUTINE ENTERED'/)
9002  FORMAT(1H0,' RENTEL.IPM.INF   SYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=1'/)
9003  FORMAT(1H0,' RENTEL.IPM.INF   UNSYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=1'/)
      END
C
C
      SUBROUTINE INTPM2 ( ROTSYM , ROTASY ,
     1                   COSGM , SINGM , 
     1                   PHIL   , DERL   , PHIR   , DERR   , ACCARR ,
     1                   NFILST , V2MP11 , V2MP12 ,
     1                   KFSYMJ , KFASYJ ,
     1                   LENACC , NUMSYM , NUMASY ,
     1                   NTWOSY , NTWOAS )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, V2MP11 , V2MP12 ,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 PHIL(NSTINT),
     1      DERL(NSTINT),PHIR(NSTINT),DERR(NSTINT),
     1      COSGM(NSTINT*JMAXP1) , SINGM(NSTINT*JMAXP1) , 
     1      ROTSYM(KFSYMJ),ROTASY(KFASYJ)
      REAL*8  SUM01,SUM02,SUM03,SUM04,SUM05,SUM06,SUM07,SUM08,SUM09,
     1 SUM10,SUM11,SUM12,SUM13,SUM14,SUM15,SUM16,SUM17,SUM18,SUM19,
     2 SUM20,SUM21,SUM22,SUM23,SUM24,SUM25,SUM26,SUM27,SUM28,SUM29,
     3 SUM30,SUM31,ACCARR(LENACC)
      REAL*8 FACODD,FACEVE
      INTEGER INDEX1,INDEX2,
     1       IOFFS,IOFFS0,IEND,JOFFS,KOFFSO,KOFFSE,NFCT
C
      include 'isotop.h'
      include 'value.h'
      include 'lzcomp.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
C
      REWIND NFIL46
      REWIND NFIL47
      READ (NFIL46) (COSGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL47) (SINGM(L), L=1,JMAXP1*NSTINT)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9001)
      FACOD0=2.0D+00*HSTEP/3.0D+00
      FACEV0=4.0D+00*HSTEP/3.0D+00
      ECOEF1=(U1-U3)/SQRT((U1+U3)**2-4.0E0*U13**2)
      ECOEF2=SQRT((U1+U3-2.0E0*U13)/(U1+U3+2.0E0*U13))
      F2COEF=(M/(U1*U3-U13**2))
     1	    *((PLANCK*AVOGNO*1.0D+16)/(4.0D+00*PI*PI*VELLGT))
C
C START LOOP OVER K FOR CALCULATING DELTAK=2 MATRIX ELEMENTS
C
      NUMSYM=0
      DO 1410 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB=K1VAL*NSTINT
C
C
      DO 1405 KDEL=-2,2,4
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 1405
      K2VAL = K2P1 - 1
      INDB2=K2VAL*NSTINT
C
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 1400 INDEX1=1,V2MP11
C
      IREC1=(K1P1-1)*V2MP11+INDEX1
      READ (NFIL7,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 1200 INDEX2=1,V2MP12
C
      IREC2=(K2P1-1)*V2MP12+INDEX2
      READ (NFIL28,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
      SUM36=0.0D+00
      SUM37=0.0D+00
      SUM38=0.0D+00
      SUM39=0.0D+00
      SUM40=0.0D+00
      SUM41=0.0D+00
      SUM42=0.0D+00
      SUM43=0.0D+00
      SUM44=0.0D+00
      SUM45=0.0D+00
      SUM46=0.0D+00
      SUM47=0.0D+00
      SUM48=0.0D+00
      SUM49=0.0D+00
C
      DO 1100 I=1,NSTINT,2
      IOFFS=(I-1)*NFSYMJ
      INDR=INDB+I
      INDR2=INDB2+I
      FACODD=FACOD0*(SINGM(INDR)*COSGM(INDR2)-SINGM(INDR2)
     1          *COSGM(INDR))
      FACEVE=FACEV0*(SINGM(INDR+1)*COSGM(INDR2+1)-SINGM(INDR2+1)
     1          *COSGM(INDR+1))
      SUM32=SUM32+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 1+NFSYMJ)*PHIR(I+1)
      SUM33=SUM33+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 2)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 2+NFSYMJ)*PHIR(I+1)
      SUM34=SUM34+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 3)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 3+NFSYMJ)*PHIR(I+1)
      SUM35=SUM35+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 4)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 4+NFSYMJ)*PHIR(I+1)
      SUM36=SUM36+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 5)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 5+NFSYMJ)*PHIR(I+1)
      SUM37=SUM37+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 6)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 6+NFSYMJ)*PHIR(I+1)
      SUM38=SUM38+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 7)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 7+NFSYMJ)*PHIR(I+1)
      SUM39=SUM39+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 8)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 8+NFSYMJ)*PHIR(I+1)
      SUM40=SUM40+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 9)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 9+NFSYMJ)*PHIR(I+1)
      SUM41=SUM41+FACODD*PHIL(I  )*ROTSYM(IOFFS+10)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+10+NFSYMJ)*PHIR(I+1)
      SUM42=SUM42+FACODD*PHIL(I  )*ROTSYM(IOFFS+11)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+11+NFSYMJ)*PHIR(I+1)
      SUM43=SUM43+FACODD*PHIL(I  )*ROTSYM(IOFFS+12)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+12+NFSYMJ)*PHIR(I+1)
      SUM44=SUM44+FACODD*PHIL(I  )*ROTSYM(IOFFS+13)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+13+NFSYMJ)*PHIR(I+1)
      SUM45=SUM45+FACODD*PHIL(I  )*ROTSYM(IOFFS+14)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+14+NFSYMJ)*PHIR(I+1)
      SUM46=SUM46+FACODD*PHIL(I  )*ROTSYM(IOFFS+15)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+15+NFSYMJ)*PHIR(I+1)
      SUM47=SUM47+FACODD*PHIL(I  )*ROTSYM(IOFFS+16)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+16+NFSYMJ)*PHIR(I+1)
      SUM48=SUM48+FACODD*PHIL(I  )*ROTSYM(IOFFS+17)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+17+NFSYMJ)*PHIR(I+1)
      SUM49=SUM49+FACODD*PHIL(I  )*ROTSYM(IOFFS+18)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+18+NFSYMJ)*PHIR(I+1)
1100  CONTINUE
      NUMSYM=NUMSYM+1
      IOFFS=(NUMSYM-1)*NTWOSY
      ACCARR(IOFFS+ 1)=SUM32
      ACCARR(IOFFS+ 2)=SUM33
      ACCARR(IOFFS+ 3)=SUM34
      ACCARR(IOFFS+ 4)=SUM35
      ACCARR(IOFFS+ 5)=SUM36
      ACCARR(IOFFS+ 6)=SUM37
      ACCARR(IOFFS+ 7)=SUM38
      ACCARR(IOFFS+ 8)=SUM39
      ACCARR(IOFFS+ 9)=SUM40
      ACCARR(IOFFS+10)=SUM41
      ACCARR(IOFFS+11)=SUM42
      ACCARR(IOFFS+12)=SUM43
      ACCARR(IOFFS+13)=SUM44
      ACCARR(IOFFS+14)=SUM45
      ACCARR(IOFFS+15)=SUM46
      ACCARR(IOFFS+16)=SUM47
      ACCARR(IOFFS+17)=SUM48
      ACCARR(IOFFS+18)=SUM49
1200  CONTINUE
1400  CONTINUE
1405  CONTINUE
1410  CONTINUE
      NUMSYM=NUMSYM*NTWOSY
      WRITE (NFILST) (ACCARR(L), L=1,NUMSYM)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9002)
      IF (SYMM) RETURN
      IOFFS0=NFSYM0*V2MXP1*V2MXP1
C
C*********************************************************************
C
C THIS THE THE END OF THE CALCULATION FOR THE SYMMETRICAL MOLECULE.
C WE NOW CALCULATE INTEGRALS FOR THE UNSYMMETRICAL CASE.
C
C*********************************************************************
C
C START LOOP OVER K FOR CALCULATING THE DELTAK=2 MATRIX ELEMENTS
C
      NUMASY=0
      DO 2810 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB=K1VAL*NSTINT
C
C
      DO 2805 KDEL=-2,2,4
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 2805
      K2VAL = K2P1 - 1
      INDB2=K2VAL*NSTINT
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 2800 INDEX1=1,V2MP11
C
      IREC1=(K1P1-1)*V2MP11+INDEX1
      READ (NFIL7,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 2600 INDEX2=1,V2MP12
      IREC2=(K2P1-1)*V2MP12+INDEX2
      READ (NFIL28,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
C
      DO 2500 I=1,NSTINT,2
      IOFFS=(I-1)*NFASYJ
      INDR=INDB+I
      INDR2=INDB2+I
      FACODD=FACOD0*(SINGM(INDR)*COSGM(INDR2)-SINGM(INDR2)
     1             *COSGM(INDR))
      FACEVE=FACEV0*(SINGM(INDR+1)*COSGM(INDR2+1)-SINGM(INDR2+1)
     1          *COSGM(INDR+1))
      SUM24=SUM24+FACODD*PHIL(I  )*ROTASY(IOFFS+ 1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 1+NFASYJ)*PHIR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*ROTASY(IOFFS+ 2)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 2+NFASYJ)*PHIR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*ROTASY(IOFFS+ 3)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 3+NFASYJ)*PHIR(I+1)
      SUM27=SUM27+FACODD*PHIL(I  )*ROTASY(IOFFS+ 4)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 4+NFASYJ)*PHIR(I+1)
      SUM28=SUM28+FACODD*PHIL(I  )*ROTASY(IOFFS+ 5)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 5+NFASYJ)*PHIR(I+1)
      SUM29=SUM29+FACODD*PHIL(I  )*ROTASY(IOFFS+ 6)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 6+NFASYJ)*PHIR(I+1)
      SUM30=SUM30+FACODD*PHIL(I  )*ROTASY(IOFFS+ 7)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 7+NFASYJ)*PHIR(I+1)
      SUM31=SUM31+FACODD*PHIL(I  )*ROTASY(IOFFS+ 8)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 8+NFASYJ)*PHIR(I+1)
      SUM32=SUM32+FACODD*PHIL(I  )*ROTASY(IOFFS+ 9)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 9+NFASYJ)*PHIR(I+1)
      SUM33=SUM33+FACODD*PHIL(I  )*ROTASY(IOFFS+10)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+10+NFASYJ)*PHIR(I+1)
      SUM34=SUM34+FACODD*PHIL(I  )*ROTASY(IOFFS+11)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+11+NFASYJ)*PHIR(I+1)
      SUM35=SUM35+FACODD*PHIL(I  )*ROTASY(IOFFS+12)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+12+NFASYJ)*PHIR(I+1)
2500  CONTINUE
      NUMASY=NUMASY+1
      IOFFS=(NUMASY-1)*NTWOAS
      ACCARR(IOFFS+ 1)=SUM24
      ACCARR(IOFFS+ 2)=SUM25
      ACCARR(IOFFS+ 3)=SUM26
      ACCARR(IOFFS+ 4)=SUM27
      ACCARR(IOFFS+ 5)=SUM28
      ACCARR(IOFFS+ 6)=SUM29
      ACCARR(IOFFS+ 7)=SUM30
      ACCARR(IOFFS+ 8)=SUM31
      ACCARR(IOFFS+ 9)=SUM32
      ACCARR(IOFFS+10)=SUM33
      ACCARR(IOFFS+11)=SUM34
      ACCARR(IOFFS+12)=SUM35
2600  CONTINUE
2800  CONTINUE
2805  CONTINUE
2810  CONTINUE
      NUMASY=NUMASY*NTWOAS
      WRITE (NFILST) (ACCARR(L), L=1,NUMASY)
      IF (IPRINT .NE. 0) WRITE (NFIL6,9003)
      RETURN
9001  FORMAT(1H0,' RENTEL.IPM.INF   DK=2 INTEGRATION ROUTINE ENTERED'/)
9002  FORMAT(1H0,' RENTEL.IPM.INF   SYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=2'/)
9003  FORMAT(1H0,' RENTEL.IPM.INF   UNSYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=2'/)
      END
