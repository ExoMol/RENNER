      SUBROUTINE BCOEF
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : BCOEF CALCULATES (FOR A GIVEN RHO VALUE) THE EXPANSION
C             : COEFFICIENTS (TO FOURTH ORDER) OF THE S I'S IN TERMS
C             : OF THE DELTA R I'S.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : THE EXPANSION COEFFICIENTS OF MINUS COSINE RHO BAR IN
C             : TERMS OF THE DELTA R I'S ARE OUTPUT IN COMMON CRCOEF
C             :
C             :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      EPSP,EPSPP,EPSPPP,CR,SR,CSE,SNE,
     2      CRE,SRE,CORO
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 A11,A33,A13,A31,A111,A133,A113,A311,A333,A313
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A11=2.E0*RE12
      A13=0.E0
      A111=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.E0*SR**2*U13*U3*CR*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.E0
      A33=2.E0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.E0*SR**2*U13*U1*CR*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      B11=1.E0
      B13=0.E0
      B31=0.E0
      B33=1.E0
      B111=(-A111+1.E0)/(2.E0*RE12)
      B133=(-A133)/(2.E0*RE12)
      B113=(-A113)/(2.E0*RE12)
      B311=(-A311)/(2.E0*RE32)
      B333=(-A333+1.E0)/(2.E0*RE32)
      B313=(-A313)/(2.E0*RE32)
      B1111=(RE12*A113*A311+2.E0*A111**2*RE32-2.E0*A111*RE32)/(4.E0*
     1 RE12**2*RE32)
      B1333=(A133*(2.E0*RE12*A333-2.E0*RE12+A113*RE32))/(4.E0*RE12**2*
     1 RE32)
      B1113=(RE12*A113*A313+2.E0*RE12*A133*A311+3.E0*A111*A113*RE32-
     1 A113*RE32)/(4.E0*RE12**2*RE32)
      B1133=(RE12*A113*A333-RE12*A113+2.E0*RE12*A133*A313+2.E0*A111*
     1 A133*RE32+A113**2*RE32)/(4.E0*RE12**2*RE32)
      B3111=(A311*(RE12*A313+2.E0*A111*RE32-2.E0*RE32))/(4.E0*RE12*
     1 RE32**2)
      B3333=(2.E0*RE12*A333**2-2.E0*RE12*A333+A133*RE32*A313)/(4.E0*
     1 RE12*RE32**2)
      B3113=(2.E0*RE12*A311*A333+RE12*A313**2+A111*RE32*A313+2.E0*
     1 A113*RE32*A311-RE32*A313)/(4.E0*RE12*RE32**2)
      B3133=(3.E0*RE12*A313*A333-RE12*A313+A113*RE32*A313+2.E0*A133*
     1 RE32*A311)/(4.E0*RE12*RE32**2)
      B11111=(-RE12**2*A113*A311*A313-RE12**2*A133*A311**2-5.E0*
     1 RE12*A111*A113*RE32*A311+3.E0*RE12*A113*RE32*A311-5.E0*A111**
     1 3*RE32**2+6.E0*A111**2*RE32**2-A111*RE32**2)/(8.E0*RE12**3*
     1 RE32**2)
      B13333=(A133*(-5.E0*RE12**2*A333**2+6.E0*RE12**2*A333-RE12**2-
     1 3.E0*RE12*A113*RE32*A333+3.E0*RE12*A113*RE32
     1 -2.E0*RE12*A133*RE32
     1 *A313-A111*A133*RE32**2-A113**2*RE32**2))/(8.E0*RE12**3*
     1 RE32**2)
      B11113=(-2.E0*RE12**2*A113*A311*A333-RE12**2*A113*A313**2-4.E0
     1 *RE12**2*A133*A311*A313-4.E0*RE12*A111*A113*RE32*A313-8.E0*
     1 RE12*A111*A133*RE32*A311-4.E0*RE12*A113**2*RE32*A311+2.E0*
     1 RE12*A113*RE32*A313+4.E0*RE12*A133*RE32*A311-10.E0*A111**2*
     1 A113*RE32**2+6.E0*A111*A113*RE32**2)/(8.E0*RE12**3*RE32**2)
      B11333=(-2.E0*RE12**2*A113*A333**2+2.E0*RE12**2*A113*A333-8.E0*
     1 RE12**2*A133*A313*A333+4.E0*RE12**2*A133*A313-4.E0*RE12*A111*
     1 A133*RE32*A333+4.E0*RE12*A111*A133*RE32-2.E0*RE12*A113**2*
     1 RE32*A333+2.E0*RE12*A113**2*RE32-6.E0*RE12*A113*A133*RE32*
     1 A313-4.E0*RE12*A133**2*RE32*A311-6.E0*A111*A113*A133*RE32**2-
     1 A113**3*RE32**2)/(8.E0*RE12**3*RE32**2)
      B11133=(-3.E0*RE12**2*A113*A313*A333+RE12**2*A113*A313-6.E0*
     1 RE12**2*A133*A311*A333+2.E0*RE12**2*A133*A311-3.E0*RE12**2*
     1 A133*A313**2-3.E0*RE12*A111*A113*RE32*A333+3.E0*RE12*A111*
     1 A113*RE32-6.E0*RE12*A111*A133*RE32*A313-3.E0*RE12*A113**2*
     1 RE32*A313-9.E0*RE12*A113*A133*RE32*A311+RE12*A113*RE32*A333
     1 -RE12*A113*RE32+2.E0*RE12*A133*RE32*A313-6.E0*A111**2*A133*
     1 RE32**2-6.E0*A111*A113**2*RE32**2+2.E0*A111*A133*RE32**2+A113
     1 **2*RE32**2)/(8.E0*RE12**3*RE32**2)
      B31111=(A311*(-RE12**2*A311*A333-RE12**2*A313**2-3.E0*RE12*
     1 A111*RE32*A313-2.E0*RE12*A113*RE32*A311+3.E0*RE12*RE32*A313-
     1 5.E0*A111**2*RE32**2+6.E0*A111*RE32**2-RE32**2))/(8.E0*RE12**2*
     1 RE32**3)
      B33333=(-5.E0*RE12**2*A333**3+6.E0*RE12**2*A333**2-RE12**2*
     1 A333-5.E0*RE12*A133*RE32*A313*A333+3.E0*RE12*A133*RE32*A313-
     1 A113*A133*RE32**2*A313-A133**2*RE32**2*A311)/(8.E0*RE12**2*
     1 RE32**3)
      B31113=(-6.E0*RE12**2*A311*A313*A333-RE12**2*A313**3-4.E0*RE12
     1 *A111*RE32*A311*A333-2.E0*RE12*A111*RE32*A313**2-6.E0*RE12*
     1 A113*RE32*A311*A313-4.E0*RE12*A133*RE32*A311**2+4.E0*RE12*
     1 RE32*A311*A333+2.E0*RE12*RE32*A313**2-2.E0*A111**2*RE32**2*
     1 A313-8.E0*A111*A113*RE32**2*A311+2.E0*A111*RE32**2*A313+4.E0*
     1 A113*RE32**2*A311)/(8.E0*RE12**2*RE32**3)
      B31333=(-10.E0*RE12**2*A313*A333**2+6.E0*RE12**2*A313*A333-4.E0*
     1 RE12*A113*RE32*A313*A333+2.E0*RE12*A113*RE32*A313-8.E0*RE12*
     1 A133*RE32*A311*A333+4.E0*RE12*A133*RE32*A311-4.E0*RE12*A133*
     1 RE32*A313**2-2.E0*A111*A133*RE32**2*A313-A113**2*RE32**2*
     1 A313-4.E0*A113*A133*RE32**2*A311)/(8.E0*RE12**2*RE32**3)
      B31133=(-6.E0*RE12**2*A311*A333**2+2.E0*RE12**2*A311*A333-6.E0*
     1 RE12**2*A313**2*A333+RE12**2*A313**2-3.E0*RE12*A111*RE32*
     1 A313*A333+RE12*A111*RE32*A313-6.E0*RE12*A113*RE32*A311*A333
     1 +2.E0*RE12*A113*RE32*A311-3.E0*RE12*A113*RE32*A313**2-9.E0*RE12
     1 *A133*RE32*A311*A313+3.E0*RE12*RE32*A313*A333-RE12*RE32*
     1 A313-3.E0*A111*A113*RE32**2*A313-6.E0*A111*A133*RE32**2*A311-
     1 3.E0*A113**2*RE32**2*A311+A113*RE32**2*A313+2.E0*A133*RE32**2*
     1 A311)/(8.E0*RE12**2*RE32**3)
      END
C
C
      SUBROUTINE COSRB
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : CALCULATION OF THE EXPANSION COEFFICIENTS OF COSINE RHO
C             : BAR IN TERMS OF THE DELTA R I'S.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : THE EXPANSION COEFFICIENTS OF MINUS COSINE RHO BAR IN
C             : TERMS OF THE DELTA R I'S ARE OUTPUT IN COMMON CRCOEF
C             :
C             :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      EPSP,EPSPP,EPSPPP,CR,SR,CSE,SNE,
     2      CRE,SRE,CORO
C
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 A11,A33,A13,A31,A111,A133,A113,A311,A333,A313,
     1      C11,C13,C211,C233,C213,
     2      Q1,Q3,Q11,Q33,Q13,Q111,Q333,Q113,Q133,Q1111,Q3333,
     3      Q1113,Q1333,Q1133
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A11=2.E0*RE12
      A13=0.E0
      A111=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.E0*SR**2*U13*U3*CR*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.E0
      A33=2.E0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.E0*SR**2*U13*U1*CR*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      C11=((V*CR-SR**2*U1)*RE32)/(V+SR**2*U13)
      C13=((V*CR-SR**2*U3)*RE12)/(V+SR**2*U13)
      C211=(-(V+U13)*SR**2*U1*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4*
     1 U13**2)*RE12)
      C233=(-(V+U13)*SR**2*U3*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4*
     1 U13**2)*RE32)
      C213=((V**2+SR**2*U13**2+SR**2*U3*U1)*CR)/(V**2+2.E0*V*SR**2
     1 *U13+SR**4*U13**2)
      Q1=(-RE32*CR+B31*C13+B11*C11)/(RE12*RE32)
      Q3=(-RE12*CR+B33*C13+B13*C11)/(RE12*RE32)
      Q11=(RE12*(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11
     1 **2*C211)+RE32*CR-(B31*C13+B11*C11))/(RE12**2*RE32)
      Q33=(RE12*CR+RE32*(B333*C13+B33**2*C233+B33*B13*C213+B133*
     1 C11+B13**2*C211)-(B33*C13+B13*C11))/(RE12*RE32**2)
      Q13=(RE12*RE32*(B313*C13+2.E0*B33*B31*C233+B33*B11*C213+B31*
     1 B13*C213+B113*C11+2.E0*B13*B11*C211+CR)-RE12*(B31*C13+B11*
     1 C11)-RE32*(B33*C13+B13*C11))/(RE12**2*RE32**2)
      Q111=(RE12**2*(B3111*C13+2.E0*B311*B31*C233+B311*B11*C213+
     1 B31*B111*C213+B1111*C11+2.E0*B111*B11*C211)-RE12*(B311*C13+
     1 B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)-RE32*CR+
     1 B31*C13+B11*C11)/(RE12**3*RE32)
      Q333=(-RE12*CR+RE32**2*(B3333*C13+2.E0*B333*B33*C233+B333*
     1 B13*C213+B33*B133*C213+B1333*C11+2.E0*B133*B13*C211)-RE32*(
     1 B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13**2*C211)+
     1 B33*C13+B13*C11)/(RE12*RE32**3)
      Q113=(RE12**2*RE32*(B3113*C13+2.E0*B313*B31*C233+B313*B11*
     1 C213+2.E0*B311*B33*C233+B311*B13*C213+B33*B111*C213+B31*
     1 B113*C213+B1113*C11+2.E0*B113*B11*C211+2.E0*B111*B13*C211)-
     1 RE12**2*(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**
     1 2*C211)+RE12*RE32*(-B313*C13-2.E0*B33*B31*C233-B33*B11*C213
     1 -B31*B13*C213-B113*C11-2.E0*B13*B11*C211-CR)+RE12*(B31*C13+
     1 B11*C11)+RE32*(B33*C13+B13*C11))/(RE12**3*RE32**2)
      Q133=(RE12*RE32**2*(B3133*C13+2.E0*B313*B33*C233+B313*B13*
     1 C213+2.E0*B333*B31*C233+B333*B11*C213+B33*B113*C213+B31*
     1 B133*C213+B1133*C11+2.E0*B113*B13*C211+2.E0*B133*B11*C211)+
     1 RE12*RE32*(-B313*C13-2.E0*B33*B31*C233-B33*B11*C213-B31*B13
     1 *C213-B113*C11-2.E0*B13*B11*C211-CR)+RE12*(B31*C13+B11*C11)
     1 -RE32**2*(B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13
     1 **2*C211)+RE32*(B33*C13+B13*C11))/(RE12**2*RE32**3)
      Q1111=(RE12**3*(B31111*C13+2.E0*B3111*B31*C233+B3111*B11*
     1 C213+B311**2*C233+B311*B111*C213+B31*B1111*C213+B11111*
     1 C11+2.E0*B1111*B11*C211+B111**2*C211)+RE12**2*(-B3111*C13-
     1 2.E0*B311*B31*C233-B311*B11*C213-B31*B111*C213-B1111*C11-2.E0*
     1 B111*B11*C211)+RE12*(B311*C13+B31**2*C233+B31*B11*C213+
     1 B111*C11+B11**2*C211)+RE32*CR-(B31*C13+B11*C11))/(RE12**4
     1 *RE32)
      Q3333=(RE12*CR+RE32**3*(2.E0*B3333*B33*C233+B3333*B13*C213+
     1 B333**2*C233+B333*B133*C213+B33*B1333*C213+B13333*C11+2.E0*
     1 B1333*B13*C211+B133**2*C211+C13*B33333)+RE32**2*(-B3333*
     1 C13-2.E0*B333*B33*C233-B333*B13*C213-B33*B133*C213-B1333*
     1 C11-2.E0*B133*B13*C211)+RE32*(B333*C13+B33**2*C233+B33*B13*
     1 C213+B133*C11+B13**2*C211)-(B33*C13+B13*C11))/(RE12*RE32
     1 **4)
      Q1113=(RE12**3*RE32*(2.E0*B3113*B31*C233+B3113*B11*C213+2.E0*
     1 B3111*B33*C233+B3111*B13*C213+2.E0*B313*B311*C233+B313*B111
     1 *C213+B311*B113*C213+B33*B1111*C213+B31*B1113*C213+B11113
     1 *C11+2.E0*B1113*B11*C211+2.E0*B1111*B13*C211+2.E0*B113*B111*
     1 C211+C13*B31113)+RE12**3*(-B3111*C13-2.E0*B311*B31*C233-
     1 B311*B11*C213-B31*B111*C213-B1111*C11-2.E0*B111*B11*C211)+
     1 RE12**2*RE32*(-B3113*C13-2.E0*B313*B31*C233-B313*B11*C213-
     1 2.E0*B311*B33*C233-B311*B13*C213-B33*B111*C213-B31*B113*C213
     1 -B1113*C11-2.E0*B113*B11*C211-2.E0*B111*B13*C211)+RE12**2*(
     1 B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)+
     1 RE12*RE32*(B313*C13+2.E0*B33*B31*C233+B33*B11*C213+B31*B13*
     1 C213+B113*C11+2.E0*B13*B11*C211+CR)-RE12*(B31*C13+B11*C11)-
     1 RE32*(B33*C13+B13*C11))/(RE12**4*RE32**2)
      Q1333=(RE32**3*RE12*(2.E0*B1133*B13*C211+B1133*B33*C213+2.E0*
     1 B1333*B11*C211+B1333*B31*C213+2.E0*B113*B133*C211+B113*B333
     1 *C213+B133*B313*C213+B11*B3333*C213+B13*B3133*C213+B31333
     1 *C13+2.E0*B3133*B33*C233+2.E0*B3333*B31*C233+2.E0*B313*B333*
     1 C233+C11*B11333)+RE32**3*(-B1333*C11-2.E0*B133*B13*C211-
     1 B133*B33*C213-B13*B333*C213-B3333*C13-2.E0*B333*B33*C233)+
     1 RE32**2*RE12*(-B1133*C11-2.E0*B113*B13*C211-B113*B33*C213-
     1 2.E0*B133*B11*C211-B133*B31*C213-B11*B333*C213-B13*B313*C213
     1 -B3133*C13-2.E0*B313*B33*C233-2.E0*B333*B31*C233)+RE32**2*(
     1 B133*C11+B13**2*C211+B13*B33*C213+B333*C13+B33**2*C233)+
     1 RE32*RE12*(B113*C11+2.E0*B11*B13*C211+B11*B33*C213+B13*B31*
     1 C213+B313*C13+2.E0*B31*B33*C233+CR)-RE32*(B13*C11+B33*C13)-
     1 RE12*(B11*C11+B31*C13))/(RE32**4*RE12**2)
      Q1133=(RE12**2*RE32**2*(2.E0*B3133*B31*C233+B3133*B11*C213+
     1 2.E0*B3113*B33*C233+B3113*B13*C213+B313**2*C233+B313*B113*
     1 C213+2.E0*B333*B311*C233+B333*B111*C213+B311*B133*C213+B33*
     1 B1113*C213+B31*B1133*C213+B11133*C11+2.E0*B1133*B11*C211+2.E0
     1 *B1113*B13*C211+B113**2*C211+2.E0*B133*B111*C211+C13*B31133
     1 )+RE12**2*RE32*(-B3113*C13-2.E0*B313*B31*C233-B313*B11*C213
     1 -2.E0*B311*B33*C233-B311*B13*C213-B33*B111*C213-B31*B113*
     1 C213-B1113*C11-2.E0*B113*B11*C211-2.E0*B111*B13*C211)+RE12**2
     1 *(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)
     1 +RE12*RE32**2*(-B3133*C13-2.E0*B313*B33*C233-B313*B13*C213-
     1 2.E0*B333*B31*C233-B333*B11*C213-B33*B113*C213-B31*B133*C213
     1 -B1133*C11-2.E0*B113*B13*C211-2.E0*B133*B11*C211)+RE12*RE32*(
     1 B313*C13+2.E0*B33*B31*C233+B33*B11*C213+B31*B13*C213+B113*
     1 C11+2.E0*B13*B11*C211+CR)-RE12*(B31*C13+B11*C11)+RE32**2*(
     1 B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13**2*C211)-
     1 RE32*(B33*C13+B13*C11))/(RE12**3*RE32**3)
      CR1=-Q1
      CR3=-Q3
      CR11=-Q11
      CR33=-Q33
      CR13=-Q13
      CR111=-Q111
      CR333=-Q333
      CR113=-Q113
      CR133=-Q133
      CR1111=-Q1111
      CR3333=-Q3333
      CR1113=-Q1113
      CR1333=-Q1333
      CR1133=-Q1133
      RETURN
      END
C
C
      SUBROUTINE AMAT ( A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2                 A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     3                 AP1Y1,AP1Z1,AP2Y1,AP2Z1,AP3Y1,AP3Z1,
     4                 AP1Y3,AP1Z3,AP2Y3,AP2Z3,AP3Y3,AP3Z3,
     5                 YE1,ZE1,YE2,ZE2,YE3,ZE3,
     6                 YEP1,ZEP1,YEP2,ZEP2,YEP3,ZEP3,
     7                 YEPP1,ZEPP1,YEPP2,ZEPP2,YEPP3,ZEPP3)
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : CALCULATION OF THE A MATRIX, ITS DERIVATIVES AND THE
C            : A VECTOR COMPONENTS AND THEIR DERIVATIVES.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
C                
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      EPSP,EPSPP,EPSPPP,CR,SR,CSE,SNE,
     2      CRE,SRE,CORO
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8  A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2       A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     3       AP1Y1,AP1Z1,AP2Y1,AP2Z1,AP3Y1,AP3Z1,
     4       AP1Y3,AP1Z3,AP2Y3,AP2Z3,AP3Y3,AP3Z3,
     5       YE1,ZE1,YE2,ZE2,YE3,ZE3,
     6       YEP1,ZEP1,YEP2,ZEP2,YEP3,ZEP3,
     7       YEPP1,ZEPP1,YEPP2,ZEPP2,YEPP3,ZEPP3
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A1Y1=((M3+M2)*SRE*M2)/(SR**2*M1*M3+M*M2)
      A1Z1=(-(M3+M2)*CRE*M2)/(SR**2*M1*M3+M*M2)
      A2Y1=(-((M3+M2)*SRE+CR*SNE*M3)*M1)/(
     1 SR**2*M1*M3+M*M2)
      A2Z1=(((M3+M2)*CRE-CR*CSE*M3)*M1)/(
     1 SR**2*M1*M3+M*M2)
      A3Y1=(CR*SNE*M1*M2)/(SR**2*M1*M3+M*
     1 M2)
      A3Z1=(CR*CSE*M1*M2)/(SR**2*M1*M3+M*
     1 M2)
      A1Y3=(CR*SRE*M3*M2)/(SR**2*M1*M3+M*
     1 M2)
      A1Z3=(-CR*CRE*M3*M2)/(SR**2*M1*M3+M*
     1 M2)
      A2Y3=(-((M1+M2)*SNE+CR*SRE*M1)*M3)/(
     1 SR**2*M1*M3+M*M2)
      A2Z3=(-((M1+M2)*CSE-CR*CRE*M1)*M3)/(
     1 SR**2*M1*M3+M*M2)
      A3Y3=((M1+M2)*SNE*M2)/(SR**2*M1*M3+M*M2)
      A3Z3=((M1+M2)*CSE*M2)/(SR**2*M1*M3+M*M2)
      AP1Y1=(((SR**2*M1*M3+M*M2)*(CR*U13+U3)*
     1 CRE-2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*SRE
     1 *M1*M3)*(M3+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      AP1Z1=(((SR**2*M1*M3+M*M2)*(CR*U13+U3)*
     1 SRE+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*CRE
     1 *M1*M3)*(M3+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      AP2Y1=((((2.E0*CR*U13+U3+U1)*SR*SNE*M3
     1 -(CR*U13+U3)*(M3+M2)*CRE-(CR*U13+U1)*CR
     1 *CSE*M3)*(SR**2*M1*M3+M*M2)+2.E0*((M3+M2)*
     1 SRE+CR*SNE*M3)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M1)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP2Z1=((((2.E0*CR*U13+U3+U1)*SR*CSE*M3
     1 -(CR*U13+U3)*(M3+M2)*SRE+(CR*U13+U1)*CR
     1 *SNE*M3)*(SR**2*M1*M3+M*M2)-2.E0*((M3+M2)*
     1 CRE-CR*CSE*M3)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M1)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP3Y1=(-(((2.E0*CR*U13+U3+U1)*SR*SNE-(
     1 CR*U13+U1)*CR*CSE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*SNE
     1 *M1*M3)*M1*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP3Z1=(-(((2.E0*CR*U13+U3+U1)*SR*CSE+(
     1 CR*U13+U1)*CR*SNE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*CSE
     1 *M1*M3)*M1*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP1Y3=(-(((2.E0*CR*U13+U3+U1)*SR*SRE-(
     1 CR*U13+U3)*CR*CRE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*SRE
     1 *M1*M3)*M3*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP1Z3=((((2.E0*CR*U13+U3+U1)*SR*CRE+(
     1 CR*U13+U3)*CR*SRE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*CRE
     1 *M1*M3)*M3*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP2Y3=((((2.E0*CR*U13+U3+U1)*SR*SRE*M1
     1 -(CR*U13+U3)*CR*CRE*M1-(CR*U13+U1)
     1 *(M1+M2)*CSE)*(SR**2*M1*M3+M*M2)+2.E0*((M1+M2)*
     1 SNE+CR*SRE*M1)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M3)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP2Z3=(-(((2.E0*CR*U13+U3+U1)*SR*CRE*
     1 M1+(CR*U13+U3)*CR*SRE*M1-(CR*U13+
     1 U1)*(M1+M2)*SNE)*(SR**2*M1*M3+M*M2)-2.E0*((M1+M2
     1 )*CSE-CR*CRE*M1)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M3)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP3Y3=(((SR**2*M1*M3+M*M2)*(CR*U13+U1)*
     1 CSE-2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*SNE
     1 *M1*M3)*(M1+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      AP3Z3=(-((SR**2*M1*M3+M*M2)*(CR*U13+U1)*
     1 SNE+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*CSE
     1 *M1*M3)*(M1+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      YE1=((M3+M2)*SRE*RE12-SNE*RE32*M3)/M
      YE2=(-(SRE*RE12*M1+SNE*RE32*M3))/M
      YE3=((M1+M2)*SNE*RE32-SRE*RE12*M1)/M
      ZE1=(-((M3+M2)*CRE*RE12+CSE*RE32*M3))/M
      ZE2=(CRE*RE12*M1-CSE*RE32*M3)/M
      ZE3=((M1+M2)*CSE*RE32+CRE*RE12*M1)/M
      YEP1=((CR*U13+U3)*(M3+M2)*CRE*RE12-(CR
     1 *U13+U1)*CSE*RE32*M3)/((2.E0*CR*U13+U3+U1)*M
     1 )
      YEP2=(-((CR*U13+U3)*CRE*RE12*M1+(CR*
     1 U13+U1)*CSE*RE32*M3))/((2.E0*CR*U13+U3+U1)*M)
      YEP3=(-((CR*U13+U3)*CRE*RE12*M1-(CR*
     1 U13+U1)*(M1+M2)*CSE*RE32))/((2.E0*CR*U13+U3+U1)*
     1 M)
      ZEP1=((CR*U13+U3)*(M3+M2)*SRE*RE12+(CR
     1 *U13+U1)*SNE*RE32*M3)/((2.E0*CR*U13+U3+U1)*M
     1 )
      ZEP2=(-((CR*U13+U3)*SRE*RE12*M1-(CR*
     1 U13+U1)*SNE*RE32*M3))/((2.E0*CR*U13+U3+U1)*M)
      ZEP3=(-((CR*U13+U3)*SRE*RE12*M1+(CR*
     1 U13+U1)*(M1+M2)*SNE*RE32))/((2.E0*CR*U13+U3+U1)*
     1 M)
      YEPP1=(2.E0*((CR*U13+U3)*(M3+M2)*CRE*RE12-(
     1 CR*U13+U1)*CSE*RE32*M3)*SR*U13-(2.E0*CR
     1 *U13+U3+U1)*(M3+M2)*SR*CRE*RE12*U13+(2.E0*
     1 CR*U13+U3+U1)*SR*CSE*RE32*M3*U13-(CR
     1 *U13+U3)**2*(M3+M2)*SRE*RE12+(CR*U13+U1)**
     1 2*SNE*RE32*M3)/((2.E0*CR*U13+U3+U1)**2*M)
      YEPP2=(-(2.E0*((CR*U13+U3)*CRE*RE12*M1+(CR
     1 *U13+U1)*CSE*RE32*M3)*SR*U13-(2.E0*CR*
     1 U13+U3+U1)*SR*CRE*RE12*M1*U13-(2.E0*CR*U13
     1 +U3+U1)*SR*CSE*RE32*M3*U13-(CR*U13+U3)**
     1 2*SRE*RE12*M1-(CR*U13+U1)**2*SNE*RE32*M3)
     1 )/((2.E0*CR*U13+U3+U1)**2*M)
      YEPP3=(-(2.E0*((CR*U13+U3)*CRE*RE12*M1-(CR
     1 *U13+U1)*(M1+M2)*CSE*RE32)*SR*U13+(2.E0*CR
     1 *U13+U3+U1)*(M1+M2)*SR*CSE*RE32*U13-(2.E0*
     1 CR*U13+U3+U1)*SR*CRE*RE12*M1*U13-(CR
     1 *U13+U3)**2*SRE*RE12*M1+(CR*U13+U1)**2*(M1
     1 +M2)*SNE*RE32))/((2.E0*CR*U13+U3+U1)**2*M)
      ZEPP1=(2.E0*((CR*U13+U3)*(M3+M2)*SRE*RE12+(
     1 CR*U13+U1)*SNE*RE32*M3)*SR*U13-(2.E0*CR
     1 *U13+U3+U1)*(M3+M2)*SR*SRE*RE12*U13-(2.E0*
     1 CR*U13+U3+U1)*SR*SNE*RE32*M3*U13+(CR
     1 *U13+U3)**2*(M3+M2)*CRE*RE12+(CR*U13+U1)**
     1 2*CSE*RE32*M3)/((2.E0*CR*U13+U3+U1)**2*M)
      ZEPP2=(-(2.E0*((CR*U13+U3)*SRE*RE12*M1-(CR
     1 *U13+U1)*SNE*RE32*M3)*SR*U13-(2.E0*CR*
     1 U13+U3+U1)*SR*SRE*RE12*M1*U13+(2.E0*CR*U13
     1 +U3+U1)*SR*SNE*RE32*M3*U13+(CR*U13+U3)**
     1 2*CRE*RE12*M1-(CR*U13+U1)**2*CSE*RE32*M3)
     1 )/((2.E0*CR*U13+U3+U1)**2*M)
      ZEPP3=(-(2.E0*((CR*U13+U3)*SRE*RE12*M1+(CR
     1 *U13+U1)*(M1+M2)*SNE*RE32)*SR*U13-(2.E0*CR
     1 *U13+U3+U1)*(M1+M2)*SR*SNE*RE32*U13-(2.E0*
     1 CR*U13+U3+U1)*SR*SRE*RE12*M1*U13+(CR
     1 *U13+U3)**2*CRE*RE12*M1+(CR*U13+U1)**2*(M1
     1 +M2)*CSE*RE32))/((2.E0*CR*U13+U3+U1)**2*M)
      RETURN
      END
C
C
      SUBROUTINE TRNSRY ( RCOEF , YCOEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : TRANSFORMATION OF A FOURTH ORDER POLYNOMIAL IN THE R
C            : SUB I'S TO A FOURTH ORDER POLYNOMIAL IN THE Y SUB I'S
C            : THE CODE IS GENERATED BY REDUCE.
C            :
C INPUT      : RCOEF(1:15) THE COEFFICIENTS OF A FOURTH ORDER POLYNOMIAL
C            :             IN THE DELTA R I'S.
C            :
C OUTPUT     : YCOEF(1:15) THE COEFFICIENTS OF THE CORRESPONDING
C            :             POLYNOMIAL IN THE Y I'S.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 RCOEF(15),YCOEF(15)
      REAL*8 FCR0,FCR1,FCR3,FCR11,FCR33,FCR13,
     1      FCR111,FCR333,FCR113,FCR133,
     2      FCR1111,FCR3333,FCR1113,FCR1333,FCR1133,
     3      Q0,Q1,Q3,Q11,Q33,Q13,
     4      Q111,Q333,Q113,Q133,
     5      Q1111,Q3333,Q1113,Q1333,Q1133
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      FCR0=RCOEF(1)
      FCR1=RCOEF(2)
      FCR3=RCOEF(3)
      FCR11=RCOEF(4)
      FCR33=RCOEF(5)
      FCR13=RCOEF(6)
      FCR111=RCOEF(7)
      FCR333=RCOEF(8)
      FCR113=RCOEF(9)
      FCR133=RCOEF(10)
      FCR1111=RCOEF(11)
      FCR3333=RCOEF(12)
      FCR1113=RCOEF(13)
      FCR1333=RCOEF(14)
      FCR1133=RCOEF(15)
      Q0=FCR0
      Q1=FCR1/AA1
      Q3=FCR3/AA3
      Q11=(2.E0*FCR11+FCR1*AA1)/(2.E0*AA1**2)
      Q33=(2.E0*FCR33+FCR3*AA3)/(2.E0*AA3**2)
      Q13=FCR13/(AA3*AA1)
      Q111=(3.E0*FCR111+3.E0*FCR11*AA1+FCR1*AA1**2)/(3.E0*AA1**3)
      Q333=(3.E0*FCR333+3.E0*FCR33*AA3+FCR3*AA3**2)/(3.E0*AA3**3)
      Q113=(2.E0*FCR113+FCR13*AA1)/(2.E0*AA3*AA1**2)
      Q133=(2.E0*FCR133+FCR13*AA3)/(2.E0*AA3**2*AA1)
      Q1111=(12.E0*FCR1111+18.E0*FCR111*AA1+11.E0*FCR11*AA1**2+3.E0*FCR1
     1 *AA1**3)/(12.E0*AA1**4)
      Q3333=(12.E0*FCR3333+18.E0*FCR333*AA3+11.E0*FCR33*AA3**2+3.E0*FCR3
     1 *AA3**3)/(12.E0*AA3**4)
      Q1113=(3.E0*FCR1113+3.E0*FCR113*AA1+FCR13*AA1**2)/(3.E0*AA3*AA1
     1 **3)
      Q1333=(3.E0*FCR1333+3.E0*FCR133*AA3+FCR13*AA3**2)/(3.E0*AA3**3*
     1 AA1)
      Q1133=(4.E0*FCR1133+2.E0*FCR133*AA1+2.E0*FCR113*AA3+FCR13*AA3*
     1 AA1)/(4.E0*AA3**2*AA1**2)
      YCOEF(1)=Q0
      YCOEF(2)=Q1
      YCOEF(3)=Q3
      YCOEF(4)=Q11
      YCOEF(5)=Q33
      YCOEF(6)=Q13
      YCOEF(7)=Q111
      YCOEF(8)=Q333
      YCOEF(9)=Q113
      YCOEF(10)=Q133
      YCOEF(11)=Q1111
      YCOEF(12)=Q3333
      YCOEF(13)=Q1113
      YCOEF(14)=Q1333
      YCOEF(15)=Q1133
      RETURN
      END
C
C
      SUBROUTINE TRNSSR ( XS , XR )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 28.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : TRANSFORMATION FROM A SECOND ORDER POLYNOMIAL IN THE
C            : S I'S TO A FOURTH ORDER POLYNOMIAL IN THE DELTA R I'S.E0
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 XS(6),XR(15)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      XR(1) = XS(1)
      XR(2)=B31*XS(3)+B11*XS(2)
      XR(3)=B33*XS(3)+B13*XS(2)
      XR(4)=
     1 B311*XS(3)+B31**2*XS(5)+B31*B11*XS(6)+B111*XS(2)+B11**2*XS(4)
      XR(5)=
     1 B333*XS(3)+B33**2*XS(5)+B33*B13*XS(6)+B133*XS(2)+B13**2*XS(4)
      XR(6)=
     1 B313*XS(3)+2.E0*B33*B31*XS(5)+B33*B11*XS(6)+B31*B13*XS(6)+
     2 B113*XS(2)+2.E0*B13*B11*XS(4)
      XR(7)=
     1 B3111*XS(3)+2.E0*B311*B31*XS(5)+B311*B11*XS(6)+B31*B111*
     2 XS(6)+B1111*XS(2)+2.E0*B111*B11*XS(4)
      XR(8)=
     1 B3333*XS(3)+2.E0*B333*B33*XS(5)+B333*B13*XS(6)+B33*B133*
     2 XS(6)+B1333*XS(2)+2.E0*B133*B13*XS(4)
      XR(9)=
     1 B3113*XS(3)+2.E0*B313*B31*XS(5)+B313*B11*XS(6)+2.E0*B311*B33*
     2 XS(5)+B311*B13*XS(6)+B33*B111*XS(6)+B31*B113*XS(6)+B1113*XS(2)+
     3 2.E0*B113*B11*XS(4)+2.E0*B111*B13*XS(4)
      XR(10)=
     1 B3133*XS(3)+2.E0*B313*B33*XS(5)+B313*B13*XS(6)+2.E0*B333*B31*
     2 XS(5)+B333*B11*XS(6)+B33*B113*XS(6)+B31*B133*XS(6)+B1133*XS(2)+
     3 2.E0*B113*B13*XS(4)+2.E0*B133*B11*XS(4)
      XR(11)=
     1 B31111*XS(3)+2.E0*B3111*B31*XS(5)+B3111*B11*XS(6)+B311**2*
     2 XS(5)+B311*B111*XS(6)+B31*B1111*XS(6)+B11111*XS(2)+2.E0*B1111*
     3 B11*XS(4)+B111**2*XS(4)
      XR(12)=
     1 2.E0*B3333*B33*XS(5)+B3333*B13*XS(6)+B333**2*XS(5)+B333*
     2 B133*XS(6)+B33*B1333*XS(6)+B13333*XS(2)+2.E0*B1333*B13*XS(4)+
     3 B133**2*XS(4)+XS(3)*B33333
      XR(13)=
     1 2.E0*B3113*B31*XS(5)+B3113*B11*XS(6)+2.E0*B3111*B33*XS(5)+
     2 B3111*B13*XS(6)+2.E0*B313*B311*XS(5)+B313*B111*XS(6)+B311*B113
     3 *XS(6)+B33*B1111*XS(6)+B31*B1113*XS(6)+B11113*XS(2)+2.E0*B1113*
     4 B11*XS(4)+2.E0*B1111*B13*XS(4)+2.E0*B113*B111*XS(4)+XS(3)*B31113
      XR(14)=
     1 2.E0*B3133*B33*XS(5)+B3133*B13*XS(6)+2.E0*B3333*B31*XS(5)+
     2 B3333*B11*XS(6)+2.E0*B313*B333*XS(5)+B313*B133*XS(6)+B333*B113
     3 *XS(6)+B33*B1133*XS(6)+B31*B1333*XS(6)+B11333*XS(2)+2.E0*B1133*
     4 B13*XS(4)+2.E0*B1333*B11*XS(4)+2.E0*B113*B133*XS(4)+XS(3)*B31333
      XR(15)=
     1 2.E0*B3133*B31*XS(5)+B3133*B11*XS(6)+2.E0*B3113*B33*XS(5)+
     2 B3113*B13*XS(6)+B313**2*XS(5)+B313*B113*XS(6)+2.E0*B333*B311*
     3 XS(5)+B333*B111*XS(6)+B311*B133*XS(6)+B33*B1113*XS(6)+B31*
     4 B1133*XS(6)+B11133*XS(2)+2.E0*B1133*B11*XS(4)+2.E0*B1113
     5 *B13*XS(4)+B113**2*XS(4)+2.E0*B133*B111*XS(4)
     6 +XS(3)*B31133
      RETURN
      END
C
C
      SUBROUTINE SOLVD (X,I1,I2,MM,N,LENI,DET,TEST)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
C
      INTEGER LENI,MM,N,I,J,K,IROW,JCOL
      INTEGER I1(LENI), I2(LENI)
      REAL*8 X(MM,N),T,DET,BIG,TEST,PIV,TEMP
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      EQUIVALENCE (BIG,TEMP,PIV)
C
C     INITIALIZATION
C
      DET = 1.E0
      TEMP = ABS(PREC)
      IF (TEMP .EQ. 0.E0)  TEMP = 0.5E-14
      TEST = 0.E0
      DO 1 I = 1,MM
      I2(I) = 0
      DO 1 J = 1,MM
1     TEST = TEST + X(I,J) * X(I,J)
      TEST = TEMP * SQRT(TEST) / MM
C
C     SEARCH FOR NEXT PIVOT, AVOIDING ROWS AND COLUMNS WHICH ALREADY
C     CONTAIN A PIVOT.
C
      DO 9 K = 1,MM
      BIG = 0.E0
      DO 3 I = 1,MM
      IF (I2(I) .NE. 0) GO TO 3
      DO 2 J = 1,MM
      IF (I2(J) .NE. 0) GO TO 2
      T =ABS(X(I,J))
      IF (T .LE. BIG) GO TO 2
      BIG = T
      IROW = I
      JCOL = J
2     CONTINUE
3     CONTINUE
      IF (BIG .LE. TEST) RETURN
C
C     RECORD POSITION OF PIVOT THEN MOVE PIVOTAL ROW SO PIVOT LIES ON
C     THE DIAGONAL. SCALE PIVOTAL ROW.
C
      I1(K) = JCOL
      I2(JCOL) = IROW
      IF (JCOL .EQ. IROW) GO TO 6
      DO 5 J = 1,N
      TEMP = X(IROW,J)
      X(IROW,J) = X(JCOL,J)
5     X(JCOL,J) = TEMP
      DET = -DET
6     DET = DET * X(JCOL,JCOL)
      PIV = 1.E0/X(JCOL,JCOL)
      DO 7 J = 1,N
      IF (J .NE. JCOL)  X(JCOL,J) = PIV * X(JCOL,J)
7     CONTINUE
      X(JCOL,JCOL) = PIV
C
C     ELIMINATE REMAINING ROWS.
C
      DO 9 I = 1,MM
      IF (I .EQ. JCOL)  GO TO 9
      PIV = -X(I,JCOL)
      DO 8 J = 1,N
      IF (J .NE. JCOL)  X(I,J) = X(I,J) + PIV * X(JCOL,J)
8     CONTINUE
      X(I,JCOL) = PIV * X(JCOL,JCOL)
9     CONTINUE
C
C     UNSCRAMBLE THE COLUMNS OF THE INVERSE ACCORDING TO THE ORIGINAL
C     POSITIONS OF THE PIVOTS.
C
      DO 11 K = 1,MM
      I = MM+1 - K
      JCOL = I1(I)
      IROW = I2(JCOL)
      IF (IROW .EQ. JCOL)  GO TO 11
      DO 10 I = 1,MM
      TEMP = X(I,IROW)
      X(I,IROW) = X(I,JCOL)
10    X(I,JCOL) = TEMP
11    CONTINUE
      TEST = 0.E0
      RETURN
      END
C
C
      SUBROUTINE D04AAF(IFUN, NDER, DER, EREST, FUN, IFAIL , MAXPTS)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
C
C     ***   PURPOSE   ***
C
C     A SUBROUTINE FOR NUMERICAL DIFFERENTIATION AT A POINT.  IT
C     RETURNS A SET OF APPROXIMATIONS TO THE J-TH ORDER DERIVATIVE
C     (J=1,2,...14) OF FUN(X) EVALUATED AT X = XVAL  AND, FOR EACH
C     DERIVATIVE, AN ERROR ESTIMATE ( WHICH INCLUDES THE EFFECT OF
C     AMPLIFICATION OF ROUND- OFF ERRORS).
C
C
C     ***   INPUT  PARAMETERS   ***
C
C     (1) XVAL   REAL.  THE ABSCISSA AT WHICH THE SET OF
C     DERIVATIVES IS REQUIRED.
C     (2) NDER   INTEGER. THE HIGHEST ORDER DERIVATIVE REQUIRED.
C     IF(NDER.GT.0)  ALL DERIVATIVES UP TO MIN(NDER,14) ARE
C     CALCULATED.
C     IF(NDER.LT.0 AND NDER EVEN)  EVEN ORDER DERIVATIVES
C     UP TO MIN(-NDER,14) ARE CALCULATED.
C     IF(NDER.LT.0 AND NDER ODD )  ODD  ORDER DERIVATIVES
C     UP TO MIN(-NDER,13) ARE CALCULATED.
C     (3) HBASE  REAL.  A STEP LENGTH.
C     (6) FUN    THE NAME OF A REAL*8 FUNCTION SUBPROGRAMME,
C     WHICH IS REQUIRED BY THE ROUTINE AS A SUBPROGRAMME
C     AND WHICH REPRESENTS THE FUNCTION BEING DIFFERENTIATED
C     THE ROUTINE REQUIRES 21 FUNCTION EVALUATIONS FUN(X)
C     LOCATED AT    X = XVAL    AND AT
C     X = XVAL + (2*J-1)*HBASE,  J=-9,-8, .... +9,+10.
C     THE FUNCTION VALUE AT  X = XVAL IS DISREGARDED WHEN
C     ONLY ODD ORDER DERIVATIVES ARE REQUIRED.
C
C     ***   OUTPUT PARAMETERS   ***
C
C     (4) DER(J)   J=1,2,...14.  REAL. A VECTOR OF
C     APPROXIMATIONS TO THE J-TH DERIVATIVE OF FUN(X)
C     EVALUATED AT X = XVAL.
C     (5) EREST(J) J=1,2,...14.  REAL. A VECTOR OF
C     ESTIMATES OF THE DABSOLUTE ACCURACY OF DER(J).  THESE
C     ARE NEGATIVE WHEN EREST(J).GT.ABS(DER(J)), OR WHEN,
C     FOR SOME OTHER REASON THE ROUTINE IS DOUBTFUL ABOUT
C     THE VALIDITY OF THE RESULT.
C
C     ***   IMPORTANT WARNING   ***
C
C     EREST IS AN ESTIMATE OF THE OVERALL ERROR.  IT IS ESSENTIAL
C     FOR
C     PROPER USE THAT THE USER CHECKS EACH VALUE OF DER
C     SUBSEQUENTLY
C     USED TO SEE THAT IT IS ACCURATE ENOUGH FOR HIS PURPOSES.
C     FAILURE TO DO THIS MAY RESULT IN THE CONTAMINATION OF ALL
C     SUBSEQUENT RESULTS.
C     IT IS TO BE EXPECTED THAT IN NEARLY ALL CASES  DER(14) WILL
C     BE
C     UNUSABLE.( 14 REPRESENTS A LIMIT IN WHICH FOR THE EASIEST
C     FUNCTION LIKELY TO BE ENCOUNTERED THIS ROUTINE MIGHT JUST
C     OBTAIN
C     AN APPROXIMATION OF THE CORRECT SIGN.)
C
C     ***   NOTE ON CALCULATION   ***
C
C     THE CALCULATION IS BASED ON THE EXTENDED T-TABLE (T SUB
C     K,P,S)
C     DESCRIBED IN LYNESS AND MOLER, NUM. MATH., 8, 458-464,(1966).
C     REFERENCES IN COMMENT CARDS TO TTAB(NK,NP,NS) REFER TO
C     T-TABLE
C     WITH NK=K+1,  NP=P+1,  NS=S+1.   SINCE ONLY PART OF THE
C     EXTENDED
C     T-TABLE IS NEEDED AT ONE TIME, THAT PART IS STORED IN
C     RTAB(10,7)
C     AND IS SUBSEQUENTLY OVERWRITTEN.  HERE
C     RTAB(NK,NP-NS+1)  =  TTAB(NK,NP,NS).
C
C     NAG COPYRIGHT 1976
C     MARK 5 RELEASE
C     MARK 6B REVISED  IER-116 (MAR 1978)
C     MARK 7 REVISED IER-139 (DEC 1978)
C     MARK 8 REVISED. IER-219 (MAR 1980)
C     MARK 8D REVISED. IER-271 (DEC 1980).
      INTEGER NDERP, NDER, NDPAR, IFAIL, N, NN1, NSQ, NPAR, NSMAX,J,
     1 NEGER, NS, NPMIN, NP, NKTOP, NPR, NK, NTOP, NMAX, NMIN,NUP, NLO,
     1 NTOPM2, JNS, P01AAF,NST2,II,IFUN
      REAL*8 SRNAME
      REAL*8 DER(4), EREST(4), FACT,
     1 ACOF(10),FZ, H, HFACT, HSQ, A, B, RANGE(7), RANMIN, TEMP, TERM,
     1RTAB(10,7), TZEROM(10), ERPREV, ERNOW, XJNS, XMAX, XMIN,XNUM,
     1 THRON2, ZERO, ONE, TWO, X02ACF, BIG, SMALL, X02ABF,HTEST, FTEST
      REAL*8 FUN(MAXPTS)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      DATA ZERO, ONE, TWO, THRON2 /0.0E0,1.0E0,2.0E0,1.5D0/
C
C     TO ALTER THE PRECISION OF THE WHOLE ROUTINE,ALTER THE
C     PRECISION
C     IN THE ABOVE DECLARATION AND DATA STATEMENTS
C
C     QUIT ON ZERO HBASE AND ZERO NDER.  SET CONTROL PARAMETER
C     NDPAR.
C     NDPAR = +1  ODD-ORDER DERIVATIVES ONLY.
C     NDPAR =  0  ALL DERIVATIVES
C     NDPAR = -1  EVEN-ORDER DERIVATIVES ONLY.
      BIG=16.0E+00**31.0E+00
      SMALL=16.0E+00**(-31.0E+00)
      IF (HBASE.EQ.ZERO) GO TO 20
      NDERP = NDER
      NDPAR = 0
      IF (NDER) 40, 20, 60
20    IFAIL=1
      RETURN
40    NDPAR = 4*(NDER/2) - 2*NDER - 1
      NDERP = -NDER
60    CONTINUE
      IF (NDERP.GT.4) NDERP = 4
C
C     NEXT, EVALUATE 21 FUNCTION VALUES , SET ACOF(N), AND SET
C     FIRST
C     COLUMN OF RTAB FOR ODD ORDER DERIVATIVES AND STORE IN TZEROM
C     THE
C     FIRST COLUMN OF RTAB FOR EVEN ORDER DERIVATIVES.
C     FZ = FUN(XVAL)
C
      FZ=FUN(IFUN)
      NST2=MAXPTS+MAXPTS
C
      DO 80 N=1,10
       NN1 = 2*N - 1
       NSQ = NN1*NN1
       ACOF(N) = NSQ
       XNUM = NN1
       H = HBASE*XNUM
C
       II=IFUN+NN1
       IF (II.GT.MAXPTS) TEMP=ZERO
C
       IF (II.LE.MAXPTS) TEMP=FUN(II)
C
       II=IFUN-NN1
       IF (II.EQ.0) TERM=ZERO
C
       IF (II.LT.0) TERM=-FUN(IABS(II))
C
       IF (II.GT.0) TERM=FUN(II)
C
       RTAB(N,1) = (TEMP-TERM)/(TWO*H)
       TZEROM(N) = (TEMP-FZ-FZ+TERM)/(TWO*H**2)
80    CONTINUE
C
C     SET UP FOR ODD-ORDER DERIVATIVES.
      IF (NDPAR.EQ.-1) GO TO 100
      NPAR = 1
      NSMAX = (NDERP+1)/2
      IF (NSMAX.LE.0) GO TO 380
      GO TO 140
C
C     SET UP FOR EVEN-ORDER DERIVATIVES.
100   CONTINUE
      NPAR = -1
      IF (NDPAR.EQ.+1) GO TO 460
      NSMAX = NDERP/2
      IF (NSMAX.LE.0) GO TO 460
C
C     SET THE FIRST COLUMN OF THE T-TABLE FOR EVEN ORDER
C     DERIVATIVES.
      DO 120 J=1,10
       RTAB(J,1) = TZEROM(J)
120   CONTINUE
140   CONTINUE
C
C     ODD-ORDER AND EVEN ORDER PATHS JOIN UP HERE.
C
      NEGER = 0
      HSQ = HBASE*HBASE
      FACT = ONE
      HFACT = ONE
      DO 360 NS=1,NSMAX
C
C     FROM HERE ON TO   STATEMENT 360 (NEAR END)  WE ARE DEALING
C     WITH A
C     SPECIFIED VALUE OF NS.
C
C     FOR EACH VALUE OF NP WE CALCULATE RANGE(NP)  WHICH IS THE
C     DIFFERE
C     BETWEEN THE GREATEST AND THE LEAST OF THE ELEMENTS
C     TTAB(NK,NP,NS)
C     AS WE GO ALONG WE DETERMINE ALSO THE MINIMUM OF RANGE(NP)
C     WHICH I
C     RANMIN = RANGE(NPMIN).
C     WE RETAIN NUP AND NLO WHICH ARE THE VALUES  OF NK GIVING THE
C     EXTREME VALUES OF TTAB(NK,NPMIN,NS).
C     THIS PART OF NS LOOP CONCLUDES AT STATEMENT NUMBER 280.
C
C
C     FIRST CALCULATE ELEMENTS OF T-TABLE  FOR CURRENT NS VALUE.
       NPMIN = NS
       IF (NS.EQ.1) NPMIN = 2
       DO 180 NP=NPMIN,7
          NKTOP = 10 - NP + 1
          NPR = NP - NS + 1
          DO 160 NK=1,NKTOP
             J = NP + NK - 1
             A = ACOF(J)
             B = ACOF(NK)
             TERM = ZERO
             TEMP = ZERO
             IF (NP.NE.NS) TEMP = A*RTAB(NK,NPR-1) -B*RTAB(NK+1,NPR-1)
             IF (NS.NE.1) TERM = -RTAB(NK,NPR) + RTAB(NK+1,NPR)
             RTAB(NK,NPR) = (TERM+TEMP)/(A-B)
160         CONTINUE
180      CONTINUE
C
C     NOW CALCULATE NUP,NLO AND RANMIN.
       DO 280 NP=NS,7
          NTOP = 11 - NP
          NPR = NP - NS + 1
          XMAX = RTAB(1,NPR)
          XMIN = RTAB(1,NPR)
          NMAX = 1
          NMIN = 1
C
          DO 200 NK=2,NTOP
             TEMP = RTAB(NK,NPR)
             IF (TEMP.GT.XMAX) NMAX = NK
             IF (TEMP.GT.XMAX) XMAX = TEMP
             IF (TEMP.LT.XMIN) NMIN = NK
             IF (TEMP.LT.XMIN) XMIN = TEMP
200         CONTINUE
C
          RANGE(NP) = XMAX - XMIN
          IF (NP.NE.NS) GO TO 220
          RANMIN = RANGE(NP)
          GO TO 240
220         CONTINUE
          IF (RANGE(NP).GE.RANMIN) GO TO 260
          RANMIN = RANGE(NP)
240         CONTINUE
          NPMIN = NP
          NUP = NMAX
          NLO = NMIN
          IF (NLO.EQ.NUP) NLO = NLO + 1
260         CONTINUE
280      CONTINUE
C
C     NEXT WE TAKE THE AVERAGE OF ALL EXCEPT THE EXTREME VALUES OF
C     TTAB(NK,NPMIN,NS) AS THE RESULT AND RANMIN AS THE ERROR
C     ESTIMATE.
       TERM = ZERO
       NTOP = 11 - NPMIN
       NTOPM2 = NTOP - 2
       XNUM = NTOPM2
       J = NPMIN - NS + 1
       DO 320 NK=1,NTOP
          IF (NK.EQ.NUP) GO TO 300
          IF (NK.EQ.NLO) GO TO 300
          TERM = TERM + RTAB(NK,J)
300         CONTINUE
320      CONTINUE
       TERM = TERM/XNUM
C
C     THE ABOVE RESULT AND ERROR ESTIMATE REFER TO TAYLOR
C     COEFFICIENT.
C     NEXT WE DO SCALING TO OBTAIN DERIVATIVE RESULTS INSTEAD.
C     JNS AND XJNS ARE ACTUAL ORDER OF DERIVATIVE BEING TREATED.
C     SAFETY FACTORS 1.5,1.5,2.0,2.0 AND 2.0 ARE MULTIPLIED INTO
C     THE
C     ERROR ESTIMATES FOR J = 10,11,12,13 AND 14 RESPECTIVELY.
C     THESE
C     HAVE BEEN CHOSEN BY INSPECTION OF PERFORMANCE STATISTICS.
C     THERE
C     IS NO ANALYTIC JUSTIFICATION FOR THESE PARTICULAR FACTORS.
       JNS = 2*NS - 1
       IF (NPAR.LT.0) JNS = 2*NS
       XJNS = JNS
       FACT = FACT*XJNS
C     TEST FOR UNDERFLOW OF HFACT
       IF (HFACT.GE.1.0E0) GO TO 330
       HTEST = HFACT*BIG
       FTEST = TERM*FACT
       IF ((TWO*RANMIN*FACT).GT.FTEST) FTEST = TWO*RANMIN*FACT
       IF (HTEST.GT.FTEST) GO TO 330
       DER(JNS) = BIG
       EREST(JNS) = -DER(JNS)
       NEGER = NEGER + 1
       GO TO 340
C     END OF CODE TO HANDLE ZERO HFACT
330      CONTINUE
       DER(JNS) = TERM*FACT/HFACT
       IF (JNS.EQ.10) RANMIN = THRON2*RANMIN
       IF (JNS.EQ.11) RANMIN = THRON2*RANMIN
       IF (JNS.GE.12) RANMIN = TWO*RANMIN
       EREST(JNS) = RANMIN*FACT/(HFACT)
C
C     SET SIGN OF EREST.  EREST NEGATIVE EITHER IF IT SWAMPS DER,
C     OR IF
C     TWO PREVIOUS CONSECUTIVE ERESTS OF THIS PARITY ARE NEGATIVE.
C     IT MAY ALSO BE SET NEGATIVE AT END (750).
       IF (NEGER.GE.2) EREST(JNS) = -EREST(JNS)
       IF (NEGER.GE.2) GO TO 340
       IF (TERM.LT.RANMIN) EREST(JNS) = -EREST(JNS)
       IF (-TERM.GE.RANMIN) EREST(JNS) = -EREST(JNS)
       IF (EREST(JNS).LT.ZERO) NEGER = NEGER + 1
       IF (EREST(JNS).GE.ZERO) NEGER = 0
340      CONTINUE
C
C     SECOND TEST FOR UNDERFLOW OF HFACT
       IF (HFACT.GE.1.0E0) GO TO 346
       IF (HFACT.EQ.0.0E0) GO TO 352
       IF (HSQ.GE.SMALL/HFACT) GO TO 346
       HFACT = 0.0E0
       GO TO 352
346      HFACT = HSQ*HFACT
352      FACT = FACT*(XJNS+ONE)
360   CONTINUE
C
380   CONTINUE
      IF (NPAR.GT.0) GO TO 100
C
C     SET SIGN OF EREST NEGATIVE IF TWO PREVIOUS CONSECUTIVE ERESTS
C     ARE NEGATIVE.
      IF (NDPAR.NE.0) GO TO 460
      IF (NDERP.LE.2) GO TO 460
      NEGER = 0
      ERPREV = EREST(1)
      DO 440 J=2,NDERP
       ERNOW = EREST(J)
       IF (NEGER.EQ.2) GO TO 400
       IF (ERPREV.GE.ZERO) GO TO 420
       IF (ERNOW.GE.ZERO) GO TO 420
400      NEGER = 2
       IF (ERNOW.GT.ZERO) EREST(J) = -ERNOW
420      ERPREV = ERNOW
440   CONTINUE
C
460   CONTINUE
      IFAIL = 0
C
C     DO 500 I=1,NDERP
C     EREST(I)=EREST(I)/DER(I)
C 500 CONTINUE
C
      RETURN
C     END OF D04AAF   ***   ***   ***   ***   ***
      END

C
C
      SUBROUTINE INVERT ( IA , IB , IO ,
     1                   MA , MB , MO )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : GIVEN A TWO BY TWO SYMMETRICAL MATRIX WHOSE ELEMENTS ARE
C            : FOURTH ORDER POLYNOMIALS IN THE R SUB I'S, INVERT
C            : CALCULATES THE EXPANSION COEFFICIENTS TO FOURTH ORDER OF
C            : ELEMENTS OF THE INVERSE MATRIX.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 IA(15),IB(15),IO(15),MA(15),MB(15),MO(15),
     1       IA0,IA1,IA3,IA11,IA33,IA13,
     2       IA111,IA333,IA113,IA133,
     3       IA1111,IA3333,IA1113,IA1333,IA1133,
     4       IB0,IB1,IB3,IB11,IB33,IB13,
     5       IB111,IB333,IB113,IB133,
     6       IB1111,IB3333,IB1113,IB1333,IB1133,
     7       IO0,IO1,IO3,IO11,IO33,IO13,
     8       IO111,IO333,IO113,IO133,
     9       IO1111,IO3333,IO1113,IO1333,IO1133
      REAL*8 MA0,MA1,MA3,MA11,MA33,MA13,
     2       MA111,MA333,MA113,MA133,
     3       MA1111,MA3333,MA1113,MA1333,MA1133,
     4       MB0,MB1,MB3,MB11,MB33,MB13,
     5       MB111,MB333,MB113,MB133,
     6       MB1111,MB3333,MB1113,MB1333,MB1133,
     7       MO0,MO1,MO3,MO11,MO33,MO13,
     8       MO111,MO333,MO113,MO133,
     9       MO1111,MO3333,MO1113,MO1333,MO1133
      REAL*8 QA0,QA1,QA3,QA11,QA33,QA13,
     2       QA111,QA333,QA113,QA133,
     3       QA1111,QA3333,QA1113,QA1333,QA1133,
     4       QB0,QB1,QB3,QB11,QB33,QB13,
     5       QB111,QB333,QB113,QB133,
     6       QB1111,QB3333,QB1113,QB1333,QB1133,
     7       QO0,QO1,QO3,QO11,QO33,QO13,
     8       QO111,QO333,QO113,QO133,
     9       QO1111,QO3333,QO1113,QO1333,QO1133
      REAL*8  D,JAA,JBB,JAB
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      IA0=IA(1)
      IA1=IA(2)
      IA3=IA(3)
      IA11=IA(4)
      IA33=IA(5)
      IA13=IA(6)
      IA111=IA(7)
      IA333=IA(8)
      IA113=IA(9)
      IA133=IA(10)
      IA1111=IA(11)
      IA3333=IA(12)
      IA1113=IA(13)
      IA1333=IA(14)
      IA1133=IA(15)
      IB0=IB(1)
      IB1=IB(2)
      IB3=IB(3)
      IB11=IB(4)
      IB33=IB(5)
      IB13=IB(6)
      IB111=IB(7)
      IB333=IB(8)
      IB113=IB(9)
      IB133=IB(10)
      IB1111=IB(11)
      IB3333=IB(12)
      IB1113=IB(13)
      IB1333=IB(14)
      IB1133=IB(15)
      IO0=IO(1)
      IO1=IO(2)
      IO3=IO(3)
      IO11=IO(4)
      IO33=IO(5)
      IO13=IO(6)
      IO111=IO(7)
      IO333=IO(8)
      IO113=IO(9)
      IO133=IO(10)
      IO1111=IO(11)
      IO3333=IO(12)
      IO1113=IO(13)
      IO1333=IO(14)
      IO1133=IO(15)
      D=IA0*IB0-IO0*IO0
      JAA=IA0/D
      JBB=IB0/D
      JAB=IO0/D
      MA0=JBB
      MB0=JAA
      MO0=-JAB
      QA1=-(IA1*MA0+MO0*IO1)
      QB1=-(IB1*MB0+MO0*IO1)
      QO1=-(IA1*MO0+MB0*IO1)
      MB1=JAA*QB1-JAB*QO1
      MO1=-JAB*QB1+JBB*QO1
      MA1=(QA1-IO0*MO1)/IA0
      QA3=-(IA3*MA0+MO0*IO3)
      QB3=-(IB3*MB0+MO0*IO3)
      QO3=-(IA3*MO0+MB0*IO3)
      MB3= JAA*QB3- JAB*QO3
      MO3=-JAB*QB3+ JBB*QO3
      MA3=    (QA3-IO0*MO3)/IA0
      QA11=-(IA11*MA0+IA1*MA1+MO1
     1 *IO1+MO0*IO11)
      QB11=-(IB11*MB0+IB1*MB1+MO1
     1 *IO1+MO0*IO11)
      QO11=-(IA11*MO0+IA1*MO1+MB1
     1 *IO1+MB0*IO11)
      MB11= JAA*QB11- JAB*QO11
      MO11=-JAB*QB11+ JBB*QO11
      MA11=    (QA11-IO0*MO11)/IA0
      QA33=-(IA33*MA0+IA3*MA3+MO3
     1 *IO3+MO0*IO33)
      QB33=-(IB33*MB0+IB3*MB3+MO3
     1 *IO3+MO0*IO33)
      QO33=-(IA33*MO0+IA3*MO3+MB3
     1 *IO3+MB0*IO33)
      MB33= JAA*QB33- JAB*QO33
      MO33=-JAB*QB33+ JBB*QO33
      MA33=    (QA33-IO0*MO33)/IA0
      QA13=-(IA13*MA0+IA3*MA1+IA1*MA3+
     1 MO3*IO1+MO1*IO3+MO0*IO13)
      QB13=-(IB13*MB0+IB3*MB1+IB1*MB3+
     1 MO3*IO1+MO1*IO3+MO0*IO13)
      QO13=-(IA13*MO0+IA3*MO1+IA1*MO3+
     1 MB3*IO1+MB1*IO3+MB0*IO13)
      MB13= JAA*QB13- JAB*QO13
      MO13=-JAB*QB13+ JBB*QO13
      MA13=    (QA13-IO0*MO13)/IA0
      QA111=-(IA111*MA0+IA11*MA1+IA1*MA11+
     1 MO11*IO1+MO1*IO11+MO0*IO111)
      QB111=-(IB111*MB0+IB11*MB1+IB1*MB11+
     1 MO11*IO1+MO1*IO11+MO0*IO111)
      QO111=-(IA111*MO0+IA11*MO1+IA1*MO11+
     1 MB11*IO1+MB1*IO11+MB0*IO111)
      MB111= JAA*QB111- JAB*QO111
      MO111=-JAB*QB111+ JBB*QO111
      MA111=    (QA111-IO0*MO111)/IA0
      QA333=-(IA333*MA0+IA33*MA3+IA3*MA33+
     1 MO33*IO3+MO3*IO33+MO0*IO333)
      QB333=-(IB333*MB0+IB33*MB3+IB3*MB33+
     1 MO33*IO3+MO3*IO33+MO0*IO333)
      QO333=-(IA333*MO0+IA33*MO3+IA3*MO33+
     1 MB33*IO3+MB3*IO33+MB0*IO333)
      MB333= JAA*QB333- JAB*QO333
      MO333=-JAB*QB333+ JBB*QO333
      MA333=    (QA333-IO0*MO333)/IA0
      QA113=-(IA113*MA0+IA13*MA1+IA11*MA3+IA3*MA11+
     1 IA1*MA13+MO13*IO1+MO11*
     1 IO3+MO3*IO11+MO1*IO13+MO0*IO113)
      QB113=-(IB113*MB0+IB13*MB1+IB11*MB3+IB3*MB11+
     1 IB1*MB13+MO13*IO1+MO11*
     1 IO3+MO3*IO11+MO1*IO13+MO0*IO113)
      QO113=-(IA113*MO0+IA13*MO1+IA11*MO3+IA3*MO11+
     1 IA1*MO13+MB13*IO1+MB11*
     1 IO3+MB3*IO11+MB1*IO13+MB0*IO113)
      MB113= JAA*QB113- JAB*QO113
      MO113=-JAB*QB113+ JBB*QO113
      MA113=    (QA113-IO0*MO113)/IA0
      QA133=-(IA133*MA0+IA13*MA3+IA33*MA1+IA3*MA13+
     1 IA1*MA33+MO13*IO3+MO33*
     1 IO1+MO3*IO13+MO1*IO33+MO0*IO133)
      QB133=-(IB133*MB0+IB13*MB3+IB33*MB1+IB3*MB13+
     1 IB1*MB33+MO13*IO3+MO33*
     1 IO1+MO3*IO13+MO1*IO33+MO0*IO133)
      QO133=-(IA133*MO0+IA13*MO3+IA33*MO1+IA3*MO13+
     1 IA1*MO33+MB13*IO3+MB33*
     1 IO1+MB3*IO13+MB1*IO33+MB0*IO133)
      MB133= JAA*QB133- JAB*QO133
      MO133=-JAB*QB133+ JBB*QO133
      MA133=    (QA133-IO0*MO133)/IA0
      QA1111=-(IA1111*MA0+IA111*MA1+IA11*MA11+IA1*
     1 MA111+MO111*IO1+MO11*
     1 IO11+MO1*IO111+MO0*IO1111)
      QB1111=-(IB111*MB1+IB11*MB11+IB1*MB111+
     1 MO111*IO1+MO11*IO11+MO1*
     1 IO111+MO0*IO1111+MB0*IB1111)
      QO1111=-(IA1111*MO0+IA111*MO1+IA11*MO11+IA1*
     1 MO111+MB111*IO1+MB11*
     1 IO11+MB1*IO111+MB0*IO1111)
      MB1111= JAA*QB1111- JAB*QO1111
      MO1111=-JAB*QB1111+ JBB*QO1111
      MA1111=    (QA1111-IO0*MO1111)/IA0
      QA3333=-(IA3333*MA0+IA333*MA3+IA33*MA33+IA3*
     1 MA333+MO333*IO3+MO33*
     1 IO33+MO3*IO333+MO0*IO3333)
      QB3333=-(IB333*MB3+IB33*MB33+IB3*MB333+
     1 MO333*IO3+MO33*IO33+MO3*
     1 IO333+MO0*IO3333+MB0*IB3333)
      QO3333=-(IA3333*MO0+IA333*MO3+IA33*MO33+IA3*
     1 MO333+MB333*IO3+MB33*
     1 IO33+MB3*IO333+MB0*IO3333)
      MB3333= JAA*QB3333- JAB*QO3333
      MO3333=-JAB*QB3333+ JBB*QO3333
      MA3333=    (QA3333-IO0*MO3333)/IA0
      QA1113=-(IA1113*MA0+IA113*MA1+IA111*MA3+IA13*
     1 MA11+IA11*MA13+IA3*MA111+IA1*MA113+
     1 MO113*IO1+MO111*IO3+MO13*
     1 IO11+MO11*IO13+MO3*IO111+MO1*IO113+MO0*
     1 IO1113)
      QB1113=-(IB113*MB1+IB111*MB3+IB13*MB11+IB11*
     1 MB13+IB3*MB111+IB1*MB113+
     1 MO113*IO1+MO111*IO3+MO13*IO11+MO11*IO13+
     1 MO3*IO111+MO1*IO113+MO0*IO1113+MB0*IB1113)
      QO1113=-(IA1113*MO0+IA113*MO1+IA111*MO3+IA13*
     1 MO11+IA11*MO13+IA3*MO111+IA1*MO113+
     1 MB113*IO1+MB111*IO3+MB13*
     1 IO11+MB11*IO13+MB3*IO111+MB1*IO113+MB0*
     1 IO1113)
      MB1113= JAA*QB1113- JAB*QO1113
      MO1113=-JAB*QB1113+ JBB*QO1113
      MA1113=    (QA1113-IO0*MO1113)/IA0
      QA1333=-(IA1333*MA0+IA133*MA3+IA333*MA1+IA13*
     1 MA33+IA33*MA13+IA3*MA133+IA1*MA333+
     1 MO133*IO3+MO333*IO1+MO13*
     1 IO33+MO33*IO13+MO3*IO133+MO1*IO333+MO0*
     1 IO1333)
      QB1333=-(IB133*MB3+IB333*MB1+IB13*MB33+IB33*
     1 MB13+IB3*MB133+IB1*MB333+
     1 MO133*IO3+MO333*IO1+MO13*IO33+MO33*IO13+
     1 MO3*IO133+MO1*IO333+MO0*IO1333+MB0*IB1333)
      QO1333=-(IA1333*MO0+IA133*MO3+IA333*MO1+IA13*
     1 MO33+IA33*MO13+IA3*MO133+IA1*MO333+
     1 MB133*IO3+MB333*IO1+MB13*
     1 IO33+MB33*IO13+MB3*IO133+MB1*IO333+MB0*
     1 IO1333)
      MB1333= JAA*QB1333- JAB*QO1333
      MO1333=-JAB*QB1333+ JBB*QO1333
      MA1333=    (QA1333-IO0*MO1333)/IA0
      QA1133=-(IA1133*MA0+IA133*MA1+IA113*MA3+IA13*
     1 MA13+IA33*MA11+IA11*MA33+IA3*MA113+IA1*
     1 MA133+MO133*IO1+MO113*
     1 IO3+MO13*IO13+MO33*IO11+MO11*IO33+MO3*IO113+
     1 MO1*IO133+MO0*IO1133)
      QB1133=-(IB133*MB1+IB113*MB3+IB13*MB13+IB33*
     1 MB11+IB11*MB33+IB3*MB113+IB1*MB133+
     1 MO133*IO1+MO113*IO3+MO13*
     1 IO13+MO33*IO11+MO11*IO33+MO3*IO113+MO1*IO133
     1 +MO0*IO1133+MB0*IB1133)
      QO1133=-(IA1133*MO0+IA133*MO1+IA113*MO3+IA13*
     1 MO13+IA33*MO11+IA11*MO33+IA3*MO113+IA1*
     1 MO133+MB133*IO1+MB113*
     1 IO3+MB13*IO13+MB33*IO11+MB11*IO33+MB3*IO113+
     1 MB1*IO133+MB0*IO1133)
      MB1133= JAA*QB1133- JAB*QO1133
      MO1133=-JAB*QB1133+ JBB*QO1133
      MA1133=    (QA1133-IO0*MO1133)/IA0
      MA(1)=MA0
      MA(2)=MA1
      MA(3)=MA3
      MA(4)=MA11
      MA(5)=MA33
      MA(6)=MA13
      MA(7)=MA111
      MA(8)=MA333
      MA(9)=MA113
      MA(10)=MA133
      MA(11)=MA1111
      MA(12)=MA3333
      MA(13)=MA1113
      MA(14)=MA1333
      MA(15)=MA1133
      MB(1)=MB0
      MB(2)=MB1
      MB(3)=MB3
      MB(4)=MB11
      MB(5)=MB33
      MB(6)=MB13
      MB(7)=MB111
      MB(8)=MB333
      MB(9)=MB113
      MB(10)=MB133
      MB(11)=MB1111
      MB(12)=MB3333
      MB(13)=MB1113
      MB(14)=MB1333
      MB(15)=MB1133
      MO(1)=MO0
      MO(2)=MO1
      MO(3)=MO3
      MO(4)=MO11
      MO(5)=MO33
      MO(6)=MO13
      MO(7)=MO111
      MO(8)=MO333
      MO(9)=MO113
      MO(10)=MO133
      MO(11)=MO1111
      MO(12)=MO3333
      MO(13)=MO1113
      MO(14)=MO1333
      MO(15)=MO1133
      RETURN
      END
C
C
      SUBROUTINE MUPV ( MUEX , P1EX , P3EX , MUPEX1 , MUPEX3 )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 23.05.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : CALCULATION OF THE EXPANSION COEFFICIENTS IN THE CORIOLIS
C            : TERMS IN THE RENTEL HAMILTONIAN.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 MUEX(15),P1EX(15),P3EX(15),MUPEX1(15),MUPEX3(15),
     1      MU0,MU1,MU3,MU11,MU33,MU13,
     2      PV11,PV13,PV111,PV133,PV113,PV1111,PV1333,PV1113,PV1133,
     3      PV31,PV33,PV311,PV333,PV313,PV3111,PV3333,PV3113,PV3133,
     4      Q11,Q13,Q111,Q133,Q113,Q1111,Q1333,Q1113,Q1133,
     5      Q31,Q33,Q311,Q333,Q313,Q3111,Q3333,Q3113,Q3133
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      MU0=MUEX(1)
      MU1=MUEX(2)
      MU3=MUEX(3)
      MU11=MUEX(4)
      MU33=MUEX(5)
      MU13=MUEX(6)
      PV11=P1EX(2)
      PV13=P1EX(3)
      PV111=P1EX(4)
      PV133=P1EX(5)
      PV113=P1EX(6)
      PV1111=P1EX(7)
      PV1333=P1EX(8)
      PV1113=P1EX(9)
      PV1133=P1EX(10)
      PV31=P3EX(2)
      PV33=P3EX(3)
      PV311=P3EX(4)
      PV333=P3EX(5)
      PV313=P3EX(6)
      PV3111=P3EX(7)
      PV3333=P3EX(8)
      PV3113=P3EX(9)
      PV3133=P3EX(10)
      Q11=PV11*MU0
      Q13=PV13*MU0
      Q111=PV111*MU0+PV11*MU1
      Q133=PV133*MU0+PV13*MU3
      Q113=PV113*MU0+PV13*MU1+PV11*MU3
      Q1111=PV1111*MU0+PV111*MU1+PV11*MU11
      Q1333=PV1333*MU0+PV133*MU3+PV13*MU33
      Q1113=PV1113*MU0+PV113*MU1+PV111*MU3+PV13*MU11+PV11*MU13
      Q1133=PV1133*MU0+PV113*MU3+PV133*MU1+PV13*MU13+PV11*MU33
      Q31=PV31*MU0
      Q33=PV33*MU0
      Q311=PV311*MU0+PV31*MU1
      Q333=PV333*MU0+PV33*MU3
      Q313=PV313*MU0+PV33*MU1+PV31*MU3
      Q3111=PV3111*MU0+PV311*MU1+PV31*MU11
      Q3333=PV3333*MU0+PV333*MU3+PV33*MU33
      Q3113=PV3113*MU0+PV313*MU1+PV311*MU3+PV33*MU11+PV31*MU13
      Q3133=PV3133*MU0+PV313*MU3+PV333*MU1+PV33*MU13+PV31*MU33
      MUPEX1(1)=0.0E0
      MUPEX1(2)=Q11
      MUPEX1(3)=Q13
      MUPEX1(4)=Q111
      MUPEX1(5)=Q133
      MUPEX1(6)=Q113
      MUPEX1(7)=Q1111
      MUPEX1(8)=Q1333
      MUPEX1(9)=Q1113
      MUPEX1(10)=Q1133
      MUPEX3(1)=0.0E0
      MUPEX3(2)=Q31
      MUPEX3(3)=Q33
      MUPEX3(4)=Q311
      MUPEX3(5)=Q333
      MUPEX3(6)=Q313
      MUPEX3(7)=Q3111
      MUPEX3(8)=Q3333
      MUPEX3(9)=Q3113
      MUPEX3(10)=Q3133
      RETURN
      END
