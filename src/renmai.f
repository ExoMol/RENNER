      PROGRAM RTMAIN
      IMPLICIT REAL*8 (A-H,O-Z)
C*********************************************************************
C
C       PROGRAM FOR CALCULATING THE ROTATION-VIBRATION ENERGIES OF
C       A TRIATOMIC MOLECULE AFTER THE MORBID SCHEME OF PER JENSEN.
C       THIS PROGRAM SUPPOSEDLY CAN LEAST SQUARES FIT PARAMETERS.
C
C*********************************************************************
C*********************************************************************
C
C   THE FOLLOWING PARAMETERS ARE INITIALLY SET:
C
C       LWORK      :  LENGTH OF WORK ARRAY IN UNITS OF REALS
C       NRECUN     :  NUMBER OF UNITS FOR RECORD LENGTH (FOR DIRECT
C                  :  ACCESS FILES) NEEDED TO OBTAIN A RECORD LENGTH
C                  :  OF ONE REAL*8
C       MEPPOW     :  THE SMALLEST NUMBER THAT CAN BE ADDED TO 1.0
C                  :  SO THAT YOUR MACHINE RECOGNIZES THE RESULT
C                  :  AS BEING > 1.0 SHOULD BE 2**(-MEPPOW)
C       LSTPOW     :  THE SMALLEST NUMBER REPRESENTABLE BY YOUR
C                  :  MACHINE SHOULD BE 2**(-LSTPOW)
C
C*********************************************************************
      PARAMETER ( LWORK =  800000000 , NINPRE = 2 , NRECUN = 8 ,
     .            KWORK = NINPRE*LWORK )
      PARAMETER (NMOBS=700,MAXJP1=60,MAXISO=10,NMABI=2000)
      PARAMETER (NEXABM=NMOBS+NMABI)
      PARAMETER ( MEPPOW = 55 , LSTPOW = 78 )
C 
C      bei Aenderung von MAXISO auch intens.h aendern !!
C
C**********************************************************************
C ***********************************************************************
C     ADDED BY IVO FORSUNG CHI MBAPEH     22.05.2014 
C     DECLARING ARRAYS FOR AB-INITIO DATA READING OF
C     BeOH
C
      REAL*8  R1M(NMABI),R3M(NMABI),ALPM(NMABI),
     1        R1P(NMABI),R3P(NMABI),ALPP(NMABI),
     2        WTABI(NMABI),EABI(NMABI),ECLCABI(NMABI),DELABI(NMABI)
      INTEGER ISUP(NMABI),ISUM(NMABI)
C ***********************************************************************
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 , NFIL6 ,
     5       NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT , JVAR(128),
     2       NFIL48 , NFIL49 , NFIL47, NFIL45 , NFIL46
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, TAUP , TAUM ,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM,POTSYM
      LOGICAL SKPSYM ( 2 , 2 , MAXJP1 , MAXISO )
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW,JDIMST(4),ISTART(4),
     1        LINDEX(4),NOLIN(MAXISO)
      INTEGER  ISOT(NMOBS),JU(NMOBS),TAUU(NMOBS),IEOU(NMOBS),
     1                     JL(NMOBS),TAUL(NMOBS),IEOL(NMOBS),
     2                     NUMBU(NMOBS),NUMBL(NMOBS),INDUX(128)
      REAL*8   OBS(NEXABM),WT(NEXABM),CALC(NEXABM),OCLC(NEXABM),
     1         EPSI(NEXABM)
      REAL*8   PARAM(128),PAROLD(128),SD(128),CRR(128),RJTJ(128,128),
     1         RJTE(128),SC(128)
      REAL*8   RJACOB(NEXABM,128),STADEV(MAXISO),RJACIN(NEXABM,128)
      CHARACTER*1 CHDUMM
      CHARACTER*6 PX(128)
      CHARACTER*4 ASYSYM(2),SYMSYM(2,2),LSYM
      REAL*8 RECS
      REAL*8 ENRGMX ( MAXISO )
      REAL*8 WORK(LWORK)
      INTEGER IWRK(KWORK)
C
      INTEGER IBOOK ( MAXJP1 , 2 , 2 , 12 )
C
      COMMON / MACHINE / MEPPO1 , LSTPO1
C
      COMMON /ISOTOP/ IQUANT,AMASS
C
      include 'spnorb.h'
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      include 'rensys.h'
C
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      REAL*8 COENMX(MAXISO)
C
      COMMON /AMPDI/ IDPMA,IDPTR
      INTEGER IDPMA,IDPTR
C
      EQUIVALENCE (WORK(1),IWRK(1))
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      DATA SYMSYM/'A1  ','B1  ','B2  ','A2  '/
      DATA ASYSYM/'A''  ','A"  '/
      MWORK=LWORK
      MEPPO1 = MEPPOW
      LSTPO1 = LSTPOW
      ISOMAX=MAXISO
      MXJVP1=MAXJP1
      HARTRE=2.194746354E+05

C
C*********************************************************************
C
C       PRINT TITLE BANNER
C
C*********************************************************************
C
      CALL HEADER
C
C*********************************************************************
C
C       READ INPUT
C
C*********************************************************************
C
      CALL READIN(POTSYM,ENRGMX,COENMX)
      IF (POTSYM) THEN
                  PARMAX=87
                  CALL DEFSYM(PARAM)
                  CALL NAMESY(PX)
      ELSE
                  PARMAX=128
                  CALL DEFASY(PARAM)
                  CALL NAMEAS(PX)
      ENDIF
C
C*********************************************************************
C
C       OPEN DIRECT ACCESS FILE FOR STORING CALCULATED ENERGIES
C
C*********************************************************************
C
      NREC2=0
      IMULT=NINT(XMULTI)
      DO 7777 I=1,NISOT
      KREC=(IQUANT(1,I)+1)*((IQUANT(2,I)+1)*(IQUANT(4,I)+IQUANT(5,I))
     1                     +(IQUANT(6,I)+1)*(IQUANT(8,I)+IQUANT(9,I)))
      KREC=IMULT*KREC
      IF (KREC .GT. NREC2) NREC2=KREC
7777  CONTINUE
      IWRKST=2*NREC2+1
      OPEN(UNIT=NFIL16,STATUS='SCRATCH',ACCESS='DIRECT',
     1     RECL=NREC2*NRECUN,ERR=1009)
C
C*********************************************************************
C
C     START ITERATION FOR LEAST SQUARES FITTING
C
C*********************************************************************
C
      ITER=0
      DO 9964 ITAU=1,2
      DO 9964 IEO=1,2
      DO 9964 JJ=1,MAXJP1
      DO 9964 I=1,ISOMAX
9964  SKPSYM(ITAU,IEO,JJ,I)=.TRUE.
      I2S=NINT(XMULTI-1.0D+00)
      I=0
2000  I=I+1
2002  READ(NFIL5,*) ISO,JP,IEOP,TAUP,NUMBP,
     1      JM,IEOM,TAUM,NUMBM,FREQ,WGT
      IF (ISO.LE.0) GOTO 2100
      IF (JP .GT. (2*IQUANT(1,ISO)-I2S) .OR. 
     .    JM .GT. (2*IQUANT(1,ISO)-I2S) ) GOTO 2002
      ISOT(I)=ISO
      JU(I)=JP
      IEOU(I)=IEOP
      TAUU(I)=TAUP
      NUMBU(I)=NUMBP
      IDX=JINDEX(JP)
      SKPSYM(TAUP+1,IEOP+1,IDX,ISO)=.FALSE.
      JL(I)=JM
      IEOL(I)=IEOM
      TAUL(I)=TAUM
      NUMBL(I)=NUMBM
      IDX=JINDEX(JM)
      SKPSYM(TAUM+1,IEOM+1,IDX,ISO)=.FALSE.
      OBS(I)=FREQ
      WT(I)=WGT
      GOTO 2000
2100  NOBS=I-1
      NUSED=0
      DO 400 I=1,NOBS
      IF (WT(I).GT.0.0D0) NUSED=NUSED+1
400   CONTINUE
C
CXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
C     ADDED BY IVO FORSUNG CHI MBAPEH    22.05.2014
C     READING IN THE AB-INITIO DATA POINTS
      READ(NFIL5,*) ABIFAC
      NABIUSE = 0
      NUSEDAB=0
c     IF(ISO.EQ.-1) GOTO 9922
      NABIUSE = 0
      I=0
1000  I=I+1
      READ(NFIL5,*,END=120) R1P(I),R3P(I),ALPP(I),ISUP(I),R1M(I),
     1                      R3M(I),ALPM(I),ISUM(I),EABI(I),WTABI(I)
      IF (R1P(I).LT.0.0d+00) GOTO 120
      NABIUSE = NABIUSE + 1
      WT(I+NOBS)=ABIFAC* WTABI(I)
      IF (WT(I+NOBS).GT.0.0D0) NUSEDAB=NUSEDAB+1
      GOTO 1000
120   CONTINUE
c     NABIUSE = NABIUSE - 1
9922  CONTINUE
      NUSEDT=NUSED+NUSEDAB
CXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
      NEXAB= NOBS+NABIUSE
C
      WRITE(NFIL6,*)'EXPP, ABIP, TOTAL INPUT:',NOBS, NABIUSE, NEXAB
C     WRITE(NFIL6,5054)
C5054  FORMAT(3X(A,"-----------------------------------------------"))
C
      IF (NEXAB.EQ.0) GOTO 2125
      IF (NOBS .EQ.0) GOTO 2150
      READ(NFIL5,5100) NUMPAR,MAXIT,NJACOB
      READ(NFIL5,*) SCFAC
      IF (NJACOB .GT. 0) THEN
      READ (NFIL5,5101) MAXLIN,MAXCON
      READ (NFIL5,5102) (JVAR(JJ),JJ=1,128)
C
      DO 6504 JJ=1,MAXLIN
      READ (NFIL18,6506) CHDUMM
6506  FORMAT(A1)
      L=-4
6508  L=L+5
      IF (L .GT. MAXCON) GOTO 6504
      II=L+4
      IF (II .GT. MAXCON) II=MAXCON
      READ (NFIL18,5601) (RJACIN(JJ,IJ),IJ=L,II)
c     WRITE (NFIL6,*) (RJACIN(JJ,IJ),IJ=L,II)
      GOTO 6508
6504  CONTINUE
C
      KK=0
      DO 7000 I=1,NUMPAR
7010  KK=KK+1
      IF (JVAR(KK) .LE. 0) GOTO 7010
      DO 7020 JJ=1,NEXAB
7020  RJACOB(JJ,I)=RJACIN(JJ,KK)
7000  CONTINUE
      WRITE (NFIL6,5501)
C
C
      DO 7470 I=1,NEXAB
      WRITE(NFIL6,2450)
      L=-4
7460  L=L+5
      IF (L.GT.NUMPAR) GOTO 7470
      II=L+4
      IF (II.GT.NUMPAR) II=NUMPAR
      WRITE(NFIL6,5600) (RJACOB(I,IJ), IJ=L,II)
      GOTO 7460
7470  CONTINUE
C
      ENDIF
C
      WRITE(NFIL6,6400)
      DO 6450 I=1,PARMAX
      IF (IVAR(I).GT.0) WRITE(NFIL6,6500) I,PX(I)
6450  CONTINUE
6400  FORMAT('0',5X,12('*'),' PARAMETERS TO BE VARIED IN',
     1     ' LSQ FIT ',12('*')//)
6500  FORMAT(' ',17X,I3,'.',4X,A6)
      GOTO 2150
C
C*********************************************************************
C
C      NEXAB=0 -> STRAIGHT THROUGH CALCULATION
C
C*********************************************************************
C
2125  IPRINT=1
C
      DO 9963 I=1,NISOT
      REWIND NFIL1
      REWIND NFIL2
      REWIND NFIL3
      REWIND NFIL4
      REWIND NFIL8
      REWIND NFIL9
      REWIND NFIL10
      REWIND NFIL11
      REWIND NFIL12
      REWIND NFIL13
      REWIND NFIL14
      REWIND NFIL15
      REWIND NFIL29
      REWIND NFIL27
      REWIND NFIL30
      REWIND NFIL33
      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL48
      REWIND NFIL49
      M1=AMASS(1,I)
      M2=AMASS(2,I)
      M3=AMASS(3,I)
      M=M1+M2+M3
      SYMM=(POTSYM .AND. ABS(M1-M3) .LT. 1.0E-30)
      JMAX=IQUANT(1,I)
      JMAXP1=JMAX+1
      IF (POTSYM) THEN
            CALL CRESYM(PARAM)
      ELSE
            CALL CREASY(PARAM)
      ENDIF
      DO 9961 ITAU=1,2
      DO 9961 IEO=1,2
      DO 9961 JJ=1,JMAXP1
9961  SKPSYM(ITAU,IEO,JJ,I)=.FALSE.
C
C*********************************************************************
C
C       SET UP PARAMETERS FOR DIFFERENT POTENTIAL EXPANSION
C
C*********************************************************************
C
      CALL ECALC ( MWORK ,  NINPRE , NRECUN, WORK(1), IWRK(1),
     1             IWRKST , NREC2 ,
     1             SKPSYM , MXJVP1 , I , IBOOK , ENRGMX, COENMX )
9963  CONTINUE
      CALL PRTITO
      STOP
C
C
C***** NORMALIZATION OF WEIGHTS
C
C
2150  WTSUM=0.0D0
      DO 2200 I=1,NEXAB
2200  WTSUM=WTSUM+WT(I)
      WTSUM=WTSUM/NEXAB
      DO 2300 I=1,NEXAB
2300  WT(I)=WT(I)/WTSUM
C
      N=0
      DO 2310 I=1,PARMAX
      IF (IVAR(I).GT.0) IVAR(I)=1
      IF (IVAR(I).NE.1) IVAR(I)=0
      N=N+IVAR(I)
      IF (IVAR(I).EQ.1) INDUX(N)=I
2310  CONTINUE
      IF (N.EQ.NUMPAR) GOTO 2320
      WRITE(NFIL6,2315) N,NUMPAR
2315  FORMAT ('0>>>> NUMPAR CALCULATED FROM IVAR, ',I2,
     1      ' DOES NOT EQUAL VALUE ENTERED, ',I2/
     2      ' >>>> PROGRAM TERMINATES')
      STOP
2320  CONTINUE
2330  SSQ=0.0D0
      IF (NOBS .GT.0) THEN
      DO 2360 ISO=1,ISOMAX
      IYN=0
      DO 2340 I=1,NOBS
      IF (ISOT(I).EQ.ISO) IYN=1
2340  CONTINUE
      STADEV(ISO)=0.0E0
      NOLIN(ISO)=0.0E0
      IF (IYN.EQ.0) GOTO 2360
      IPRINT=0
      I=ISO
      REWIND NFIL1
      REWIND NFIL2
      REWIND NFIL3
      REWIND NFIL4
      REWIND NFIL8
      REWIND NFIL9
      REWIND NFIL10
      REWIND NFIL11
      REWIND NFIL12
      REWIND NFIL13
      REWIND NFIL14
      REWIND NFIL15
      REWIND NFIL27
      REWIND NFIL29
      REWIND NFIL30
      REWIND NFIL33
      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL48
      REWIND NFIL49
      M1=AMASS(1,I)
      M2=AMASS(2,I)
      M3=AMASS(3,I)
      M=M1+M2+M3
      SYMM=(POTSYM .AND. ABS(M1-M3) .LT. 1.0E-30)
      MAXPSY=1
      IF (SYMM) MAXPSY=2
      JMAX=IQUANT(1,I)
      JMAXP1=JMAX+1
      IF (POTSYM) THEN
            CALL CRESYM(PARAM)
      ELSE
            CALL CREASY(PARAM)
      ENDIF
      CALL ECALC ( MWORK ,  NINPRE , NRECUN, WORK(1), IWRK(1),
     1             IWRKST , NREC2 ,
     1             SKPSYM , MXJVP1 , I , IBOOK , ENRGMX ,COENMX)
      DO 2350 I=1,NOBS
      IF (ISOT(I).NE.ISO) GOTO 2350
      ITAUP1=TAUU(I)+1
      IEOUP1=IEOU(I)+1
      IREC11=LSQREC(JU(I),ITAUP1,IEOUP1,MAXPSY)
      READ(NFIL16,REC=IREC11) (WORK(L), L=1,NREC2)
      ITAUP1=TAUL(I)+1
      IEOLP1=IEOL(I)+1
      IREC22=LSQREC(JL(I),ITAUP1,IEOLP1,MAXPSY)
      READ(NFIL16,REC=IREC22) (WORK(NREC2+L), L=1,NREC2)
      KRP=NUMBU(I)
      KRM=NUMBL(I)
      OCLC(I)=WORK(KRP) - WORK(NREC2+KRM)
      EPSI(I) = OBS(I) - OCLC(I)
      SSQ = SSQ + EPSI(I)**2*WT(I)
      IF (WT(I) .GT. 0.0D+00) THEN
         STADEV(ISO)=STADEV(ISO)+EPSI(I)**2
         NOLIN(ISO)=NOLIN(ISO)+1 
      ENDIF
2350  CONTINUE
      NXLIN=1
      IF (NOLIN(ISO) .GT. 1) NXLIN=NOLIN(ISO)
      STADEV(ISO)=SQRT(STADEV(ISO)/DFLOAT(NXLIN))
2360  CONTINUE
      ENDIF
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C     ADDED BY IVO FORSUNG CHI MBAPEH     16.06.2014
      STADEVABI = 0
      SSQQ = 0
      IF (NABIUSE.EQ.0) GOTO 9935
C
      DO 2361 I = 1, NABIUSE
C
      ECLCABI(I) =  POTVAL(R1P(I),R3P(I),ALPP(I),ISUP(I))
     1            - POTVAL(R1M(I),R3M(I),ALPM(I),ISUM(I))
C
      EPSI(I+NOBS) = HARTRE*EABI(I) - ECLCABI(I)
      SSQQ = SSQQ + EPSI(I+NOBS)**2*WT(I+NOBS)
      STADEVABI=STADEVABI+EPSI(I+NOBS)**2
2361  CONTINUE
      STADEVABI= DSQRT(STADEVABI/NABIUSE)
      SSQ = SSQ + SSQQ
9935  continue
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      STDEV=DSQRT(SSQ/(NUSEDT-NUMPAR))
      IF (ITER .EQ. 0 .OR. ITER .EQ. MAXIT) WRITE(NFIL6,5300)
      DO 2365 I=1,NOBS
      ISO=ISOT(I)
      IEOP=IEOU(I)+1
      KSYMP=TAUU(I)+1
      M1=AMASS(1,ISO)
      M3=AMASS(3,ISO)
      IF (POTSYM .AND. ABS(M1-M3) .LT. 1.0E-30) THEN
             LSYM=SYMSYM(KSYMP,IEOP)
      ELSE
             LSYM=ASYSYM(KSYMP)
      ENDIF
      IF (MOD(JU(I),2) .EQ. 0) THEN
           JACTV=JU(I)/2
           WRITE(NFIL6,5400) ISO,JACTV,LSYM,NUMBU(I)
      ELSE
           WRITE(NFIL6,5401) ISO,JU(I),LSYM,NUMBU(I)
      ENDIF
      IEOM=IEOL(I)+1
      KSYMM=TAUL(I)+1
      IF (POTSYM .AND. ABS(M1-M3) .LT. 1.0E-30) THEN
             LSYM=SYMSYM(KSYMM,IEOM)
      ELSE
             LSYM=ASYSYM(KSYMM)
      ENDIF
      IF (MOD(JL(I),2) .EQ. 0) THEN
           JACTV=JL(I)/2
           WRITE(NFIL6,5450) JACTV,LSYM,NUMBL(I),
     1              OBS(I),OCLC(I),EPSI(I),WT(I)
      ELSE
           WRITE(NFIL6,5451) JL(I),LSYM,NUMBL(I),
     1              OBS(I),OCLC(I),EPSI(I),WT(I)
      ENDIF
2365  CONTINUE
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C     ADDED BY IVO FORSUNG CHI MABPEH    22.05.2014
C     CALCULATING THE POTENTIAL ENERGY FUNCTION VALUES DIFFERENCES
C     AT EACH POINTS
      IF (NABIUSE.EQ.0) GOTO 9934
      WRITE(NFIL6,5053)
      WRITE(NFIL6,5051)
      WRITE(NFIL6,5052)
      DO I = 1, NABIUSE
      ECLCABI(I) =  POTVAL(R1P(I),R3P(I),ALPP(I),ISUP(I))
     1            - POTVAL(R1M(I),R3M(I),ALPM(I),ISUM(I))
      EABIO   = HARTRE*EABI(I)
      DELABI(I) = EABIO - ECLCABI(I)
      WRITE(NFIL6,5050) R1P(I),R3P(I),ALPP(I),ISUP(I),R1M(I),R3M(I),
     1 ALPM(I),ISUM(I),EABIO,ECLCABI(I),DELABI(I),WT(I+NOBS)
      ENDDO
9934   continue
5053  FORMAT(3X(A,"-----------------------------------------------"))    
5051  FORMAT(6X,'R1P',9X,'R3P',9X,'ALPP',6X,'ISUP',8X,'R1M',9X,'R3M',9X,
     1 'ALPM',6X,'ISUM',5X,'EABIO',6X,'ECLCABI',8X,'DELABI',8X,'WTABI')
5052  FORMAT(3X(A,"-----------------------------------------------"))
5050  FORMAT(F10.4,2X,F10.4,2X,F10.2,2X,I2,2X,F10.4,2X,F10.4,2X,
     1 F10.2,2X,I2,2X,F12.4,2X,F12.4,2X,F10.4,2X,F12.5)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      WRITE(NFIL6,5550) ITER,NUSEDT,STDEV
      WRITE(NFIL6,7299)
      DO 2366 I=1,NISOT
2366  WRITE(NFIL6,7300) I,NOLIN(I),STADEV(I)
      WRITE(NFIL6,7301) NABIUSE, STADEVABI
7301  FORMAT(' ',17X,'FOR  ',I4,' AB INITIO DATA POINTS,',
     1              ' THE RMS DEVIATION IS:        ',E10.5/)
C
      IF (ITER.EQ.MAXIT) THEN
         CALL WRTPRM(NFIL50,POTSYM,IVAR,PX)
         GOTO 2610
      ENDIF
      IF (ITER.GT.0) GOTO 2540
C
      IF (NJACOB .LE. 0) THEN
C
      DO 2400 IPRM=1,NUMPAR
      L=INDUX(IPRM)
      OLDP=PARAM(L)
      PARAM(L)=OLDP*1.002E0
      IF (OLDP.EQ.0) THEN
         IF (PX(L)(1:1) .EQ. 'G' .OR. PX(L)(1:1) .EQ. 'H')
     1                    PARAM(L)=1.0D+02
         IF (PX(L)(1:2) .EQ. 'XL') PARAM(L)=1.0D-02
         IF (PX(L)(1:2) .EQ. 'AS') PARAM(L)=1.0D-02
         IF (PX(L)(1:3) .EQ. 'AS0') PARAM(L)=1.0D-01
      ENDIF
      DO 2390 ISO=1,ISOMAX
      IYN=0
      DO 2370 I=1,NOBS
      IF (ISOT(I).EQ.ISO) IYN=1
2370  CONTINUE
      IF (IYN.EQ.0) GOTO 2390
      I=ISO
      IPRINT=0
      REWIND NFIL1
      REWIND NFIL2
      REWIND NFIL3
      REWIND NFIL4
      REWIND NFIL8
      REWIND NFIL9
      REWIND NFIL10
      REWIND NFIL11
      REWIND NFIL12
      REWIND NFIL13
      REWIND NFIL14
      REWIND NFIL15
      REWIND NFIL27
      REWIND NFIL29
      REWIND NFIL30
      REWIND NFIL33
      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL48
      REWIND NFIL49
      M1=AMASS(1,I)
      M2=AMASS(2,I)
      M3=AMASS(3,I)
      M=M1+M2+M3
      SYMM=(POTSYM .AND. ABS(M1-M3) .LT. 1.0E-30)
      MAXPSY=1
      IF (SYMM) MAXPSY=2
      JMAX=IQUANT(1,I)
      JMAXP1=JMAX+1
      IF (POTSYM) THEN
            CALL CRESYM(PARAM)
      ELSE
            CALL CREASY(PARAM)
      ENDIF
      CALL ECALC ( MWORK ,  NINPRE , NRECUN, WORK(1), IWRK(1),
     1             IWRKST , NREC2 ,
     1             SKPSYM , MXJVP1 , I , IBOOK , ENRGMX,COENMX )
      DO 2380 I=1,NOBS
      IF (ISOT(I).NE.ISO) GOTO 2380
      ITAUP1=TAUU(I)+1
      IEOUP1=IEOU(I)+1
      IREC11=LSQREC(JU(I),ITAUP1,IEOUP1,MAXPSY)
      READ(NFIL16,REC=IREC11) (WORK(LQ), LQ=1,NREC2)
      ITAUP1=TAUL(I)+1
      IEOLP1=IEOL(I)+1
      IREC22=LSQREC(JL(I),ITAUP1,IEOLP1,MAXPSY)
      READ(NFIL16,REC=IREC22) (WORK(NREC2+LQ), LQ=1,NREC2)
      KRP=NUMBU(I)
      KRM=NUMBL(I)
      CALC(I)=WORK(KRP) - WORK(NREC2+KRM)
      RJACOB(I,IPRM)=(CALC(I)-OCLC(I))/(PARAM(L)-OLDP)
2380  CONTINUE
2390  CONTINUE
C
      IXABI=0
      DO 2382 I=NOBS+1,NEXAB
      IXABI= IXABI+1
C
      XVALU = POTVAL(R1P(IXABI),R3P(IXABI),ALPP(IXABI),ISUP(IXABI))
     1      - POTVAL(R1M(IXABI),R3M(IXABI),ALPM(IXABI),ISUM(IXABI))
C
      RJACOB(I,IPRM)=(XVALU-ECLCABI(IXABI))/(PARAM(L)-OLDP)
2382  CONTINUE
C
      PARAM(L)=OLDP
      CALL PRJACO ( IPRM , PX(L) )
2400  CONTINUE
      WRITE(NFIL6,5500)
C
      DO 2470 I=1,NEXAB
      WRITE(NFIL6,2450)
2450  FORMAT(' ')
      L=-4
2460  L=L+5
      IF (L.GT.NUMPAR) GOTO 2470
      II=L+4
      IF (II.GT.NUMPAR) II=NUMPAR
      WRITE(NFIL6,5600) (RJACOB(I,IJ), IJ=L,II)
      GOTO 2460
2470  CONTINUE
C
      ENDIF
C
C
C
C***** FORM THE PRODUCT (J TRANSPOSE) J
C
C
      DO 2490 I=1,NUMPAR
      DO 2490 J=I,NUMPAR
      T=0.0D0
      DO 2480 K=1,NEXAB
2480  T=T+RJACOB(K,I)*RJACOB(K,J)*WT(K)
      RJTJ(I,J)=T
2490  RJTJ(J,I)=T
      DO 500 I=1,NUMPAR
500   SC(I)=SQRT(RJTJ(I,I))
      DO 510 I=1,NUMPAR
      DO 510 J=1,NUMPAR
510   RJTJ(I,J)=RJTJ(I,J)/(SC(I)*SC(J))
C
C
C***** INVERT THE MATRIX (J TRANSPOSE) J; PLACE IN RJTJ
C
C
      CALL SOLVEX(RJTJ,PARMAX,NUMPAR,NUMPAR,PREC,DET,TEST)
      IF (TEST.EQ.0.0D0) GOTO 2510
      WRITE(NFIL6,2500) TEST
2500  FORMAT('0>>>> SOLVEX FAILED, TEST = ',D11.5)
      STOP
2510  NPM1=NUMPAR-1
      DO 520 I=1,NUMPAR
      DO 520 J=1,NUMPAR
520   RJTJ(I,J)=RJTJ(I,J)/(SC(I)*SC(J))
      IF (NPM1.EQ.0) GOTO 2540
      WRITE(NFIL6,5700)
      DO 2530 I=1,NPM1
      IP1=I+1
      DO 2520 J=IP1,NUMPAR
      X=RJTJ(I,J)/SQRT(RJTJ(I,I)*RJTJ(J,J))
2520  WRITE(NFIL6,5800) I,J,X
2530  CONTINUE
2540  CONTINUE
      DO 2560 I=1,NUMPAR
      T=0.0D0
      DO 2550 K=1,NEXAB
2550  T=T+RJACOB(K,I)*EPSI(K)*WT(K)
2560  RJTE(I)=T
      DO 2570 L=1,NUMPAR
      I=INDUX(L)
2570  PAROLD(I)=PARAM(I)
C
      DO 2590 I=1,NUMPAR
      T=0.0D0
      L=INDUX(I)
      SD(L)=SQRT(RJTJ(I,I))*STDEV
      CRR(L)=(SD(L)*SC(I)/STDEV)**2
      DO 2580 K=1,NUMPAR
2580  T=T+RJTJ(I,K)*RJTE(K)
2590  PARAM(L)=PARAM(L)+SCFAC*T
C
      WRITE(NFIL6,5900)
      DO 2600 L=1,NUMPAR
      I=INDUX(L)
      EPSIL=PARAM(I)-PAROLD(I)
2600  WRITE(NFIL6,5905) L,PX(I),PAROLD(I),PARAM(I),EPSIL,
     1      SD(I),CRR(I)
      ITER=ITER+1
      GOTO 2330
2610  CONTINUE
      CALL PRTITO
      STOP
1009  WRITE (NFIL6,1070)
1070  FORMAT(' MORBID.LSQ.ERR  SCRATCH FILE COULD NOT OPEN'//)
      STOP
C
C
C  THIS IS THE END OF THE MORBID PROGRAM.
C
5100  FORMAT(3I3)
5101  FORMAT(2I4)
5102  FORMAT(128I1)
5300  FORMAT('1',16X,'ISOT.',3X,'J',2X,'SYM.',2X,'IDENT.',
     1      4X,'NUOBS',10X,'NUCALC',8X,'OBS-CALC',
     1      9X,'WEIGHT'/)
5400  FORMAT('0 UPPER STATE: ',3X,I2,4X,I2,2X,A4,1X,I4)
5401  FORMAT('0 UPPER STATE: ',3X,I2,4X,I2,'/2',2X,A4,1X,I4)
5450  FORMAT('  LOWER STATE: ',9X,I2,2X,A4,1X,I4,4F15.5)
5451  FORMAT('  LOWER STATE: ',9X,I2,'/2',2X,A4,1X,I4,4F15.5)
5500  FORMAT('0 THE JACOBIAN MATRIX: ')
5501  FORMAT('0 JACOBIAN MATRIX READ FROM DATA SET: ')
5550  FORMAT(///'   FOR ITERATION ',I2,' OVER ALL ',I5,
     1      ' DATA POINTS USED, THE WEIGHTED STANDARD DEVIATION IS ',
     2      E10.5)
5600  FORMAT(' ',5E20.10)
5601  FORMAT(1X,5E20.10)
5700  FORMAT('0 THE CORRELATION COEFFICIENTS: ')
5800  FORMAT('0',10X,'CORR(',I2,',',I2,') = ',F10.7)
5900  FORMAT(///33X,78('-')/33X,':      OLD PARM    :',
     1      '      NEW PARM    : DELTA PARM :  STD. ERR. :',
     1      '  (CORR-1)  :'/33X,78('-'))
5905  FORMAT('0',18X,I3,'. ',A8,1X,2(':',E16.8,2X),':',
     1      3(E12.5,':'))
7299  FORMAT('0',5X,12('*'),' RMS DEVIATIONS ',12('*')//)
7300  FORMAT(' ',17X,'FOR ISOTOPE [ ',I2,', THERE ARE ',I3,
     2              ' LINES WITH AN RMS DEVIATION OF ',E10.5/)
      END
C
C
      BLOCK DATA INIVAL
      IMPLICIT REAL*8 (A-H,O-Z)
      LOGICAL SYMM
      REAL*8 M1,M2,M3,M
C
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      include 'rensys.h'
C
      DATA SYMM/.FALSE./
      DATA VELLGT/2.99792458E+10/,PLANCK/6.6260755E-27/,
     1    AVOGNO/6.0221367E+23/, PI/3.14159265359E+00/,
     1    BOLTZ/1.380658E-16/,
     2    PREC/0.5E-30/
      DATA NFIL1/1/,NFIL2/2/,NFIL3/3/,NFIL4/4/,NFIL5/5/,
     1    NFIL6/6/,NFIL7/7/,NFIL8/8/,NFIL9/9/,NFIL10/10/,
     2    NFIL11/11/,NFIL12/12/,NFIL13/13/,NFIL14/14/,NFIL15/15/,
     3    NFIL16/16/,NFIL17/17/,NFIL18/18/,NFIL19/19/,NFIL20/20/,
     2    NFIL21/21/,NFIL22/22/,NFIL23/23/,NFIL24/24/,NFIL25/25/,
     3    NFIL26/26/,NFIL27/27/,NFIL28/28/,NFIL29/29/,NFIL30/30/,
     2    NFIL31/31/,NFIL32/32/,NFIL33/33/,NFIL34/34/,NFIL35/35/,
     3    NFIL36/36/,NFIL37/37/,NFIL38/38/,NFIL39/39/,NFIL40/40/,
     2    NFIL41/41/,NFIL42/42/,NFIL43/43/,NFIL44/44/,NFIL45/45/,
     3    NFIL46/46/,NFIL47/47/,NFIL48/48/,NFIL49/49/,NFIL50/50/,
     3    NFIL51/51/,NFIL52/52/,NFIL53/53/,NFIL54/54/,NFIL55/55/,
     3    NFIL56/56/,NFIL57/57/,NFIL58/58/,NFIL59/59/,NFIL60/60/
      DATA ITEST/0/
      END
C
C
      SUBROUTINE CREASY(PARAM)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128),M1,M2,M3,M
      LOGICAL SYMM
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON/SPNORB/XMULTI,AS0,AS1,AS2,AS3,AS4,
     1              AS01,AS11,AS21,AS31,
     1              AS03,AS13,AS23,AS33,
     1              AS011,AS111,AS211,AS033,AS133,AS233,
     1              AS013,AS113,AS213
C
      COMMON / LZCOMP / XLAMB , XLZ11 ,XLZ12 , XLZ13 , XLZ14,
     1                  XLZ21 , XLZ22 , XLZ23 , XLZ24,
     1                  XLZI1 , XLZI2 , XLZI3 , XLZI4
C
      INDEX=1
      CALL CRTWO ( INDEX, PARAM , RE12 , RE32   )
      CALL CRTWO ( INDEX, PARAM , AA1 , AA3     )
      CALL CRTWO ( INDEX, PARAM , G1    , G3    )
      CALL CRTWO ( INDEX, PARAM , G11   , G33   )
      CALL CRONE ( INDEX, PARAM , G13           )
      CALL CRTWO ( INDEX, PARAM , G111  , G333  )
      CALL CRTWO ( INDEX, PARAM , G113  , G133  )
      CALL CRTWO ( INDEX, PARAM , G1111 , G3333 )
      CALL CRTWO ( INDEX, PARAM , G1113 , G1333 )
      CALL CRONE ( INDEX, PARAM , G1133         )
C
      CALL CRONE ( INDEX, PARAM , GA1 )
      CALL CRONE ( INDEX, PARAM , GA2 )
      CALL CRONE ( INDEX, PARAM , GA3 )
      CALL CRONE ( INDEX, PARAM , GA4 )
      CALL CRONE ( INDEX, PARAM , GA5 )
      CALL CRONE ( INDEX, PARAM , GA6 )
      CALL CRONE ( INDEX, PARAM , GA7 )
      CALL CRONE ( INDEX, PARAM , GA8 )
C
      CALL CRTWO ( INDEX, PARAM , G1A1    , G1A3     )
      CALL CRTWO ( INDEX, PARAM , G2A1    , G2A3     )
      CALL CRTWO ( INDEX, PARAM , G3A1    , G3A3     )
      CALL CRTWO ( INDEX, PARAM , G4A1    , G4A3     )
      CALL CRTWO ( INDEX, PARAM , G1A11   , G1A33    )
      CALL CRTWO ( INDEX, PARAM , G2A11   , G2A33    )
      CALL CRTWO ( INDEX, PARAM , G3A11   , G3A33    )
      CALL CRONE ( INDEX, PARAM , G1A13   )
      CALL CRONE ( INDEX, PARAM , G2A13   )
      CALL CRONE ( INDEX, PARAM , G3A13   )
      CALL CRTWO ( INDEX, PARAM , G1A111  , G1A333   )
      CALL CRTWO ( INDEX, PARAM , G2A111  , G2A333   )
      CALL CRTWO ( INDEX, PARAM , G1A113  , G1A133   )
      CALL CRTWO ( INDEX, PARAM , G2A113  , G2A133   )
      CALL CRTWO ( INDEX, PARAM , GA1111  , GA3333   )
      CALL CRTWO ( INDEX, PARAM , GA1113  , GA1333   )
      CALL CRONE ( INDEX, PARAM , GA1133  )
C
      CALL CRONE ( INDEX, PARAM , HA1 )
      CALL CRONE ( INDEX, PARAM , HA2 )
      CALL CRONE ( INDEX, PARAM , HA3 )
      CALL CRONE ( INDEX, PARAM , HA4 )
      CALL CRONE ( INDEX, PARAM , HA5 )
      CALL CRONE ( INDEX, PARAM , HA6 )
      CALL CRONE ( INDEX, PARAM , HA7 )
      CALL CRONE ( INDEX, PARAM , HA8 )
C
      CALL CRTWO ( INDEX, PARAM , H1A1    , H1A3     )
      CALL CRTWO ( INDEX, PARAM , H2A1    , H2A3     )
      CALL CRTWO ( INDEX, PARAM , H3A1    , H3A3     )
      CALL CRTWO ( INDEX, PARAM , H4A1    , H4A3     )
      CALL CRTWO ( INDEX, PARAM , H1A11   , H1A33    )
      CALL CRTWO ( INDEX, PARAM , H2A11   , H2A33    )
      CALL CRTWO ( INDEX, PARAM , H3A11   , H3A33    )
      CALL CRONE ( INDEX, PARAM , H1A13   )
      CALL CRONE ( INDEX, PARAM , H2A13   )
      CALL CRONE ( INDEX, PARAM , H3A13   )
      CALL CRTWO ( INDEX, PARAM , H1A111  , H1A333   )
      CALL CRTWO ( INDEX, PARAM , H2A111  , H2A333   )
      CALL CRTWO ( INDEX, PARAM , H1A113  , H1A133   )
      CALL CRTWO ( INDEX, PARAM , H2A113  , H2A133   )
      CALL CRTWO ( INDEX, PARAM , HA1111  , HA3333   )
      CALL CRTWO ( INDEX, PARAM , HA1113  , HA1333   )
      CALL CRONE ( INDEX, PARAM , HA1133  )
C
      CALL CRONE ( INDEX, PARAM , XLZ11 )
      CALL CRONE ( INDEX, PARAM , XLZ12 )
      CALL CRONE ( INDEX, PARAM , XLZ13 )
      CALL CRONE ( INDEX, PARAM , XLZ14 )
      CALL CRONE ( INDEX, PARAM , XLZ21 )
      CALL CRONE ( INDEX, PARAM , XLZ22 )
      CALL CRONE ( INDEX, PARAM , XLZ23 )
      CALL CRONE ( INDEX, PARAM , XLZ24 )
      CALL CRONE ( INDEX, PARAM , XLZI1 )
      CALL CRONE ( INDEX, PARAM , XLZI2 )
      CALL CRONE ( INDEX, PARAM , XLZI3 )
      CALL CRONE ( INDEX, PARAM , XLZI4 )
      CALL CRONE ( INDEX, PARAM , AS0 )
      CALL CRONE ( INDEX, PARAM , AS1 )
      CALL CRONE ( INDEX, PARAM , AS2 )
      CALL CRONE ( INDEX, PARAM , AS3 )
      CALL CRONE ( INDEX, PARAM , AS4 )
      CALL CRTWO ( INDEX, PARAM , AS01    , AS03     )
      CALL CRTWO ( INDEX, PARAM , AS11    , AS13     )
      CALL CRTWO ( INDEX, PARAM , AS21    , AS23     )
      CALL CRTWO ( INDEX, PARAM , AS31    , AS33     )
      CALL CRTWO ( INDEX, PARAM , AS011   , AS033    )
      CALL CRTWO ( INDEX, PARAM , AS111   , AS133    )
      CALL CRTWO ( INDEX, PARAM , AS211   , AS233    )
      CALL CRONE ( INDEX, PARAM , AS013 )
      CALL CRONE ( INDEX, PARAM , AS113 )
      CALL CRONE ( INDEX, PARAM , AS213 )
C
      RETURN
      END
C
C
      SUBROUTINE CRESYM(PARAM)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 PARAM(128),M1,M2,M3,M
      LOGICAL SYMM
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON/SPNORB/XMULTI,AS0,AS1,AS2,AS3,AS4,
     1              AS01,AS11,AS21,AS31,
     1              AS03,AS13,AS23,AS33,
     1              AS011,AS111,AS211,AS033,AS133,AS233,
     1              AS013,AS113,AS213
C
      COMMON / LZCOMP / XLAMB , XLZ11 ,XLZ12 , XLZ13 , XLZ14,
     1                  XLZ21 , XLZ22 , XLZ23 , XLZ24,
     1                  XLZI1 , XLZI2 , XLZI3 , XLZI4
C
      INDEX=1
      CALL CRONE ( INDEX, PARAM , RE12 )
      RE32=RE12
      CALL CRONE ( INDEX, PARAM , AA1 )
      AA3=AA1
      CALL CRONE ( INDEX, PARAM , G1 )
      G3=G1
      CALL CRONE ( INDEX, PARAM , G11 )
      G33=G11
      CALL CRONE ( INDEX, PARAM , G13 )
      CALL CRONE ( INDEX, PARAM , G111 )
      G333=G111
      CALL CRONE ( INDEX, PARAM , G113 )
      G133=G113
      CALL CRONE ( INDEX, PARAM , G1111 )
      G3333=G1111
      CALL CRONE ( INDEX, PARAM , G1113 )
      G1333=G1113
      CALL CRONE ( INDEX, PARAM , G1133 )
C
      CALL CRONE ( INDEX, PARAM , GA1 )
      CALL CRONE ( INDEX, PARAM , GA2 )
      CALL CRONE ( INDEX, PARAM , GA3 )
      CALL CRONE ( INDEX, PARAM , GA4 )
      CALL CRONE ( INDEX, PARAM , GA5 )
      CALL CRONE ( INDEX, PARAM , GA6 )
      CALL CRONE ( INDEX, PARAM , GA7 )
      CALL CRONE ( INDEX, PARAM , GA8 )
C
      CALL CRONE ( INDEX, PARAM , G1A1 )
      G1A3=G1A1
      CALL CRONE ( INDEX, PARAM , G2A1 )
      G2A3=G2A1
      CALL CRONE ( INDEX, PARAM , G3A1 )
      G3A3=G3A1
      CALL CRONE ( INDEX, PARAM , G4A1 )
      G4A3=G4A1
      CALL CRONE ( INDEX, PARAM , G1A11 )
      G1A33=G1A11
      CALL CRONE ( INDEX, PARAM , G2A11 )
      G2A33=G2A11
      CALL CRONE ( INDEX, PARAM , G3A11 )
      G3A33=G3A11
      CALL CRONE ( INDEX, PARAM , G1A13 )
      CALL CRONE ( INDEX, PARAM , G2A13 )
      CALL CRONE ( INDEX, PARAM , G3A13 )
      CALL CRONE ( INDEX, PARAM , G1A111 )
      G1A333=G1A111
      CALL CRONE ( INDEX, PARAM , G2A111 )
      G2A333=G2A111
      CALL CRONE ( INDEX, PARAM , G1A113 )
      G1A133=G1A113
      CALL CRONE ( INDEX, PARAM , G2A113 )
      G2A133=G2A113
      CALL CRONE ( INDEX, PARAM , GA1111 )
      GA3333=GA1111
      CALL CRONE ( INDEX, PARAM , GA1113 )
      GA1333=GA1113
      CALL CRONE ( INDEX, PARAM , GA1133 )
      CALL CRONE ( INDEX, PARAM , HA1 )
      CALL CRONE ( INDEX, PARAM , HA2 )
      CALL CRONE ( INDEX, PARAM , HA3 )
      CALL CRONE ( INDEX, PARAM , HA4 )
      CALL CRONE ( INDEX, PARAM , HA5 )
      CALL CRONE ( INDEX, PARAM , HA6 )
      CALL CRONE ( INDEX, PARAM , HA7 )
      CALL CRONE ( INDEX, PARAM , HA8 )
C
      CALL CRONE ( INDEX, PARAM , H1A1 )
      H1A3=H1A1
      CALL CRONE ( INDEX, PARAM , H2A1 )
      H2A3=H2A1
      CALL CRONE ( INDEX, PARAM , H3A1 )
      H3A3=H3A1
      CALL CRONE ( INDEX, PARAM , H4A1 )
      H4A3=H4A1
      CALL CRONE ( INDEX, PARAM , H1A11 )
      H1A33=H1A11
      CALL CRONE ( INDEX, PARAM , H2A11 )
      H2A33=H2A11
      CALL CRONE ( INDEX, PARAM , H3A11 )
      H3A33=H3A11
      CALL CRONE ( INDEX, PARAM , H1A13 )
      CALL CRONE ( INDEX, PARAM , H2A13 )
      CALL CRONE ( INDEX, PARAM , H3A13 )
      CALL CRONE ( INDEX, PARAM , H1A111 )
      H1A333=H1A111
      CALL CRONE ( INDEX, PARAM , H2A111 )
      H2A333=H2A111
      CALL CRONE ( INDEX, PARAM , H1A113 )
      H1A133=H1A113
      CALL CRONE ( INDEX, PARAM , H2A113 )
      H2A133=H2A113
      CALL CRONE ( INDEX, PARAM , HA1111 )
      HA3333=HA1111
      CALL CRONE ( INDEX, PARAM , HA1113 )
      HA1333=HA1113
      CALL CRONE ( INDEX, PARAM , HA1133 )
      CALL CRONE ( INDEX, PARAM , XLZ11 )
      CALL CRONE ( INDEX, PARAM , XLZ12 )
      CALL CRONE ( INDEX, PARAM , XLZ13 )
      CALL CRONE ( INDEX, PARAM , XLZ14 )
      CALL CRONE ( INDEX, PARAM , XLZ21 )
      CALL CRONE ( INDEX, PARAM , XLZ22 )
      CALL CRONE ( INDEX, PARAM , XLZ23 )
      CALL CRONE ( INDEX, PARAM , XLZ24 )
      CALL CRONE ( INDEX, PARAM , XLZI1 )
      CALL CRONE ( INDEX, PARAM , XLZI2 )
      CALL CRONE ( INDEX, PARAM , XLZI3 )
      CALL CRONE ( INDEX, PARAM , XLZI4 )
      CALL CRONE ( INDEX, PARAM , AS0 )
      CALL CRONE ( INDEX, PARAM , AS1 )
      CALL CRONE ( INDEX, PARAM , AS2 )
      CALL CRONE ( INDEX, PARAM , AS3 )
      CALL CRONE ( INDEX, PARAM , AS4 )
      CALL CRONE ( INDEX, PARAM , AS01 )
      AS03=AS01
      CALL CRONE ( INDEX, PARAM , AS11 )
      AS13=AS11
      CALL CRONE ( INDEX, PARAM , AS21 )
      AS23=AS21
      CALL CRONE ( INDEX, PARAM , AS31 )
      AS33=AS31
      CALL CRONE ( INDEX, PARAM , AS011 )
      AS033=AS011
      CALL CRONE ( INDEX, PARAM , AS111 )
      AS133=AS111
      CALL CRONE ( INDEX, PARAM , AS211 )
      AS233=AS211
      CALL CRONE ( INDEX, PARAM , AS013 )
      CALL CRONE ( INDEX, PARAM , AS113 )
      CALL CRONE ( INDEX, PARAM , AS213 )
C
      RETURN
      END
C
C
      SUBROUTINE DEFASY(PARAM)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 PARAM(128),M1,M2,M3,M
      LOGICAL SYMM
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON/SPNORB/XMULTI,AS0,AS1,AS2,AS3,AS4,
     1              AS01,AS11,AS21,AS31,
     1              AS03,AS13,AS23,AS33,
     1              AS011,AS111,AS211,AS033,AS133,AS233,
     1              AS013,AS113,AS213
C
      COMMON / LZCOMP / XLAMB , XLZ11 ,XLZ12 , XLZ13 , XLZ14,
     1                  XLZ21 , XLZ22 , XLZ23 , XLZ24,
     1                  XLZI1 , XLZI2 , XLZI3 , XLZI4
C
C
      INDEX=1
      CALL DFTWO ( INDEX, PARAM , RE12 , RE32   )
      CALL DFTWO ( INDEX, PARAM , AA1 , AA3     )
      CALL DFTWO ( INDEX, PARAM , G1    , G3    )
      CALL DFTWO ( INDEX, PARAM , G11   , G33   )
      CALL DFONE ( INDEX, PARAM , G13           )
      CALL DFTWO ( INDEX, PARAM , G111  , G333  )
      CALL DFTWO ( INDEX, PARAM , G113  , G133  )
      CALL DFTWO ( INDEX, PARAM , G1111 , G3333 )
      CALL DFTWO ( INDEX, PARAM , G1113 , G1333 )
      CALL DFONE ( INDEX, PARAM , G1133         )
C
      CALL DFONE ( INDEX, PARAM , GA1 )
      CALL DFONE ( INDEX, PARAM , GA2 )
      CALL DFONE ( INDEX, PARAM , GA3 )
      CALL DFONE ( INDEX, PARAM , GA4 )
      CALL DFONE ( INDEX, PARAM , GA5 )
      CALL DFONE ( INDEX, PARAM , GA6 )
      CALL DFONE ( INDEX, PARAM , GA7 )
      CALL DFONE ( INDEX, PARAM , GA8 )
C
      CALL DFTWO ( INDEX, PARAM , G1A1    , G1A3     )
      CALL DFTWO ( INDEX, PARAM , G2A1    , G2A3     )
      CALL DFTWO ( INDEX, PARAM , G3A1    , G3A3     )
      CALL DFTWO ( INDEX, PARAM , G4A1    , G4A3     )
      CALL DFTWO ( INDEX, PARAM , G1A11   , G1A33    )
      CALL DFTWO ( INDEX, PARAM , G2A11   , G2A33    )
      CALL DFTWO ( INDEX, PARAM , G3A11   , G3A33    )
      CALL DFONE ( INDEX, PARAM , G1A13   )
      CALL DFONE ( INDEX, PARAM , G2A13   )
      CALL DFONE ( INDEX, PARAM , G3A13   )
      CALL DFTWO ( INDEX, PARAM , G1A111  , G1A333   )
      CALL DFTWO ( INDEX, PARAM , G2A111  , G2A333   )
      CALL DFTWO ( INDEX, PARAM , G1A113  , G1A133   )
      CALL DFTWO ( INDEX, PARAM , G2A113  , G2A133   )
      CALL DFTWO ( INDEX, PARAM , GA1111  , GA3333   )
      CALL DFTWO ( INDEX, PARAM , GA1113  , GA1333   )
      CALL DFONE ( INDEX, PARAM , GA1133  )
C
      CALL DFONE ( INDEX, PARAM , HA1 )
      CALL DFONE ( INDEX, PARAM , HA2 )
      CALL DFONE ( INDEX, PARAM , HA3 )
      CALL DFONE ( INDEX, PARAM , HA4 )
      CALL DFONE ( INDEX, PARAM , HA5 )
      CALL DFONE ( INDEX, PARAM , HA6 )
      CALL DFONE ( INDEX, PARAM , HA7 )
      CALL DFONE ( INDEX, PARAM , HA8 )
C
      CALL DFTWO ( INDEX, PARAM , H1A1    , H1A3     )
      CALL DFTWO ( INDEX, PARAM , H2A1    , H2A3     )
      CALL DFTWO ( INDEX, PARAM , H3A1    , H3A3     )
      CALL DFTWO ( INDEX, PARAM , H4A1    , H4A3     )
      CALL DFTWO ( INDEX, PARAM , H1A11   , H1A33    )
      CALL DFTWO ( INDEX, PARAM , H2A11   , H2A33    )
      CALL DFTWO ( INDEX, PARAM , H3A11   , H3A33    )
      CALL DFONE ( INDEX, PARAM , H1A13   )
      CALL DFONE ( INDEX, PARAM , H2A13   )
      CALL DFONE ( INDEX, PARAM , H3A13   )
      CALL DFTWO ( INDEX, PARAM , H1A111  , H1A333   )
      CALL DFTWO ( INDEX, PARAM , H2A111  , H2A333   )
      CALL DFTWO ( INDEX, PARAM , H1A113  , H1A133   )
      CALL DFTWO ( INDEX, PARAM , H2A113  , H2A133   )
      CALL DFTWO ( INDEX, PARAM , HA1111  , HA3333   )
      CALL DFTWO ( INDEX, PARAM , HA1113  , HA1333   )
      CALL DFONE ( INDEX, PARAM , HA1133  )
C
      CALL DFONE ( INDEX, PARAM , XLZ11 )
      CALL DFONE ( INDEX, PARAM , XLZ12 )
      CALL DFONE ( INDEX, PARAM , XLZ13 )
      CALL DFONE ( INDEX, PARAM , XLZ14 )
      CALL DFONE ( INDEX, PARAM , XLZ21 )
      CALL DFONE ( INDEX, PARAM , XLZ22 )
      CALL DFONE ( INDEX, PARAM , XLZ23 )
      CALL DFONE ( INDEX, PARAM , XLZ24 )
      CALL DFONE ( INDEX, PARAM , XLZI1 )
      CALL DFONE ( INDEX, PARAM , XLZI2 )
      CALL DFONE ( INDEX, PARAM , XLZI3 )
      CALL DFONE ( INDEX, PARAM , XLZI4 )
      CALL DFONE ( INDEX, PARAM , AS0 )
      CALL DFONE ( INDEX, PARAM , AS1 )
      CALL DFONE ( INDEX, PARAM , AS2 )
      CALL DFONE ( INDEX, PARAM , AS3 )
      CALL DFONE ( INDEX, PARAM , AS4 )
      CALL DFTWO ( INDEX, PARAM , AS01    , AS03     )
      CALL DFTWO ( INDEX, PARAM , AS11    , AS13     )
      CALL DFTWO ( INDEX, PARAM , AS21    , AS23     )
      CALL DFTWO ( INDEX, PARAM , AS31    , AS33     )
      CALL DFTWO ( INDEX, PARAM , AS011   , AS033    )
      CALL DFTWO ( INDEX, PARAM , AS111   , AS133    )
      CALL DFTWO ( INDEX, PARAM , AS211   , AS233    )
      CALL DFONE ( INDEX, PARAM , AS013 )
      CALL DFONE ( INDEX, PARAM , AS113 )
      CALL DFONE ( INDEX, PARAM , AS213 )
C
C
      RETURN
      END
C
C
      SUBROUTINE DEFSYM(PARAM)
C
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128),M1,M2,M3,M
      LOGICAL SYMM
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON/SPNORB/XMULTI,AS0,AS1,AS2,AS3,AS4,
     1              AS01,AS11,AS21,AS31,
     1              AS03,AS13,AS23,AS33,
     1              AS011,AS111,AS211,AS033,AS133,AS233,
     1              AS013,AS113,AS213
C
C
      COMMON / LZCOMP / XLAMB , XLZ11 ,XLZ12 , XLZ13 , XLZ14,
     1                  XLZ21 , XLZ22 , XLZ23 , XLZ24,
     1                  XLZI1 , XLZI2 , XLZI3 , XLZI4
C
C
      INDEX=1
      CALL DFONE ( INDEX, PARAM , RE12 )
      CALL DFONE ( INDEX, PARAM , AA1 )
      CALL DFONE ( INDEX, PARAM , G1 )
      CALL DFONE ( INDEX, PARAM , G11 )
      CALL DFONE ( INDEX, PARAM , G13 )
      CALL DFONE ( INDEX, PARAM , G111 )
      CALL DFONE ( INDEX, PARAM , G113 )
      CALL DFONE ( INDEX, PARAM , G1111 )
      CALL DFONE ( INDEX, PARAM , G1113 )
      CALL DFONE ( INDEX, PARAM , G1133 )
C
      CALL DFONE ( INDEX, PARAM , GA1 )
      CALL DFONE ( INDEX, PARAM , GA2 )
      CALL DFONE ( INDEX, PARAM , GA3 )
      CALL DFONE ( INDEX, PARAM , GA4 )
      CALL DFONE ( INDEX, PARAM , GA5 )
      CALL DFONE ( INDEX, PARAM , GA6 )
      CALL DFONE ( INDEX, PARAM , GA7 )
      CALL DFONE ( INDEX, PARAM , GA8 )
C
      CALL DFONE ( INDEX, PARAM , G1A1 )
      CALL DFONE ( INDEX, PARAM , G2A1 )
      CALL DFONE ( INDEX, PARAM , G3A1 )
      CALL DFONE ( INDEX, PARAM , G4A1 )
      CALL DFONE ( INDEX, PARAM , G1A11 )
      CALL DFONE ( INDEX, PARAM , G2A11 )
      CALL DFONE ( INDEX, PARAM , G3A11 )
      CALL DFONE ( INDEX, PARAM , G1A13 )
      CALL DFONE ( INDEX, PARAM , G2A13 )
      CALL DFONE ( INDEX, PARAM , G3A13 )
      CALL DFONE ( INDEX, PARAM , G1A111 )
      CALL DFONE ( INDEX, PARAM , G2A111 )
      CALL DFONE ( INDEX, PARAM , G1A113 )
      CALL DFONE ( INDEX, PARAM , G2A113 )
      CALL DFONE ( INDEX, PARAM , GA1111 )
      CALL DFONE ( INDEX, PARAM , GA1113 )
      CALL DFONE ( INDEX, PARAM , GA1133 )
      CALL DFONE ( INDEX, PARAM , HA1 )
      CALL DFONE ( INDEX, PARAM , HA2 )
      CALL DFONE ( INDEX, PARAM , HA3 )
      CALL DFONE ( INDEX, PARAM , HA4 )
      CALL DFONE ( INDEX, PARAM , HA5 )
      CALL DFONE ( INDEX, PARAM , HA6 )
      CALL DFONE ( INDEX, PARAM , HA7 )
      CALL DFONE ( INDEX, PARAM , HA8 )
C
      CALL DFONE ( INDEX, PARAM , H1A1 )
      CALL DFONE ( INDEX, PARAM , H2A1 )
      CALL DFONE ( INDEX, PARAM , H3A1 )
      CALL DFONE ( INDEX, PARAM , H4A1 )
      CALL DFONE ( INDEX, PARAM , H1A11 )
      CALL DFONE ( INDEX, PARAM , H2A11 )
      CALL DFONE ( INDEX, PARAM , H3A11 )
      CALL DFONE ( INDEX, PARAM , H1A13 )
      CALL DFONE ( INDEX, PARAM , H2A13 )
      CALL DFONE ( INDEX, PARAM , H3A13 )
      CALL DFONE ( INDEX, PARAM , H1A111 )
      CALL DFONE ( INDEX, PARAM , H2A111 )
      CALL DFONE ( INDEX, PARAM , H1A113 )
      CALL DFONE ( INDEX, PARAM , H2A113 )
      CALL DFONE ( INDEX, PARAM , HA1111 )
      CALL DFONE ( INDEX, PARAM , HA1113 )
      CALL DFONE ( INDEX, PARAM , HA1133 )
      CALL DFONE ( INDEX, PARAM , XLZ11 )
      CALL DFONE ( INDEX, PARAM , XLZ12 )
      CALL DFONE ( INDEX, PARAM , XLZ13 )
      CALL DFONE ( INDEX, PARAM , XLZ14 )
      CALL DFONE ( INDEX, PARAM , XLZ21 )
      CALL DFONE ( INDEX, PARAM , XLZ22 )
      CALL DFONE ( INDEX, PARAM , XLZ23 )
      CALL DFONE ( INDEX, PARAM , XLZ24 )
      CALL DFONE ( INDEX, PARAM , XLZI1 )
      CALL DFONE ( INDEX, PARAM , XLZI2 )
      CALL DFONE ( INDEX, PARAM , XLZI3 )
      CALL DFONE ( INDEX, PARAM , XLZI4 )
      CALL DFONE ( INDEX, PARAM , AS0 )
      CALL DFONE ( INDEX, PARAM , AS1 )
      CALL DFONE ( INDEX, PARAM , AS2 )
      CALL DFONE ( INDEX, PARAM , AS3 )
      CALL DFONE ( INDEX, PARAM , AS4 )
      CALL DFONE ( INDEX, PARAM , AS01 )
      CALL DFONE ( INDEX, PARAM , AS11 )
      CALL DFONE ( INDEX, PARAM , AS21 )
      CALL DFONE ( INDEX, PARAM , AS31 )
      CALL DFONE ( INDEX, PARAM , AS011 )
      CALL DFONE ( INDEX, PARAM , AS111 )
      CALL DFONE ( INDEX, PARAM , AS211 )
      CALL DFONE ( INDEX, PARAM , AS013 )
      CALL DFONE ( INDEX, PARAM , AS113 )
      CALL DFONE ( INDEX, PARAM , AS213 )
C
C
      RETURN
      END
C
C
      SUBROUTINE SOLVEX (X,IX,M,N,PREC,DET,TEST)
      IMPLICIT REAL*8   (A-H,O-Z)
C
      INTEGER I1(255), I2(255)
      REAL*8   X(128,128),T,DET,BIG,PREC,TEST,PIV,TEMP
      EQUIVALENCE (BIG,TEMP,PIV)
C
C     INITIALIZATION
C
      DET = 1.E0
      TEMP = ABS(PREC)
      IF (TEMP .EQ. 0.E0)  TEMP = 0.5E-14
      TEST = 0.E0
      DO 1 I = 1,M
      I2(I) = 0
      DO 1 J = 1,M
1     TEST = TEST + X(I,J) * X(I,J)
      TEST = TEMP * SQRT(TEST) / M
C
C     SEARCH FOR NEXT PIVOT, AVOIDING ROWS AND COLUMNS WHICH ALREADY
C     CONTAIN A PIVOT.
C
      DO 9 K = 1,M
      BIG = 0.E0
      DO 3 I = 1,M
      IF (I2(I) .NE. 0) GO TO 3
      DO 2 J = 1,M
      IF (I2(J) .NE. 0) GO TO 2
      T =ABS(X(I,J))
      IF (T .LE. BIG) GO TO 2
      BIG = T
      IROW = I
      JCOL = J
2     CONTINUE
3     CONTINUE
      IF (BIG .LE. TEST) RETURN
C
C     RECORD POSITION OF PIVOT THEN MOVE PIVOTAL ROW SO PIVOT LIES ON
C     THE DIAGONAL. SCALE PIVOTAL ROW.
C
      I1(K) = JCOL
      I2(JCOL) = IROW
      IF (JCOL .EQ. IROW) GO TO 6
      DO 5 J = 1,N
      TEMP = X(IROW,J)
      X(IROW,J) = X(JCOL,J)
5     X(JCOL,J) = TEMP
      DET = -DET
6     DET = DET * X(JCOL,JCOL)
      PIV = 1.E0/X(JCOL,JCOL)
      DO 7 J = 1,N
      IF (J .NE. JCOL)  X(JCOL,J) = PIV * X(JCOL,J)
7     CONTINUE
      X(JCOL,JCOL) = PIV
C
C     ELIMINATE REMAINING ROWS.
C
      DO 9 I = 1,M
      IF (I .EQ. JCOL)  GO TO 9
      PIV = -X(I,JCOL)
      DO 8 J = 1,N
      IF (J .NE. JCOL)  X(I,J) = X(I,J) + PIV * X(JCOL,J)
8     CONTINUE
      X(I,JCOL) = PIV * X(JCOL,JCOL)
9     CONTINUE
C
C     UNSCRAMBLE THE COLUMNS OF THE INVERSE ACCORDING TO THE ORIGINAL
C     POSITIONS OF THE PIVOTS.
C
      DO 11 K = 1,M
      I = M+1 - K
      JCOL = I1(I)
      IROW = I2(JCOL)
      IF (IROW .EQ. JCOL)  GO TO 11
      DO 10 I = 1,M
      TEMP = X(I,IROW)
      X(I,IROW) = X(I,JCOL)
10    X(I,JCOL) = TEMP
11    CONTINUE
      TEST = 0.E0
      RETURN
      END
C
C
      SUBROUTINE NAMESY ( PX )
      CHARACTER*6 PX(128)
      INDEX=1
      CALL NMONE ( INDEX, PX , 'RE12  ' )
      CALL NMONE ( INDEX, PX , 'AA1   ' )
      CALL NMONE ( INDEX, PX , 'G1    ' )
      CALL NMONE ( INDEX, PX , 'G11   ' )
      CALL NMONE ( INDEX, PX , 'G13   ' )
      CALL NMONE ( INDEX, PX , 'G111  ' )
      CALL NMONE ( INDEX, PX , 'G113  ' )
      CALL NMONE ( INDEX, PX , 'G1111 ' )
      CALL NMONE ( INDEX, PX , 'G1113 ' )
      CALL NMONE ( INDEX, PX , 'G1133 ' )
C
      CALL NMONE ( INDEX, PX , 'GA1   ' )
      CALL NMONE ( INDEX, PX , 'GA2   ' )
      CALL NMONE ( INDEX, PX , 'GA3   ' )
      CALL NMONE ( INDEX, PX , 'GA4   ' )
      CALL NMONE ( INDEX, PX , 'GA5   ' )
      CALL NMONE ( INDEX, PX , 'GA6   ' )
      CALL NMONE ( INDEX, PX , 'GA7   ' )
      CALL NMONE ( INDEX, PX , 'GA8   ' )
C
      CALL NMONE ( INDEX, PX , 'G1A1  ' )
      CALL NMONE ( INDEX, PX , 'G2A1  ' )
      CALL NMONE ( INDEX, PX , 'G3A1  ' )
      CALL NMONE ( INDEX, PX , 'G4A1  ' )
      CALL NMONE ( INDEX, PX , 'G1A11 ' )
      CALL NMONE ( INDEX, PX , 'G2A11 ' )
      CALL NMONE ( INDEX, PX , 'G3A11 ' )
      CALL NMONE ( INDEX, PX , 'G1A13 ' )
      CALL NMONE ( INDEX, PX , 'G2A13 ' )
      CALL NMONE ( INDEX, PX , 'G3A13 ' )
      CALL NMONE ( INDEX, PX , 'G1A111' )
      CALL NMONE ( INDEX, PX , 'G2A111' )
      CALL NMONE ( INDEX, PX , 'G1A113' )
      CALL NMONE ( INDEX, PX , 'G2A113' )
      CALL NMONE ( INDEX, PX , 'GA1111' )
      CALL NMONE ( INDEX, PX , 'GA1113' )
      CALL NMONE ( INDEX, PX , 'GA1133' )
      CALL NMONE ( INDEX, PX , 'HA1   ' )
      CALL NMONE ( INDEX, PX , 'HA2   ' )
      CALL NMONE ( INDEX, PX , 'HA3   ' )
      CALL NMONE ( INDEX, PX , 'HA4   ' )
      CALL NMONE ( INDEX, PX , 'HA5   ' )
      CALL NMONE ( INDEX, PX , 'HA6   ' )
      CALL NMONE ( INDEX, PX , 'HA7   ' )
      CALL NMONE ( INDEX, PX , 'HA8   ' )
C
      CALL NMONE ( INDEX, PX , 'H1A1  ' )
      CALL NMONE ( INDEX, PX , 'H2A1  ' )
      CALL NMONE ( INDEX, PX , 'H3A1  ' )
      CALL NMONE ( INDEX, PX , 'H4A1  ' )
      CALL NMONE ( INDEX, PX , 'H1A11 ' )
      CALL NMONE ( INDEX, PX , 'H2A11 ' )
      CALL NMONE ( INDEX, PX , 'H3A11 ' )
      CALL NMONE ( INDEX, PX , 'H1A13 ' )
      CALL NMONE ( INDEX, PX , 'H2A13 ' )
      CALL NMONE ( INDEX, PX , 'H3A13 ' )
      CALL NMONE ( INDEX, PX , 'H1A111' )
      CALL NMONE ( INDEX, PX , 'H2A111' )
      CALL NMONE ( INDEX, PX , 'H1A113' )
      CALL NMONE ( INDEX, PX , 'H2A113' )
      CALL NMONE ( INDEX, PX , 'HA1111' )
      CALL NMONE ( INDEX, PX , 'HA1113' )
      CALL NMONE ( INDEX, PX , 'HA1133' )
      CALL NMONE ( INDEX, PX , 'XLZ11 ' )
      CALL NMONE ( INDEX, PX , 'XLZ12 ' )
      CALL NMONE ( INDEX, PX , 'XLZ13 ' )
      CALL NMONE ( INDEX, PX , 'XLZ14 ' )
      CALL NMONE ( INDEX, PX , 'XLZ21 ' )
      CALL NMONE ( INDEX, PX , 'XLZ22 ' )
      CALL NMONE ( INDEX, PX , 'XLZ23 ' )
      CALL NMONE ( INDEX, PX , 'XLZ24 ' )
      CALL NMONE ( INDEX, PX , 'XLZI1 ' )
      CALL NMONE ( INDEX, PX , 'XLZI2 ' )
      CALL NMONE ( INDEX, PX , 'XLZI3 ' )
      CALL NMONE ( INDEX, PX , 'XLZI4 ' )
      CALL NMONE ( INDEX, PX , 'AS0   ' )
      CALL NMONE ( INDEX, PX , 'AS1   ' )
      CALL NMONE ( INDEX, PX , 'AS2   ' )
      CALL NMONE ( INDEX, PX , 'AS3   ' )
      CALL NMONE ( INDEX, PX , 'AS4   ' )
      CALL NMONE ( INDEX, PX , 'AS01  ' )
      CALL NMONE ( INDEX, PX , 'AS11  ' )
      CALL NMONE ( INDEX, PX , 'AS21  ' )
      CALL NMONE ( INDEX, PX , 'AS31  ' )
      CALL NMONE ( INDEX, PX , 'AS011 ' )
      CALL NMONE ( INDEX, PX , 'AS111 ' )
      CALL NMONE ( INDEX, PX , 'AS211 ' )
      CALL NMONE ( INDEX, PX , 'AS013 ' )
      CALL NMONE ( INDEX, PX , 'AS113 ' )
      CALL NMONE ( INDEX, PX , 'AS213 ' )
      RETURN
      END
C
C
      SUBROUTINE NAMEAS ( PX )
      CHARACTER*6 PX(128)
      INDEX=1
      CALL NMTWO ( INDEX, PX , 'RE12  ' , 'RE32  ' )
      CALL NMTWO ( INDEX, PX , 'AA1   ' , 'AA3   ' )
      CALL NMTWO ( INDEX, PX , 'G1    ' , 'G3    ' )
      CALL NMTWO ( INDEX, PX , 'G11   ' , 'G33   ' )
      CALL NMONE ( INDEX, PX , 'G13   ' )
      CALL NMTWO ( INDEX, PX , 'G111  ' , 'G333  ' )
      CALL NMTWO ( INDEX, PX , 'G113  ' , 'G133  ' )
      CALL NMTWO ( INDEX, PX , 'G1111 ' , 'G3333 ' )
      CALL NMTWO ( INDEX, PX , 'G1113 ' , 'G1333 ' )
      CALL NMONE ( INDEX, PX , 'G1133 ' )
C
      CALL NMONE ( INDEX, PX , 'GA1   ' )
      CALL NMONE ( INDEX, PX , 'GA2   ' )
      CALL NMONE ( INDEX, PX , 'GA3   ' )
      CALL NMONE ( INDEX, PX , 'GA4   ' )
      CALL NMONE ( INDEX, PX , 'GA5   ' )
      CALL NMONE ( INDEX, PX , 'GA6   ' )
      CALL NMONE ( INDEX, PX , 'GA7   ' )
      CALL NMONE ( INDEX, PX , 'GA8   ' )
C
      CALL NMTWO ( INDEX, PX , 'G1A1  ' , 'G1A3  ' )
      CALL NMTWO ( INDEX, PX , 'G2A1  ' , 'G2A3  ' )
      CALL NMTWO ( INDEX, PX , 'G3A1  ' , 'G3A3  ' )
      CALL NMTWO ( INDEX, PX , 'G4A1  ' , 'G4A3  ' )
      CALL NMTWO ( INDEX, PX , 'G1A11 ' , 'G1A33 ' )
      CALL NMTWO ( INDEX, PX , 'G2A11 ' , 'G2A33 ' )
      CALL NMTWO ( INDEX, PX , 'G3A11 ' , 'G3A33 ' )
      CALL NMONE ( INDEX, PX , 'G1A13 ' )
      CALL NMONE ( INDEX, PX , 'G2A13 ' )
      CALL NMONE ( INDEX, PX , 'G3A13 ' )
      CALL NMTWO ( INDEX, PX , 'G1A111' , 'G1A333' )
      CALL NMTWO ( INDEX, PX , 'G2A111' , 'G2A333' )
      CALL NMTWO ( INDEX, PX , 'G1A113' , 'G1A113' )
      CALL NMTWO ( INDEX, PX , 'G2A113' , 'G2A113' )
      CALL NMTWO ( INDEX, PX , 'GA1111' , 'GA3333' )
      CALL NMTWO ( INDEX, PX , 'GA1113' , 'GA1333' )
      CALL NMONE ( INDEX, PX , 'GA1133' )
C
      CALL NMONE ( INDEX, PX , 'HA1   ' )
      CALL NMONE ( INDEX, PX , 'HA2   ' )
      CALL NMONE ( INDEX, PX , 'HA3   ' )
      CALL NMONE ( INDEX, PX , 'HA4   ' )
      CALL NMONE ( INDEX, PX , 'HA5   ' )
      CALL NMONE ( INDEX, PX , 'HA6   ' )
      CALL NMONE ( INDEX, PX , 'HA7   ' )
      CALL NMONE ( INDEX, PX , 'HA8   ' )
C
      CALL NMTWO ( INDEX, PX , 'H1A1  ' , 'H1A3  ' )
      CALL NMTWO ( INDEX, PX , 'H2A1  ' , 'H2A3  ' )
      CALL NMTWO ( INDEX, PX , 'H3A1  ' , 'H3A3  ' )
      CALL NMTWO ( INDEX, PX , 'H4A1  ' , 'H4A3  ' )
      CALL NMTWO ( INDEX, PX , 'H1A11 ' , 'H1A33 ' )
      CALL NMTWO ( INDEX, PX , 'H2A11 ' , 'H2A33 ' )
      CALL NMTWO ( INDEX, PX , 'H3A11 ' , 'H3A33 ' )
      CALL NMONE ( INDEX, PX , 'H1A13 ' )
      CALL NMONE ( INDEX, PX , 'H2A13 ' )
      CALL NMONE ( INDEX, PX , 'H3A13 ' )
      CALL NMTWO ( INDEX, PX , 'H1A111' , 'H1A333' )
      CALL NMTWO ( INDEX, PX , 'H2A111' , 'H2A333' )
      CALL NMTWO ( INDEX, PX , 'H1A113' , 'H1A113' )
      CALL NMTWO ( INDEX, PX , 'H2A113' , 'H2A113' )
      CALL NMTWO ( INDEX, PX , 'HA1111' , 'HA3333' )
      CALL NMTWO ( INDEX, PX , 'HA1113' , 'HA1333' )
      CALL NMONE ( INDEX, PX , 'HA1133' )
C
      CALL NMONE ( INDEX, PX , 'XLZ11 ' )
      CALL NMONE ( INDEX, PX , 'XLZ12 ' )
      CALL NMONE ( INDEX, PX , 'XLZ13 ' )
      CALL NMONE ( INDEX, PX , 'XLZ14 ' )
      CALL NMONE ( INDEX, PX , 'XLZ21 ' )
      CALL NMONE ( INDEX, PX , 'XLZ22 ' )
      CALL NMONE ( INDEX, PX , 'XLZ23 ' )
      CALL NMONE ( INDEX, PX , 'XLZ24 ' )
      CALL NMONE ( INDEX, PX , 'XLZI1 ' )
      CALL NMONE ( INDEX, PX , 'XLZI2 ' )
      CALL NMONE ( INDEX, PX , 'XLZI3 ' )
      CALL NMONE ( INDEX, PX , 'XLZI4 ' )
      CALL NMONE ( INDEX, PX , 'AS0   ' )
      CALL NMONE ( INDEX, PX , 'AS1   ' )
      CALL NMONE ( INDEX, PX , 'AS2   ' )
      CALL NMONE ( INDEX, PX , 'AS3   ' )
      CALL NMONE ( INDEX, PX , 'AS4   ' )
      CALL NMTWO ( INDEX, PX , 'AS01  ' , 'AS03  ' )
      CALL NMTWO ( INDEX, PX , 'AS11  ' , 'AS13  ' )
      CALL NMTWO ( INDEX, PX , 'AS21  ' , 'AS23  ' )
      CALL NMTWO ( INDEX, PX , 'AS31  ' , 'AS33  ' )
      CALL NMTWO ( INDEX, PX , 'AS011 ' , 'AS033 ' )
      CALL NMTWO ( INDEX, PX , 'AS111 ' , 'AS133 ' )
      CALL NMTWO ( INDEX, PX , 'AS211 ' , 'AS233 ' )
      CALL NMONE ( INDEX, PX , 'AS013 ' )
      CALL NMONE ( INDEX, PX , 'AS113 ' )
      CALL NMONE ( INDEX, PX , 'AS213 ' )
      RETURN
      END
C
C
      SUBROUTINE CSHEET(NUMBER)
      IMPLICIT REAL*8 (A-H,O-Z)
C
C
      REAL*8 DIPMMY(53),
     1       DIPMMZ(53),
     2       DIPPPY(53),
     3       DIPPPZ(53),
     4       DIPMPX(53)
      INTEGER IACT
C
      COMMON /DIP/   IACT
      COMMON /DIPMM/ DIPMMY,DIPMMZ
      COMMON /DIPPP/ DIPPPY,DIPPPZ
      COMMON /DIPMP/ DIPMPX
C
      include 'dipole.h'
C
      REAL*8 M1,M2,M3,M
      LOGICAL SYMM
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      F1=G1
      F3=G3
      F11=G11
      F33=G33
      F13=G13
      F111=G111
      F333=G333
      F113=G113
      F133=G133
      F1111=G1111
      F3333=G3333
      F1113=G1113
      F1333=G1333
      F1133=G1133
      IF (NUMBER .EQ. 1) THEN
      FA1=GA1
      FA2=GA2
      FA3=GA3
      FA4=GA4
      FA5=GA5
      FA6=GA6
      FA7=GA7
      FA8=GA8
      F1A1=G1A1
      F2A1=G2A1
      F3A1=G3A1
      F4A1=G4A1
      F1A3=G1A3
      F2A3=G2A3
      F3A3=G3A3
      F4A3=G4A3
      F1A11=G1A11
      F2A11=G2A11
      F3A11=G3A11
      F1A33=G1A33
      F2A33=G2A33
      F3A33=G3A33
      F1A13=G1A13
      F2A13=G2A13
      F3A13=G3A13
      F1A111=G1A111
      F2A111=G2A111
      F1A333=G1A333
      F2A333=G2A333
      F1A113=G1A113
      F2A113=G2A113
      F1A133=G1A133
      F2A133=G2A133
      FA1111=GA1111
      FA3333=GA3333
      FA1113=GA1113
      FA1333=GA1333
      FA1133=GA1133
      ENDIF
      IF (NUMBER .EQ. 2) THEN
      FA1=HA1
      FA2=HA2
      FA3=HA3
      FA4=HA4
      FA5=HA5
      FA6=HA6
      FA7=HA7
      FA8=HA8
      F1A1=H1A1
      F2A1=H2A1
      F3A1=H3A1
      F4A1=H4A1
      F1A3=H1A3
      F2A3=H2A3
      F3A3=H3A3
      F4A3=H4A3
      F1A11=H1A11
      F2A11=H2A11
      F3A11=H3A11
      F1A33=H1A33
      F2A33=H2A33
      F3A33=H3A33
      F1A13=H1A13
      F2A13=H2A13
      F3A13=H3A13
      F1A111=H1A111
      F2A111=H2A111
      F1A333=H1A333
      F2A333=H2A333
      F1A113=H1A113
      F2A113=H2A113
      F1A133=H1A133
      F2A133=H2A133
      FA1111=HA1111
      FA3333=HA3333
      FA1113=HA1113
      FA1333=HA1333
      FA1133=HA1133
      ENDIF
      IF (IACT.GE.1) THEN
        IF (NUMBER.EQ.1) THEN
          P0 =DIPMMZ( 1)
          PA1=DIPMMZ( 2)
          PA2=DIPMMZ( 3)
          PA3=DIPMMZ( 4)
          PA4=DIPMMZ( 5)
          PA5=DIPMMZ( 6)
          PA6=DIPMMZ( 7)
          PA7=DIPMMZ( 8)
          PA8=DIPMMZ( 9)
          P1  = DIPMMZ(10)
          P1A1 = DIPMMZ(11)
          P2A1 = DIPMMZ(12)
          P3A1 = DIPMMZ(13)
          P4A1 =  DIPMMZ(14)
          P3  = DIPMMZ(15)
          P1A3 = DIPMMZ(16)
          P2A3 = DIPMMZ(17)
          P3A3 = DIPMMZ(18)
          P4A3 = DIPMMZ(19)
          P11  = DIPMMZ(20)
          P1A11 = DIPMMZ(21)
          P2A11 = DIPMMZ(22)
          P3A11 = DIPMMZ(23)
          P33  = DIPMMZ(24)
          P1A33 = DIPMMZ(25)
          P2A33 = DIPMMZ(26)
          P3A33 = DIPMMZ(27)
          P13  = DIPMMZ(28)
          P1A13 = DIPMMZ(29)
          P2A13 = DIPMMZ(30)
          P3A13 = DIPMMZ(31)
          P111  = DIPMMZ(32)
          P1A111 = DIPMMZ(33)
          P2A111 = DIPMMZ(34)
          P333  = DIPMMZ(35)
          P1A333 = DIPMMZ(36)
          P2A333 = DIPMMZ(37)
          P113  = DIPMMZ(38)
          P1A113 = DIPMMZ(39)
          P2A113 = DIPMMZ(40)
          P133  = DIPMMZ(41)
          P1A133 = DIPMMZ(42)
          P2A133 = DIPMMZ(43)
          P1111   = DIPMMZ(44)
          PA1111  = DIPMMZ(45)
          P3333   = DIPMMZ(46)
          PA3333  = DIPMMZ(47)
          P1113   = DIPMMZ(48)
          PA1113  = DIPMMZ(49)
          P1333   = DIPMMZ(50)
          PA1333  = DIPMMZ(51)
          P1133   = DIPMMZ(52)
          PA1133  = DIPMMZ(53)
          O0 =DIPMMY( 1)
          OA1=DIPMMY( 2)
          OA2=DIPMMY( 3)
          OA3=DIPMMY( 4)
          OA4=DIPMMY( 5)
          OA5=DIPMMY( 6)
          OA6=DIPMMY( 7)
          OA7=DIPMMY( 8)
          OA8=DIPMMY( 9)
          O1  = DIPMMY(10)
          O1A1 = DIPMMY(11)
          O2A1 = DIPMMY(12)
          O3A1 = DIPMMY(13)
          O4A1 =  DIPMMY(14)
          O3  = DIPMMY(15)
          O1A3 = DIPMMY(16)
          O2A3 = DIPMMY(17)
          O3A3 = DIPMMY(18)
          O4A3 = DIPMMY(19)
          O11  = DIPMMY(20)
          O1A11 = DIPMMY(21)
          O2A11 = DIPMMY(22)
          O3A11 = DIPMMY(23)
          O33  = DIPMMY(24)
          O1A33 = DIPMMY(25)
          O2A33 = DIPMMY(26)
          O3A33 = DIPMMY(27)
          O13  = DIPMMY(28)
          O1A13 = DIPMMY(29)
          O2A13 = DIPMMY(30)
          O3A13 = DIPMMY(31)
          O111  = DIPMMY(32)
          O1A111 = DIPMMY(33)
          O2A111 = DIPMMY(34)
          O333  = DIPMMY(35)
          O1A333 = DIPMMY(36)
          O2A333 = DIPMMY(37)
          O113  = DIPMMY(38)
          O1A113 = DIPMMY(39)
          O2A113 = DIPMMY(40)
          O133  = DIPMMY(41)
          O1A133 = DIPMMY(42)
          O2A133 = DIPMMY(43)
          O1111   = DIPMMY(44)
          OA1111  = DIPMMY(45)
          O3333   = DIPMMY(46)
          OA3333  = DIPMMY(47)
          O1113   = DIPMMY(48)
          OA1113  = DIPMMY(49)
          O1333   = DIPMMY(50)
          OA1333  = DIPMMY(51)
          O1133   = DIPMMY(52)
          OA1133  = DIPMMY(53)
        ENDIF
        IF (NUMBER.EQ.2) THEN
          P0 =DIPPPZ( 1)
          PA1=DIPPPZ( 2)
          PA2=DIPPPZ( 3)
          PA3=DIPPPZ( 4)
          PA4=DIPPPZ( 5)
          PA5=DIPPPZ( 6)
          PA6=DIPPPZ( 7)
          PA7=DIPPPZ( 8)
          PA8=DIPPPZ( 9)
          P1  = DIPPPZ(10)
          P1A1 = DIPPPZ(11)
          P2A1 = DIPPPZ(12)
          P3A1 = DIPPPZ(13)
          P4A1 =  DIPPPZ(14)
          P3  = DIPPPZ(15)
          P1A3 = DIPPPZ(16)
          P2A3 = DIPPPZ(17)
          P3A3 = DIPPPZ(18)
          P4A3 = DIPPPZ(19)
          P11  = DIPPPZ(20)
          P1A11 = DIPPPZ(21)
          P2A11 = DIPPPZ(22)
          P3A11 = DIPPPZ(23)
          P33  = DIPPPZ(24)
          P1A33 = DIPPPZ(25)
          P2A33 = DIPPPZ(26)
          P3A33 = DIPPPZ(27)
          P13  = DIPPPZ(28)
          P1A13 = DIPPPZ(29)
          P2A13 = DIPPPZ(30)
          P3A13 = DIPPPZ(31)
          P111  = DIPPPZ(32)
          P1A111 = DIPPPZ(33)
          P2A111 = DIPPPZ(34)
          P333  = DIPPPZ(35)
          P1A333 = DIPPPZ(36)
          P2A333 = DIPPPZ(37)
          P113  = DIPPPZ(38)
          P1A113 = DIPPPZ(39)
          P2A113 = DIPPPZ(40)
          P133  = DIPPPZ(41)
          P1A133 = DIPPPZ(42)
          P2A133 = DIPPPZ(43)
          P1111   = DIPPPZ(44)
          PA1111  = DIPPPZ(45)
          P3333   = DIPPPZ(46)
          PA3333  = DIPPPZ(47)
          P1113   = DIPPPZ(48)
          PA1113  = DIPPPZ(49)
          P1333   = DIPPPZ(50)
          PA1333  = DIPPPZ(51)
          P1133   = DIPPPZ(52)
          PA1133  = DIPPPZ(53)
          O0 =DIPPPY( 1)
          OA1=DIPPPY( 2)
          OA2=DIPPPY( 3)
          OA3=DIPPPY( 4)
          OA4=DIPPPY( 5)
          OA5=DIPPPY( 6)
          OA6=DIPPPY( 7)
          OA7=DIPPPY( 8)
          OA8=DIPPPY( 9)
          O1  = DIPPPY(10)
          O1A1 = DIPPPY(11)
          O2A1 = DIPPPY(12)
          O3A1 = DIPPPY(13)
          O4A1 =  DIPPPY(14)
          O3  = DIPPPY(15)
          O1A3 = DIPPPY(16)
          O2A3 = DIPPPY(17)
          O3A3 = DIPPPY(18)
          O4A3 = DIPPPY(19)
          O11  = DIPPPY(20)
          O1A11 = DIPPPY(21)
          O2A11 = DIPPPY(22)
          O3A11 = DIPPPY(23)
          O33  = DIPPPY(24)
          O1A33 = DIPPPY(25)
          O2A33 = DIPPPY(26)
          O3A33 = DIPPPY(27)
          O13  = DIPPPY(28)
          O1A13 = DIPPPY(29)
          O2A13 = DIPPPY(30)
          O3A13 = DIPPPY(31)
          O111  = DIPPPY(32)
          O1A111 = DIPPPY(33)
          O2A111 = DIPPPY(34)
          O333  = DIPPPY(35)
          O1A333 = DIPPPY(36)
          O2A333 = DIPPPY(37)
          O113  = DIPPPY(38)
          O1A113 = DIPPPY(39)
          O2A113 = DIPPPY(40)
          O133  = DIPPPY(41)
          O1A133 = DIPPPY(42)
          O2A133 = DIPPPY(43)
          O1111   = DIPPPY(44)
          OA1111  = DIPPPY(45)
          O3333   = DIPPPY(46)
          OA3333  = DIPPPY(47)
          O1113   = DIPPPY(48)
          OA1113  = DIPPPY(49)
          O1333   = DIPPPY(50)
          OA1333  = DIPPPY(51)
          O1133   = DIPPPY(52)
          OA1133  = DIPPPY(53)
        ENDIF
      ENDIF
      RETURN
      END
C
C
      SUBROUTINE DFONE ( INDEX , PARAM , PARM )
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128)
C
      PARAM(INDEX)=PARM
      INDEX=INDEX+1
      RETURN
      END
C
C
      SUBROUTINE DFTWO ( INDEX , PARAM , PARM1 , PARM2 )
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128)
C
      PARAM(INDEX)=PARM1
      PARAM(INDEX+1)=PARM2
      INDEX=INDEX+2
      RETURN
      END
C
C
      SUBROUTINE CRONE ( INDEX , PARAM , PARM )
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128)
C
      PARM=PARAM(INDEX)
      INDEX=INDEX+1
      RETURN
      END
C
C
      SUBROUTINE CRTWO ( INDEX , PARAM , PARM1 , PARM2 )
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128)
C
      PARM1=PARAM(INDEX)
      PARM2=PARAM(INDEX+1)
      INDEX=INDEX+2
      RETURN
      END
C
C
      SUBROUTINE NMONE ( INDEX , PX , CHARM )
      CHARACTER*6 PX(128)
      CHARACTER*6 CHARM
C
      PX(INDEX)=CHARM
      INDEX=INDEX+1
      RETURN
      END
C
C
      SUBROUTINE NMTWO ( INDEX , PX , CHARM1 , CHARM2 )
      CHARACTER*6 PX(128)
      CHARACTER*6 CHARM1,CHARM2
C
      PX(INDEX)=CHARM1
      PX(INDEX+1)=CHARM2
      INDEX=INDEX+2
      RETURN
      END
C
C
      SUBROUTINE WRTPRM(NUNIT,POTSYM,IVAR,PX)
C
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 PARAM(128),M1,M2,M3,M
      LOGICAL POTSYM,SYMM
      INTEGER IVAR(128)
      CHARACTER*6 PX(128)
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON/SPNORB/XMULTI,AS0,AS1,AS2,AS3,AS4,
     1              AS01,AS11,AS21,AS31,
     1              AS03,AS13,AS23,AS33,
     1              AS011,AS111,AS211,AS033,AS133,AS233,
     1              AS013,AS113,AS213
C
      COMMON / LZCOMP / XLAMB , XLZ11 ,XLZ12 , XLZ13 , XLZ14,
     1                  XLZ21 , XLZ22 , XLZ23 , XLZ24,
     1                  XLZI1 , XLZI2 , XLZI3 , XLZI4
C
      OPEN (NUNIT, STATUS='UNKNOWN', FILE='NEWPARMS.OUT')
C
      INDEX=1
C
      IF (.NOT. POTSYM) GOTO 700
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , RE12 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AA1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1133 )
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA5 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA6 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA7 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA8 )
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G2A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G3A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G4A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1A11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G2A11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G3A11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1A13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G2A13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G3A13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1A111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G2A111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1A113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G2A113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA1111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA1113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA1133 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA5 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA6 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA7 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA8 )
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H1A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H2A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H3A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H4A1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H1A11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H2A11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H3A11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H1A13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H2A13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H3A13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H1A111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H2A111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H1A113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H2A113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA1111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA1113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA1133 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ12 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ14 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ21 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ22 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ23 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ24 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS0 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS01 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS21 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS31 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS011 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS111 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS211 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS013 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS213 )
C
      GOTO 800
C
700   CALL WRTWO ( NUNIT, INDEX, PX, IVAR , RE12 , RE32   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AA1 , AA3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1    , G3    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G11   , G33   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G13           )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G111  , G333  )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G113  , G133  )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1111 , G3333 )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1113 , G1333 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1133         )
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA5 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA6 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA7 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA8 )
C
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1A1    , G1A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G2A1    , G2A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G3A1    , G3A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G4A1    , G4A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1A11   , G1A33    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G2A11   , G2A33    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G3A11   , G3A33    )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G1A13   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G2A13   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , G3A13   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1A111  , G1A333   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G2A111  , G2A333   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G1A113  , G1A133   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , G2A113  , G2A133   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , GA1111  , GA3333   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , GA1113  , GA1333   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , GA1133  )
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA5 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA6 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA7 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA8 )
C
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H1A1    , H1A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H2A1    , H2A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H3A1    , H3A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H4A1    , H4A3     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H1A11   , H1A33    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H2A11   , H2A33    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H3A11   , H3A33    )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H1A13   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H2A13   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , H3A13   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H1A111  , H1A333   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H2A111  , H2A333   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H1A113  , H1A133   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , H2A113  , H2A133   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , HA1111  , HA3333   )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , HA1113  , HA1333   )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , HA1133  )
C
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ11 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ12 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ13 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ14 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ21 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ22 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ23 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZ24 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , XLZI4 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS0 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS1 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS2 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS3 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS4 )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS01    , AS03     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS11    , AS13     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS21    , AS23     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS31    , AS33     )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS011   , AS033    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS111   , AS133    )
      CALL WRTWO ( NUNIT, INDEX, PX, IVAR , AS211   , AS233    )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS013 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS113 )
      CALL WRONE ( NUNIT, INDEX, PX, IVAR , AS213 )
C
800   CLOSE(NUNIT, STATUS='KEEP')
C
      RETURN
      END
C
C
      SUBROUTINE WRONE ( NUNIT, INDEX , PX, IVAR , PARM )
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER IVAR(128)
      CHARACTER*6 PX(128)
C
      WRITE (NUNIT,5700) PX(INDEX),IVAR(INDEX),PARM
5700  FORMAT(A6,4X,I2,D16.8)
      INDEX=INDEX+1
      RETURN
      END
C
C
      SUBROUTINE WRTWO ( NUNIT, INDEX , PX , IVAR , PARM1 , PARM2 )
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER IVAR(128)
      CHARACTER*6 PX(128)
C
      WRITE (NUNIT,5700) PX(INDEX),IVAR(INDEX),PARM1,
     1                  IVAR(INDEX+1),PARM2
5700  FORMAT(A6,4X,2(I2,D16.8))
      INDEX=INDEX+2
      RETURN
      END
C
C
      DOUBLE PRECISION FUNCTION POTVAL(R1,R3,ALPHA,ISURF)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 XIN(3)
C
      INTEGER PRTINT
      include 'rensys.h'
C
      ISURP=ISURF+1
C      
      CALL CSHEET(ISURP)
C
      XIN(1) = R1
      XIN(2) = R3
      XIN(3) = PI*(1.8D+02-ALPHA)/1.8D+02
C
      POTVAL     = FNC2(XIN)
C
      END
