      SUBROUTINE RNPM0 ( VALSYM , VALASY ,
     1                   SMAT   , HMAT   , NOFSRO , NOFSCO ,
     1                   NDIMRO , NDIMCO , V2MP11 , V2MP12 ,
     1                   JP1    , KKP1   ,IRODIM , IEO    , ITAU   ,
     1                   INTSYM , INTASY , ISTOFF , JSTOFF ,
     1                   NOBAL  , NOBAR  , NOPERS , NZERSY , NZERAS ,
     1                   LREC35 )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 , NFIL6 ,
     5       NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, V2MP11, V2MP12,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER LENINT,IOSC1,IOSC3,I,J,IR,JL
      REAL*8 G,GC1,GC3,GC1113,GC3133,GC1133,GC3113
      REAL*8 SMAT(NOBAL,NOBAR,NOPERS),VALSYM(INTSYM),VALASY(INTASY),
     1       HMAT(LREC35,LREC35)
      REAL*8  CONCOR,CONFC1,CONG11,CONG33,CONG13,CORHOE
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
C
      CONZZ=PLANCK*AVOGNO*1.0E+16/(0.8E+01*PI*PI*VELLGT)
      J=JP1-1
      XJJ=((-1)**(JP1+ITAU-1))*DFLOAT(J*JP1)
      CORHOE=COS(RHOE)
      KNDSYM=0
      IF (.NOT. SYMM) KNDASY=0
C
      ITAU1=ITAU
      ITAU2=1-ITAU
C
      DO 940 KP1=1,JP1
C
      DO 920 INDEX1=1,V2MP11
      DO 900 INDEX2=1,V2MP12
C
      KNDSYM=KNDSYM+1
      IOFSY=(KNDSYM-1)*NZERSY
      IF (.NOT. SYMM) THEN
           KNDASY=KNDASY+1
           IOFAS=(KNDASY-1)*NZERAS
      ENDIF
      IF (MOD(KP1,2) .EQ. IEO) GOTO 900
      IF (KP1.NE.KKP1) GOTO 900
      IF (MOD(J+ITAU1,2) .NE. 0  .AND. KP1 .EQ. 1)  GOTO 900
      IF (MOD(J+ITAU2,2) .NE. 0  .AND. KP1 .EQ. 1)  GOTO 900
C
      KNDEX=0
C
      K1P1=KP1
      IF (MOD(K1P1,2) .NE. 0) THEN
            INDK1=(K1P1-1)/2
            IF (MOD(J+ITAU1,2) .NE. 0) INDK1=INDK1-1
      ELSE
            INDK1=(K1P1-2)/2
      ENDIF
      K2P1=KP1
      IF (MOD(K2P1,2) .NE. 0) THEN
            INDK2=(K2P1-1)/2
            IF (MOD(J+ITAU2,2) .NE. 0) INDK2=INDK2-1
      ELSE
            INDK2=(K2P1-2)/2
      ENDIF
      IROWOF=NOFSRO+(INDEX1-1)*NDIMRO
      ICOLOF=NOFSCO+(INDEX2-1)*NDIMCO
C
C  1. LEADING TERM (NOT DEPENDING ON STRETCHING COORDINATES)
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+10)+CONZZ*(VALSYM(IOFSY+ 1)+VALSYM(IOFSY+19))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+28)*XJJ
      DO 100 JL=1,NDIMCO
      DO 100 IR=1,NDIMRO
100   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  2. TERMS CONTAINING Y1
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+11)+CONZZ*(VALSYM(IOFSY+ 2)+VALSYM(IOFSY+20))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+29)*XJJ
      DO 120 JL=1,NDIMCO
      DO 120 IR=1,NDIMRO
120   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 3. TERMS CONTAINING Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM) THEN 
      G =  VALASY(IOFAS+ 7)+CONZZ*(VALASY(IOFAS+ 1)+VALASY(IOFAS+13))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALASY(IOFAS+19)*XJJ
      ENDIF
      DO 140 JL=1,NDIMCO
      DO 140 IR=1,NDIMRO
140   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  4. TERMS CONTAINING Y1*Y1
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+12)+CONZZ*(VALSYM(IOFSY+ 3)+VALSYM(IOFSY+21))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+30)*XJJ
      DO 160 JL=1,NDIMCO
      DO 160 IR=1,NDIMRO
160   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 5. TERMS CONTAINING Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM) THEN
      G =  VALASY(IOFAS+ 8)+CONZZ*(VALASY(IOFAS+ 2)+VALASY(IOFAS+14))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALASY(IOFAS+20)*XJJ
      ENDIF
      DO 180 JL=1,NDIMCO
      DO 180 IR=1,NDIMRO
180   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 6. TERMS CONTAINING Y1*Y3
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+13)+CONZZ*(VALSYM(IOFSY+ 4)+VALSYM(IOFSY+22))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+31)*XJJ
      DO 200 JL=1,NDIMCO
      DO 200 IR=1,NDIMRO
200   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  7. TERMS CONTAINING Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+14)+CONZZ*(VALSYM(IOFSY+ 5)+VALSYM(IOFSY+23))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+32)*XJJ
      DO 220 JL=1,NDIMCO
      DO 220 IR=1,NDIMRO
220   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 8. TERMS CONTAINING Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM) THEN
      G =  VALASY(IOFAS+ 9)+CONZZ*(VALASY(IOFAS+ 3)+VALASY(IOFAS+15))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALASY(IOFAS+21)*XJJ
      ENDIF
      DO 240 JL=1,NDIMCO
      DO 240 IR=1,NDIMRO
240   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  9. TERMS CONTAINING Y1*Y1*Y3
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+15)+CONZZ*(VALSYM(IOFSY+ 6)+VALSYM(IOFSY+24))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+33)*XJJ
      DO 260 JL=1,NDIMCO
      DO 260 IR=1,NDIMRO
260   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 10. TERMS CONTAINING Y1*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM) THEN
      G =  VALASY(IOFAS+10)+CONZZ*(VALASY(IOFAS+ 4)+VALASY(IOFAS+16))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALASY(IOFAS+22)*XJJ
      ENDIF
      DO 280 JL=1,NDIMCO
      DO 280 IR=1,NDIMRO
280   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  11. TERMS CONTAINING Y1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+16)+CONZZ*(VALSYM(IOFSY+ 7)+VALSYM(IOFSY+25))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+34)*XJJ
      DO 300 JL=1,NDIMCO
      DO 300 IR=1,NDIMRO
300   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 12. TERMS CONTAINING Y3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM) THEN
      G =  VALASY(IOFAS+11)+CONZZ*(VALASY(IOFAS+ 5)+VALASY(IOFAS+17))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALASY(IOFAS+23)*XJJ
      ENDIF
      DO 320 JL=1,NDIMCO
      DO 320 IR=1,NDIMRO
320   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  13. TERMS CONTAINING Y1*Y1*Y1*Y3
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+17)+CONZZ*(VALSYM(IOFSY+ 8)+VALSYM(IOFSY+26))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+35)*XJJ
      DO 340 JL=1,NDIMCO
      DO 340 IR=1,NDIMRO
340   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 14. TERMS CONTAINING Y1*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM) THEN
      G =  VALASY(IOFAS+12)+CONZZ*(VALASY(IOFAS+ 6)+VALASY(IOFAS+18))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALASY(IOFAS+24)*XJJ
      ENDIF
      DO 360 JL=1,NDIMCO
      DO 360 IR=1,NDIMRO
360   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 15. TERMS CONTAINING Y1*Y1*Y3*Y3
C
      KNDEX=KNDEX+1
      G =  VALSYM(IOFSY+18)+CONZZ*(VALSYM(IOFSY+ 9)+VALSYM(IOFSY+27))
      IF (KP1 .EQ. 2) G = G + CONZZ*VALSYM(IOFSY+36)*XJJ
      DO 380 JL=1,NDIMCO
      DO 380 IR=1,NDIMRO
380   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 16. TERMS CONTAINING Y1*P1+P1*Y1
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+37)
      DO 390 JL=1,NDIMCO
      DO 390 IR=1,NDIMRO
390   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 17. TERMS CONTAINING Y3*P3+P3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+25)
      DO 400 JL=1,NDIMCO
      DO 400 IR=1,NDIMRO
400   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 18. TERMS CONTAINING Y3*P1
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+38)
      DO 410 JL=1,NDIMCO
      DO 410 IR=1,NDIMRO
410   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 19. TERMS CONTAINING Y1*P3
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+26)
      DO 420 JL=1,NDIMCO
      DO 420 IR=1,NDIMRO
420   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 20. TERMS CONTAINING Y1*Y1*P1+P1*Y1*Y1
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+39)
      DO 430 JL=1,NDIMCO
      DO 430 IR=1,NDIMRO
430   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 21. TERMS CONTAINING Y3*Y3*P3+P3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+27)
      DO 440 JL=1,NDIMCO
      DO 440 IR=1,NDIMRO
440   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 22. TERMS CONTAINING Y3*Y3*P1
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+40)
      DO 450 JL=1,NDIMCO
      DO 450 IR=1,NDIMRO
450   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 23. TERMS CONTAINING Y1*Y1*P3
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+28)
      DO 460 JL=1,NDIMCO
      DO 460 IR=1,NDIMRO
460   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 24. TERMS CONTAINING Y3*(Y1*P1+P1*Y1)
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+41)
      DO 470 JL=1,NDIMCO
      DO 470 IR=1,NDIMRO
470   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 25. TERMS CONTAINING Y1*(Y3*P3+P3*Y3)
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+29)
      DO 480 JL=1,NDIMCO
      DO 480 IR=1,NDIMRO
480   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 26. TERMS CONTAINING Y1*Y1*Y1*P1+P1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+42)
      DO 490 JL=1,NDIMCO
      DO 490 IR=1,NDIMRO
490   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 27. TERMS CONTAINING Y3*Y3*Y3*P3+P3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+30)
      DO 500 JL=1,NDIMCO
      DO 500 IR=1,NDIMRO
500   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 28. TERMS CONTAINING Y3*Y3*Y3*P1
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+43)
      DO 510 JL=1,NDIMCO
      DO 510 IR=1,NDIMRO
510   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 29. TERMS CONTAINING Y1*Y1*Y1*P3
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+31)
      DO 520 JL=1,NDIMCO
      DO 520 IR=1,NDIMRO
520   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 30. TERMS CONTAINING Y3*(Y1*Y1*P1+P1*Y1*Y1)
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+44)
      DO 530 JL=1,NDIMCO
      DO 530 IR=1,NDIMRO
530   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 31. TERMS CONTAINING Y1*(Y3*Y3*P3+P3*Y3*Y3)
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+32)
      DO 540 JL=1,NDIMCO
      DO 540 IR=1,NDIMRO
540   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 32. TERMS CONTAINING Y3*Y3*(Y1*P1+P1*Y1)
C
      KNDEX=KNDEX+1
      G =  -2.0D+00*CONZZ*VALSYM(IOFSY+45)
      DO 550 JL=1,NDIMCO
      DO 550 IR=1,NDIMRO
550   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 33. TERMS CONTAINING Y1*Y1*(Y3*P3+P3*Y3)
C
      KNDEX=KNDEX+1
      IF (.NOT.SYMM) G =  -2.0D+00*CONZZ*VALASY(IOFAS+33)
      DO 560 JL=1,NDIMCO
      DO 560 IR=1,NDIMRO
560   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                 +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
900   CONTINUE
920   CONTINUE
940   CONTINUE
      RETURN
      END
C
C
      SUBROUTINE RNPM1 ( VALSYM , VALASY , SMAT   , HMAT   ,
     1                   NOFSRO , NOFSCO , NDIMRO , NDIMCO ,
     1                   V2MP11 , V2MP12 , JP1,KKP1,KKDEL, IRODIM ,
     1                   IEO    , ITAU   , INTSYM , INTASY ,
     1                   ISTOFF , JSTOFF , NOBAL  , NOBAR  ,
     1                   NOPERS , NONESY , NONEAS ,
     1                   LREC35)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 , NFIL6 ,
     5       NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, V2MP11, V2MP12,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER LENINT,IOSC1,IOSC3,I,J,IR,JL
      REAL*8 G,GC1,GC3,GC1113,GC3133,GC1133,GC3113
      REAL*8 SMAT(NOBAL,NOBAR,NOPERS),VALSYM(INTSYM),VALASY(INTASY),
     1       HMAT(LREC35,LREC35)
      REAL*8  CONCOR,CONFC1,CONG11,CONG33,CONG13,CORHOE
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
C
      CONCOR=PLANCK*AVOGNO*1.0E+16/(1.6E+01*PI*PI*VELLGT)
      CONYZ=CONCOR
      CONXR=CONCOR
      CONCOR=-CONCOR
      SQ2=SQRT(2.0E+00)
      J=JP1-1
C
      ITAU1=ITAU
      ITAU2=1-ITAU
C
      KNDSYM=0
      IF (.NOT. SYMM) KNDASY=0
C
      DO 780 K1P1=1,JP1
      DO 770 KDEL=-1,1,2
C
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JP1) GOTO 770
      IF (K1P1 .GT. K2P1) THEN
            XJK=SQRT(DFLOAT(J*JP1-(K2P1-1)*K2P1))
      ELSE
            XJK=SQRT(DFLOAT(J*JP1-(K1P1-1)*K1P1))
      ENDIF
      IF (K1P1 .EQ. 1 .OR. K2P1 .EQ. 1) XJK=SQ2*XJK
      XXR=1.0E+00
      IF (K1P1 .LT. K2P1) XXR=-XXR
C
      DO 760 INDEX1=1,V2MP11
      DO 750 INDEX2=1,V2MP12
C
      KNDSYM=KNDSYM+1
      IOFSY=(KNDSYM-1)*NONESY
      IF (.NOT. SYMM) THEN
           KNDASY=KNDASY+1
           IOFAS=(KNDASY-1)*NONEAS
      ENDIF
      IF (K1P1 .EQ. 1 .AND. MOD(J+ITAU1,2) .NE. 0) GOTO 750
      IF (K2P1 .EQ. 1 .AND. MOD(J+ITAU2,2) .NE. 0) GOTO 750
      IF (KKP1.NE.K1P1)                            GOTO 750
      IF (KKDEL.NE.KDEL)                           GOTO 750
C
      KNDEX=0
C
      IF (MOD(K1P1,2) .NE. 0) THEN
            INDK1=(K1P1-1)/2
            IF (MOD(J+ITAU1,2) .NE. 0) INDK1=INDK1-1
      ELSE
            INDK1=(K1P1-2)/2
      ENDIF
      IF (MOD(K2P1,2) .NE. 0) THEN
            INDK2=(K2P1-1)/2
            IF (MOD(J+ITAU2,2) .NE. 0) INDK2=INDK2-1
      ELSE
            INDK2=(K2P1-2)/2
      ENDIF
      IROWOF=NOFSRO+(INDEX1-1)*NDIMRO
      ICOLOF=NOFSCO+(INDEX2-1)*NDIMCO
C
      IF (MOD(K1P1,2) .EQ. IEO) GOTO 750
C
C  1. LEADING TERM (NOT DEPENDING ON STRETCHING COORDINATES)
C
90    G   = CONXR*VALSYM(IOFSY+9)*XJK*XXR
      IF (.NOT. SYMM) G=G+CONYZ*VALASY(IOFAS+1)*XJK
C
      KNDEX=KNDEX+1
      DO 100 JL=1,NDIMCO
      DO 100 IR=1,NDIMRO
100   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  2. TERMS CONTAINING Y1
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 1)*XJK
      GXR = CONXR*VALSYM(IOFSY+10)*XJK*XXR
      DO 120 JL=1,NDIMCO
      DO 120 IR=1,NDIMRO
120   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 3. TERMS CONTAINING Y3
C
      KNDEX=KNDEX+1
      G=-G
      GXR=-GXR
      IF (.NOT. SYMM) THEN
                       G = CONYZ*VALASY(IOFAS+ 2)*XJK
                     GXR = CONXR*VALASY(IOFAS+8)*XJK*XXR
      ENDIF
      DO 140 JL=1,NDIMCO
      DO 140 IR=1,NDIMRO
140   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  4. TERMS CONTAINING Y1*Y1
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 2)*XJK
      GXR = CONXR*VALSYM(IOFSY+11)*XJK*XXR
      DO 160 JL=1,NDIMCO
      DO 160 IR=1,NDIMRO
160   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 5. TERMS CONTAINING Y3*Y3
C
      KNDEX=KNDEX+1
      G=-G
      GXR=-GXR
      IF (.NOT. SYMM) THEN
                       G = CONYZ*VALASY(IOFAS+ 3)*XJK
                     GXR = CONXR*VALASY(IOFAS+9)*XJK*XXR
      ENDIF
      DO 180 JL=1,NDIMCO
      DO 180 IR=1,NDIMRO
180   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 6. TERMS CONTAINING Y1*Y3
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 3)*XJK
      GXR = CONXR*VALSYM(IOFSY+12)*XJK*XXR
      DO 200 JL=1,NDIMCO
      DO 200 IR=1,NDIMRO
200   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  7. TERMS CONTAINING Y1*Y1*Y1
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 4)*XJK
      GXR=CONXR*VALSYM(IOFSY+13)*XJK*XXR
      DO 220 JL=1,NDIMCO
      DO 220 IR=1,NDIMRO
220   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 8. TERMS CONTAINING Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      G=-G
      GXR=-GXR
      IF (.NOT. SYMM) THEN
                      G = CONYZ*VALASY(IOFAS+ 4)*XJK
                     GXR = CONXR*VALASY(IOFAS+10)*XJK*XXR
      ENDIF
      DO 240 JL=1,NDIMCO
      DO 240 IR=1,NDIMRO
240   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  9. TERMS CONTAINING Y1*Y1*Y3
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 5)*XJK
      GXR = CONXR*VALSYM(IOFSY+14)*XJK*XXR
      DO 260 JL=1,NDIMCO
      DO 260 IR=1,NDIMRO
260   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 10. TERMS CONTAINING Y1*Y3*Y3
C
      KNDEX=KNDEX+1
      G=-G
      GXR=-GXR
      IF (.NOT. SYMM) THEN
                        G = CONYZ*VALASY(IOFAS+ 5)*XJK
                     GXR = CONXR*VALASY(IOFAS+11)*XJK*XXR
      ENDIF
      DO 280 JL=1,NDIMCO
      DO 280 IR=1,NDIMRO
280   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  11. TERMS CONTAINING Y1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 6)*XJK
      GXR = CONXR*VALSYM(IOFSY+15)*XJK*XXR
      DO 300 JL=1,NDIMCO
      DO 300 IR=1,NDIMRO
300   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 12. TERMS CONTAINING Y3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      G=-G
      GXR=-GXR
      IF (.NOT. SYMM) THEN
                        G = CONYZ*VALASY(IOFAS+ 6)*XJK
                     GXR = CONXR*VALASY(IOFAS+12)*XJK*XXR
      ENDIF
      DO 320 JL=1,NDIMCO
      DO 320 IR=1,NDIMRO
320   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  13. TERMS CONTAINING Y1*Y1*Y1*Y3
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 7)*XJK
      GXR = CONXR*VALSYM(IOFSY+16)*XJK*XXR
      DO 340 JL=1,NDIMCO
      DO 340 IR=1,NDIMRO
340   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 14. TERMS CONTAINING Y1*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      G=-G
      GXR=-GXR
      IF (.NOT. SYMM) THEN
                       G = CONYZ*VALASY(IOFAS+ 7)*XJK
                     GXR = CONXR*VALASY(IOFAS+13)*XJK*XXR
      ENDIF
      DO 360 JL=1,NDIMCO
      DO 360 IR=1,NDIMRO
360   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 15. TERMS CONTAINING Y1*Y1*Y3*Y3
C
      KNDEX=KNDEX+1
       G = CONYZ*VALSYM(IOFSY+ 8)*XJK
      GXR = CONXR*VALSYM(IOFSY+17)*XJK*XXR
      DO 380 JL=1,NDIMCO
      DO 380 IR=1,NDIMRO
380   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                  +(G+GXR)*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 16. TERMS CONTAINING Y1*P1+P1*Y1
C
      KNDEX=KNDEX+1
      G = CONCOR*XJK*XXR*VALSYM(IOFSY+18)
      DO 400 JL=1,NDIMCO
      DO 400 IR=1,NDIMRO
400   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 17. TERMS CONTAINING Y3*P3+P3*Y3
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = CONCOR*XJK*XXR*VALASY(IOFAS+15)
      DO 420 JL=1,NDIMCO
      DO 420 IR=1,NDIMRO
420   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 18. TERMS CONTAINING Y3*P1
C
      KNDEX=KNDEX+1
      G = 2.0E+00*CONCOR*XJK*XXR*VALSYM(IOFSY+19)
      DO 440 JL=1,NDIMCO
      DO 440 IR=1,NDIMRO
440   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 19. TERMS CONTAINING Y1*P3
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = 2.0E+00*CONCOR*XJK*XXR*VALASY(IOFAS+14)
      DO 460 JL=1,NDIMCO
      DO 460 IR=1,NDIMRO
460   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 20. TERMS CONTAINING Y1*Y1*P1+P1*Y1*Y1
C
      KNDEX=KNDEX+1
      G = CONCOR*XJK*XXR*VALSYM(IOFSY+20)
      DO 480 JL=1,NDIMCO
      DO 480 IR=1,NDIMRO
480   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 21. TERMS CONTAINING Y3*Y3*P3+P3*Y3*Y3
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = CONCOR*XJK*XXR*VALASY(IOFAS+17)
      DO 500 JL=1,NDIMCO
      DO 500 IR=1,NDIMRO
500   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 22. TERMS CONTAINING P1*Y3*Y3
C
      KNDEX=KNDEX+1
      G = 2.0E+00*CONCOR*XJK*XXR*VALSYM(IOFSY+21)
      DO 520 JL=1,NDIMCO
      DO 520 IR=1,NDIMRO
520   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 23. TERMS CONTAINING P3*Y1*Y1
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = 2.0E+00*CONCOR*XJK*XXR*VALASY(IOFAS+16)
      DO 540 JL=1,NDIMCO
      DO 540 IR=1,NDIMRO
540   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 24. TERMS CONTAINING (Y1*P1+P1*Y1)*Y3
C
      KNDEX=KNDEX+1
      G = CONCOR*XJK*XXR*VALSYM(IOFSY+22)
      DO 560 JL=1,NDIMCO
      DO 560 IR=1,NDIMRO
560   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 25. TERMS CONTAINING (Y3*P3+P3*Y3)*Y1
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = CONCOR*XJK*XXR*VALASY(IOFAS+18)
      DO 580 JL=1,NDIMCO
      DO 580 IR=1,NDIMRO
580   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 26. TERMS CONTAINING Y1*Y1*Y1*P1+P1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      G = CONCOR*XJK*XXR*VALSYM(IOFSY+23)
      DO 600 JL=1,NDIMCO
      DO 600 IR=1,NDIMRO
600   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 27. TERMS CONTAINING Y3*Y3*Y3*P3+P3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = CONCOR*XJK*XXR*VALASY(IOFAS+20)
      DO 620 JL=1,NDIMCO
      DO 620 IR=1,NDIMRO
620   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 28. TERMS CONTAINING P1*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      G = 2.0E+00*CONCOR*XJK*XXR*VALSYM(IOFSY+24)
      DO 640 JL=1,NDIMCO
      DO 640 IR=1,NDIMRO
640   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 29. TERMS CONTAINING P3*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = 2.0E+00*CONCOR*XJK*XXR*VALASY(IOFAS+19)
      DO 660 JL=1,NDIMCO
      DO 660 IR=1,NDIMRO
660   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 30. TERMS CONTAINING (Y1*Y1*P1+P1*Y1*Y1)*Y3
C
      KNDEX=KNDEX+1
      G = CONCOR*XJK*XXR*VALSYM(IOFSY+25)
      DO 680 JL=1,NDIMCO
      DO 680 IR=1,NDIMRO
680   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 31. TERMS CONTAINING (Y3*Y3*P3+P3*Y3*Y3)*Y1
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = CONCOR*XJK*XXR*VALASY(IOFAS+22)
      DO 700 JL=1,NDIMCO
      DO 700 IR=1,NDIMRO
700   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 32. TERMS CONTAINING (Y1*P1+P1*Y1)*Y3*Y3
C
      KNDEX=KNDEX+1
      G = CONCOR*XJK*XXR*VALSYM(IOFSY+26)
      DO 720 JL=1,NDIMCO
      DO 720 IR=1,NDIMRO
720   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 33. TERMS CONTAINING (Y3*P3+P3*Y3)*Y1*Y1
C
      KNDEX=KNDEX+1
      G = -G
      IF (.NOT. SYMM) G = CONCOR*XJK*XXR*VALASY(IOFAS+21)
      DO 740 JL=1,NDIMCO
      DO 740 IR=1,NDIMRO
740   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
750   CONTINUE
760   CONTINUE
770   CONTINUE
780   CONTINUE
      RETURN
      END
C
C
      SUBROUTINE RNPM2 ( VALSYM , VALASY , SMAT   , HMAT   ,
     1                   NOFSRO , NOFSCO , NDIMRO , NDIMCO ,
     1                   V2MP11 , V2MP12 , JP1,KKP1,KKDEL, IRODIM ,
     1                   IEO    , ITAU   , INTSYM , INTASY ,
     1                   ISTOFF , JSTOFF , NOBAL  , NOBAR  ,
     1                   NOPERS , NTWOSY , NTWOAS ,
     1                   LREC35)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 , NFIL6 ,
     5       NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1, V2MP11, V2MP12,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER LENINT,IOSC1,IOSC3,I,J,IR,JL
      REAL*8 G,GC1,GC3,GC1113,GC3133,GC1133,GC3113
      REAL*8 SMAT(NOBAL,NOBAR,NOPERS),VALSYM(INTSYM),VALASY(INTASY),
     1       HMAT(LREC35,LREC35)
      REAL*8  CONCOR,CONFC1,CONG11,CONG33,CONG13,CORHOE
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     1               F11,F33,F13,F111,F333,F113,F133,
     1               F1111,F3333,F1113,F1333,F1133,
     2               F1,F1A1,F2A1,F3A1,F4A1,F3,F1A3,F2A3,F3A3,F4A3,
     3               F1A11,F2A11,F3A11,F1A33,F2A33,F3A33,
     4               F1A13,F2A13,F3A13,
     5               F1A111,F2A111,F1A333,F2A333,
     6               F1A113,F2A113,F1A133,F2A133,
     7               FA1111,FA3333,FA1113,
     8               FA1333,FA1133, R12RF1, R32RF1, R12RF2, R32RF2,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
      COMMON /RENTEL/G1,G3,G11,G33,G13,G111,G333,G113,G133,
     1               G1111,G3333,G1113,G1333,G1133,
     2               GA1,GA2,GA3,GA4,GA5,GA6,GA7,GA8,
     2               G1A1,G2A1,G3A1,G4A1,G1A3,G2A3,G3A3,G4A3,
     3               G1A11,G2A11,G3A11,G1A33,G2A33,G3A33,
     4               G1A13,G2A13,G3A13,
     5               G1A111,G2A111,G1A333,G2A333,
     6               G1A113,G2A113,G1A133,G2A133,
     7               GA1111,GA3333,GA1113,
     8               GA1333,GA1133,
     1               HA1,HA2,HA3,HA4,HA5,HA6,HA7,HA8,
     2               H1A1,H2A1,H3A1,H4A1,H1A3,H2A3,H3A3,H4A3,
     3               H1A11,H2A11,H3A11,H1A33,H2A33,H3A33,
     4               H1A13,H2A13,H3A13,
     5               H1A111,H2A111,H1A333,H2A333,
     6               H1A113,H2A113,H1A133,H2A133,
     7               HA1111,HA3333,HA1113,
     8               HA1333,HA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMINS1 , VMINS2 , ZTRIAL(2) , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/ NSURF,  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ , NFINTA
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      include 'rensys.h'
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
C
      CONXX=-PLANCK*AVOGNO*1.0E+16/(3.2E+01*PI*PI*VELLGT)
      SQ2=SQRT(2.0E+00)
      J=JP1-1
C
      ITAU1=ITAU
      ITAU2=1-ITAU
C
      KNDSYM=0
      IF (.NOT. SYMM) KNDASY=0
C
      DO 460 K1P1=1,JP1
      DO 440 KDEL=-2,2,4
C
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JP1) GOTO 440
      IF (K1P1 .GT. K2P1) THEN
            XJK=SQRT(DFLOAT((J*JP1-(K2P1-1)*K2P1)
     G         *(J*JP1-K2P1*(K2P1+1))))
      ELSE
            XJK=SQRT(DFLOAT((J*JP1-(K1P1-1)*K1P1)
     G         *(J*JP1-K1P1*(K1P1+1))))
      ENDIF
C
      IF (K1P1 .EQ. 1 .OR. K2P1 .EQ. 1) XJK=SQ2*XJK
      DO 420 INDEX1=1,V2MP11
      DO 400 INDEX2=1,V2MP12
C
      KNDSYM=KNDSYM+1
      IOFSY=(KNDSYM-1)*NTWOSY
      IF (.NOT. SYMM) THEN
           KNDASY=KNDASY+1
           IOFAS=(KNDASY-1)*NTWOAS
      ENDIF
      IF (MOD(K1P1,2) .EQ. IEO) GOTO 400
      IF (K1P1 .EQ. 1 .AND. MOD(J+ITAU1,2) .NE. 0) GOTO 400
      IF (K2P1 .EQ. 1 .AND. MOD(J+ITAU2,2) .NE. 0) GOTO 400
      IF (K1P1.NE.KKP1)                            GOTO 400
      IF (KDEL.NE.KKDEL)                           GOTO 400
C
      KNDEX=0
C
      IF (MOD(K1P1,2) .NE. 0) THEN
            INDK1=(K1P1-1)/2
            IF (MOD(J+ITAU1,2) .NE. 0) INDK1=INDK1-1
      ELSE
            INDK1=(K1P1-2)/2
      ENDIF
      IF (MOD(K2P1,2) .NE. 0) THEN
            INDK2=(K2P1-1)/2
            IF (MOD(J+ITAU2,2) .NE. 0) INDK2=INDK2-1
      ELSE
            INDK2=(K2P1-2)/2
      ENDIF
      IROWOF=NOFSRO+(INDEX1-1)*NDIMRO
      ICOLOF=NOFSCO+(INDEX2-1)*NDIMCO
C
C  1. LEADING TERM (NOT DEPENDING ON STRETCHING COORDINATES)
C
      KNDEX=KNDEX+1
      G =  CONXX*(VALSYM(IOFSY+ 1)-VALSYM(IOFSY+10))*XJK
      DO 100 JL=1,NDIMCO
      DO 100 IR=1,NDIMRO
100   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  2. TERMS CONTAINING Y1
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 2)-VALSYM(IOFSY+11))*XJK
      DO 120 JL=1,NDIMCO
      DO 120 IR=1,NDIMRO
120   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 3. TERMS CONTAINING Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM)
     2          G = CONXX*(VALASY(IOFAS+ 1)-VALASY(IOFAS+ 7))*XJK
      DO 140 JL=1,NDIMCO
      DO 140 IR=1,NDIMRO
140   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  4. TERMS CONTAINING Y1*Y1
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 3)-VALSYM(IOFSY+12))*XJK
      DO 160 JL=1,NDIMCO
      DO 160 IR=1,NDIMRO
160   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 5. TERMS CONTAINING Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM)
     2          G = CONXX*(VALASY(IOFAS+ 2)-VALASY(IOFAS+ 8))*XJK
      DO 180 JL=1,NDIMCO
      DO 180 IR=1,NDIMRO
180   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 6. TERMS CONTAINING Y1*Y3
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 4)-VALSYM(IOFSY+13))*XJK
      DO 200 JL=1,NDIMCO
      DO 200 IR=1,NDIMRO
200   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  7. TERMS CONTAINING Y1*Y1*Y1
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 5)-VALSYM(IOFSY+14))*XJK
      DO 220 JL=1,NDIMCO
      DO 220 IR=1,NDIMRO
220   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 8. TERMS CONTAINING Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM)
     2         G = CONXX*(VALASY(IOFAS+ 3)-VALASY(IOFAS+ 9))*XJK
      DO 240 JL=1,NDIMCO
      DO 240 IR=1,NDIMRO
240   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  9. TERMS CONTAINING Y1*Y1*Y3
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 6)-VALSYM(IOFSY+15))*XJK
      DO 260 JL=1,NDIMCO
      DO 260 IR=1,NDIMRO
260   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 10. TERMS CONTAINING Y1*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM)
     2           G = CONXX*(VALASY(IOFAS+ 4)-VALASY(IOFAS+10))*XJK
      DO 280 JL=1,NDIMCO
      DO 280 IR=1,NDIMRO
280   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  11. TERMS CONTAINING Y1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 7)-VALSYM(IOFSY+16))*XJK
      DO 300 JL=1,NDIMCO
      DO 300 IR=1,NDIMRO
300   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 12. TERMS CONTAINING Y3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM)
     2           G = CONXX*(VALASY(IOFAS+ 5)-VALASY(IOFAS+11))*XJK
      DO 320 JL=1,NDIMCO
      DO 320 IR=1,NDIMRO
320   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C  13. TERMS CONTAINING Y1*Y1*Y1*Y3
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 8)-VALSYM(IOFSY+17))*XJK
      DO 340 JL=1,NDIMCO
      DO 340 IR=1,NDIMRO
340   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 14. TERMS CONTAINING Y1*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      IF (.NOT. SYMM)
     2          G = CONXX*(VALASY(IOFAS+ 6)-VALASY(IOFAS+12))*XJK
      DO 360 JL=1,NDIMCO
      DO 360 IR=1,NDIMRO
360   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
C
C 15. TERMS CONTAINING Y1*Y1*Y3*Y3
C
      KNDEX=KNDEX+1
       G = CONXX*(VALSYM(IOFSY+ 9)-VALSYM(IOFSY+18))*XJK
      DO 380 JL=1,NDIMCO
      DO 380 IR=1,NDIMRO
380   HMAT(IROWOF+IR,ICOLOF+JL)=HMAT(IROWOF+IR,ICOLOF+JL)
     1                       +G*SMAT(ISTOFF+IR,JSTOFF+JL,KNDEX)
400   CONTINUE
420   CONTINUE
440   CONTINUE
460   CONTINUE
      RETURN
      END
