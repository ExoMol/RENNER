      SUBROUTINE INTZER ( GRHO   , ROTSYM , ROTASY , VALSYM , VALASY ,
     1                    COSGM  , SINGM  , DGKDR  , AMUZZ  , AMURR  ,
     1                    PHIL   , DERL   , XMUZZ  , PHIR   , DERR   ,
     1                    AMLZ11 , AMLZ22 , AMLZ12 ,
     3                    ACCARR , SPOARR , DIPZAC,  
     1                    NFILST , NFILBN , NFILDI,
     1                    KFSYM0 , KFASY0 , KFSYMJ , KFASYJ ,
     1                    LENACC , LENASO , LENDIP,
     1                    NUMSYM , NUMASY , NZERSY , 
     1                    NZERAS , 
     1                    NDIPSY,NDIPAS,
     1                    NUSOSY , NUSOAS , NSPOSY , NSPOAS )

C
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1 ,
     5       JMAXPNS, NSTINT2
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      REAL*8 VSYMM(9,2),VASYM(6,2),DSYMM(9,2),DASYM(6,2)

      INTEGER NOBAS,MBASP1,LENIW
      INTEGER I,L,LENINT,LENREC,NPHI,INDRC ,
     1       NORECS , ILEN ,ISHFT
      REAL*8 GRHO(NSTINT), PHIL(NSTINT),
     1   AMLZ11(NSTINT) , AMLZ22(NSTINT) , AMLZ12(NSTINT) ,
     1   DERL(NSTINT),PHIR(NSTINT),DERR(NSTINT),
     1   COSGM(JMAXP1*NSTINT),SINGM(JMAXP1*NSTINT),
     1   DGKDR(JMAXP1*NSTINT),AMUZZ(NSTINT), XMUZZ(NSTINT),
     1   AMURR(NSTINT),VALSYM(KFSYM0),VALASY(KFASY0),ROTSYM(KFSYMJ),
     1   ROTASY(KFASYJ),SPOARR(LENASO)
C
      REAL*8 DIPZAC(LENDIP)
C
      REAL*8  SUM01,SUM02,SUM03,SUM04,SUM05,SUM06,SUM07,SUM08,SUM09,
     1 SUM10,SUM11,SUM12,SUM13,SUM14,SUM15,SUM16,SUM17,SUM18,SUM19,
     2 SUM20,SUM21,SUM22,SUM23,SUM24,SUM25,SUM26,SUM27,SUM28,SUM29,
     3 SUM30,SUM31,ACCARR(LENACC),DER(4),EREST(4)
      REAL*8 FACODD,FACEVE
      INTEGER INDEX1,INDEX2,
     1       IOFFS,IOFFS0,IEND,JOFFS,KOFFSO,KOFFSE,NFCT
C
      include 'isotop.h'
      include 'value.h'
      include 'lzcomp.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
      include 'equfcs.h'
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9001)
      FACODD=2.0D+00*HSTEP/3.0D+00
      FACEVE=4.0D+00*HSTEP/3.0D+00
C
C READ IN RHO-DEPENDENT FUNCTION VALUES
C
      REWIND NFIL1
      REWIND NFIL3
      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL48
      REWIND NFIL49
      READ (NFIL1) (VALSYM(L), L=1,KFSYM0)
      READ (NFIL3) (ROTSYM(L), L=1,KFSYMJ)
      READ (NFIL46) (COSGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL47) (SINGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL48) (AMUZZ(L), L=1,NSTINT)
      READ (NFIL49) (DGKDR(L), L=1,JMAXP1*NSTINT)
      IF (.NOT.SYMM) THEN
          REWIND NFIL2
          READ (NFIL2) (VALASY(L), L=1,KFASY0)
          REWIND NFIL4
          READ (NFIL4) (ROTASY(L), L=1,KFASYJ)
      ENDIF
C
C   DO TRANSFORMATIONS FROM EXPANSION IN YREF TO EXPANSION IN YE
C
      IF (SYMM) THEN
              DO 100 I=1,NSTINT
              IOFFS1=(I-1)*NFSYM0
              IOFFS2=(I-1)*NFSYMJ
C
C   TRANSFORM MURR
C
	      CALL TR15SS(VALSYM(IOFFS1+1))
C
C   TRANSFORM P1P3CY
C
	      CALL TR06SS(VALSYM(IOFFS1+27))
C
C   TRANSFORM PXMXR1+PRMRR1
C
	      CALL TR10(VALSYM(IOFFS1+31))
C
C   TRANSFORM MUXX
C
	      CALL TR15SS(ROTSYM(IOFFS2+1))
C
C   TRANSFORM MUYY
C
	      CALL TR15SS(ROTSYM(IOFFS2+10))
C
C   TRANSFORM MUZZ
C
	      CALL TR15SS(ROTSYM(IOFFS2+19))
C
C   TRANSFORM MUYZ
C
	      CALL TR15SA(ROTSYM(IOFFS2+28))
C
C   TRANSFORM MUXR
C
	      CALL TR15SA(ROTSYM(IOFFS2+37))
C
C   TRANSFORM PXMXX1+PRMXR1
C
	      CALL TR10(ROTSYM(IOFFS2+45))
C
C   TRANSFORM SPIN-ORBIT FUNCTION
C
              CALL TR15SS(VALSYM(IOFFS1+40))   
C
100           CONTINUE
       ELSE
              DO 110 I=1,NSTINT
              IOFFS1=(I-1)*NFSYM0
              IOFFS2=(I-1)*NFSYMJ
              IOFFA1=(I-1)*NFASY0
              IOFFA2=(I-1)*NFASYJ
C
C   TRANSFORM MURR
C
	      CALL TR15A(VALSYM(IOFFS1+1),VALASY(IOFFA1+1))
C
C   TRANSFORM P1P3CY
C
	      CALL TR06A(VALSYM(IOFFS1+27),VALASY(IOFFA1+19))
C
C   TRANSFORM PXMXR1+PRMRR1
C
	      CALL TR10(VALSYM(IOFFS1+31))
C
C   TRANSFORM PXMXR3+PRMRR3
C
	      CALL TR10(VALASY(IOFFA1+21))
C
C   TRANSFORM MUXX
C
	      CALL TR15A(ROTSYM(IOFFS2+1),ROTASY(IOFFA2+1))
C
C   TRANSFORM MUYY
C
	      CALL TR15A(ROTSYM(IOFFS2+10),ROTASY(IOFFA2+7))
C
C   TRANSFORM MUZZ
C
	      CALL TR15A(ROTSYM(IOFFS2+19),ROTASY(IOFFA2+13))
C
C   TRANSFORM MUYZ
C
	      CALL TR15A2(ROTASY(IOFFA2+19),ROTSYM(IOFFS2+28),
     1                    ROTASY(IOFFA2+20))
C
C   TRANSFORM MUXR
C
	      CALL TR15A(ROTSYM(IOFFS2+36),ROTASY(IOFFA2+26))
C
C   TRANSFORM PXMXX1+PRMXR1
C
	      CALL TR10(ROTSYM(IOFFS2+45))
C
C   TRANSFORM PXMXX3+PRMXR3
C
	      CALL TR10(ROTASY(IOFFA2+32))
C
C   TRANSFORM SPIN-ORBIT FUNCTION
C
              CALL TR15A(VALSYM(IOFFS1+40),VALASY(IOFFA1+30))
C
110           CONTINUE
       ENDIF
C
C CALCULATE RHO-DEPENDENT EXPECTATION VALUE FOR THE Z-COMPONENT
C OF THE ELECTRONIC ANGULAR MOMENTUM
C
      XLASQ=XLAMB*XLAMB
      DO 800 I=1,NSTINT
      VALRHO=DFLOAT(I)*HSTEP
      CORANG=1.0D+00-COS(VALRHO)
      AMURR(I)=XMURR(VALRHO)
      AMLZ11(I)=XLASQ-(((XLZ14*CORANG+XLZ13)*CORANG+XLZ12)*CORANG
     1         +XLZ11)*CORANG
      AMLZ22(I)=XLASQ-(((XLZ24*CORANG+XLZ23)*CORANG+XLZ22)*CORANG
     1         +XLZ21)*CORANG
800   AMLZ12(I)=XLAMB-(((XLZI4*CORANG+XLZI3)*CORANG+XLZI2)*CORANG
     1         +XLZI1)*CORANG
C
C
C START LOOP OVER K FOR CALCULATING DELTAK=0 MATRIX ELEMENTS
C
      NUMSYM=0
C
C   PARAMETERS FOR CALCULATING GAMMAK
C
      CONPSE=(PLANCK*AVOGNO*1.0D+16)/(8.0D+00*PI*PI*VELLGT)
      CONPS2=2.0D+00*CONPSE
C
      DO 1410 KP1=1,JMAXP1
      KVAL = KP1 - 1
      INDB=KVAL*NSTINT
      SQUAR0=DFLOAT((KP1-1)*(KP1-1))
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 1400 INDEX1=1,V2MXP1
C
      IREC1=(KP1-1)*V2MXP1+INDEX1
      READ (NFILBN,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 1200 INDEX2=1,V2MXP1
C
      IREC2=(KP1-1)*V2MXP1+INDEX2
      READ (NFILBN,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
      SUM36=0.0D+00
      SUM37=0.0D+00
      SUM38=0.0D+00
      SUM39=0.0D+00
      SUM40=0.0D+00
      SUM41=0.0D+00
      SUM42=0.0D+00
      SUM43=0.0D+00
      SUM44=0.0D+00
      SUM45=0.0D+00
      SUM46=0.0D+00
      SUM47=0.0D+00
      SUM48=0.0D+00
      SUM49=0.0D+00
      SUM50=0.0D+00
      SUM51=0.0D+00
      SUM52=0.0D+00
      SUM53=0.0D+00
      SUM54=0.0D+00
      SUM55=0.0D+00
      SUM56=0.0D+00
      SUM57=0.0D+00
      SUM58=0.0D+00
      ZUM01=0.0D+00
      ZUM02=0.0D+00
      ZUM03=0.0D+00
      ZUM04=0.0D+00
      ZUM05=0.0D+00
      ZUM06=0.0D+00
      ZUM07=0.0D+00
      ZUM08=0.0D+00
      ZUM09=0.0D+00
      SUM59=0.0D+00
      SUM60=0.0D+00
      SUM61=0.0D+00
      SUM62=0.0D+00
      SUM63=0.0D+00
      SUM64=0.0D+00
      SUM65=0.0D+00
      SUM66=0.0D+00
      SUM67=0.0D+00
      SUM68=0.0D+00
      SUM69=0.0D+00
      SUM70=0.0D+00
      SUM71=0.0D+00
      SUM72=0.0D+00
      SUM73=0.0D+00
      SUM74=0.0D+00
      SUM75=0.0D+00
      SUM76=0.0D+00
C
      DO 1100 I=1,NSTINT,2
      INDR=INDB+I
      IF (NSURF .EQ. 1) THEN
        SQUAKO=SQUAR0+AMLZ11(I)*COSGM(INDR)**2
     1               +AMLZ22(I)*SINGM(INDR)**2
     1        +4.0D+00*AMLZ12(I)*SINGM(INDR)*COSGM(INDR)*(KP1-1)
        SQUAKE=SQUAR0+AMLZ11(I+1)*COSGM(INDR+1)**2
     1               +AMLZ22(I+1)*SINGM(INDR+1)**2
     1        +4.0D+00*AMLZ12(I+1)*SINGM(INDR+1)*COSGM(INDR+1)*(KP1-1)
	SQUALO=AMUZZ(I)*(SQUAR0+XLASQ
     1        +4.0D+00*XLAMB*SINGM(INDR)*COSGM(INDR)*(KP1-1))
	SQUALE=AMUZZ(I+1)*(SQUAR0+XLASQ
     1        +4.0D+00*XLAMB*SINGM(INDR+1)*COSGM(INDR+1)*(KP1-1))
        SOO=-2.0D+00*COSGM(INDR)*SINGM(INDR)*AMLZ12(I)
        SOE=-2.0D+00*COSGM(INDR+1)*SINGM(INDR+1)*AMLZ12(I+1)
      ELSE
        SQUAKO=SQUAR0+AMLZ22(I)*COSGM(INDR)**2
     1               +AMLZ11(I)*SINGM(INDR)**2
     1        -4.0D+00*AMLZ12(I)*SINGM(INDR)*COSGM(INDR)*(KP1-1)
        SQUAKE=SQUAR0+AMLZ22(I+1)*COSGM(INDR+1)**2
     1               +AMLZ11(I+1)*SINGM(INDR+1)**2
     1        -4.0D+00*AMLZ12(I+1)*SINGM(INDR+1)*COSGM(INDR+1)*(KP1-1)
	SQUALO=AMUZZ(I)*(SQUAR0+XLASQ
     1        -4.0D+00*XLAMB*SINGM(INDR)*COSGM(INDR)*(KP1-1))
	SQUALE=AMUZZ(I+1)*(SQUAR0+XLASQ
     1        -4.0D+00*XLAMB*SINGM(INDR+1)*COSGM(INDR+1)*(KP1-1))
        SOO= 2.0D+00*COSGM(INDR)*SINGM(INDR)*AMLZ12(I)
        SOE= 2.0D+00*COSGM(INDR+1)*SINGM(INDR+1)*AMLZ12(I+1)
      ENDIF
      FO1=COSGM(INDR)**2-SINGM(INDR)**2
      FE1=COSGM(INDR+1)**2-SINGM(INDR+1)**2
      IOFFS1=(I-1)*NFSYM0
      IOFFS2=(I-1)*NFSYMJ
      IOFFA1=(I-1)*NFASY0
      DO 833 IPT=1,2
      IOFFSS=IOFFS1+(IPT-1)*NFSYM0
      IOFFAA=IOFFA1+(IPT-1)*NFASY0
      VSYMM(1,IPT)=VALSYM(IOFFSS+10)
      IF (NSURF .EQ. 1) THEN
             DSYMM(1,IPT)=VALSYM(IOFFSS+48+1)*COSGM(INDR+IPT-1)**2
     1                   +VALSYM(IOFFSS+57+1)*SINGM(INDR+IPT-1)**2
             DO 826 LL=2,9
             DSYMM(LL,IPT)=VALSYM(IOFFSS+48+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+57+LL)*SINGM(INDR+IPT-1)**2
826          VSYMM(LL,IPT)=VALSYM(IOFFSS+ 9+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+17+LL)*SINGM(INDR+IPT-1)**2
      ELSE
             DSYMM(1,IPT)=VALSYM(IOFFSS+57+1)*COSGM(INDR+IPT-1)**2
     1                   +VALSYM(IOFFSS+48+1)*SINGM(INDR+IPT-1)**2
             DO 827 LL=2,9
             DSYMM(LL,IPT)=VALSYM(IOFFSS+57+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+48+LL)*SINGM(INDR+IPT-1)**2
827          VSYMM(LL,IPT)=VALSYM(IOFFSS+17+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+ 9+LL)*SINGM(INDR+IPT-1)**2
      ENDIF
      IF (.NOT.SYMM) THEN
      IF (NSURF .EQ. 1) THEN
             DO 828 LL=1,6
             DASYM(LL,IPT)=VALASY(IOFFAA+35+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+41+LL)*SINGM(INDR+IPT-1)**2
828          VASYM(LL,IPT)=VALASY(IOFFAA+ 6+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+12+LL)*SINGM(INDR+IPT-1)**2
      ELSE
             DO 829 LL=1,6
             DASYM(LL,IPT)=VALASY(IOFFAA+41+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+35+LL)*SINGM(INDR+IPT-1)**2
829          VASYM(LL,IPT)=VALASY(IOFFAA+12+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+ 6+LL)*SINGM(INDR+IPT-1)**2
      ENDIF
      ENDIF
      IF (SYMM) THEN
	   CALL TR15SS(VSYMM(1,IPT))
	   CALL TR15SA(DSYMM(1,IPT))
      ELSE
	   CALL TR15A(VSYMM(1,IPT),VASYM(1,IPT))
	   CALL TR15A(DSYMM(1,IPT),DASYM(1,IPT))
      ENDIF
C
      DO 831 LL=1,9
831   VSYMM(LL,IPT)=VSYMM(LL,IPT)+CONPSE*VALSYM(IOFFSS+LL)
     1             *DGKDR(INDR+IPT-1)**2
833   CONTINUE
C
      SUM01=SUM01+FACODD*(VALSYM(IOFFS1+ 1)-AMURR(I))
     1           *(DERL(I  )*DERR(I  )+GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*(VALSYM(IOFFS1+ 1+NFSYM0)-AMURR(I+1))
     1           *(DERL(I+1)*DERR(I+1)+GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM02=SUM02+FACODD*VALSYM(IOFFS1+ 2)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 2+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM03=SUM03+FACODD*VALSYM(IOFFS1+ 3)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 3+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM04=SUM04+FACODD*VALSYM(IOFFS1+ 4)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 4+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM05=SUM05+FACODD*VALSYM(IOFFS1+ 5)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 5+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM06=SUM06+FACODD*VALSYM(IOFFS1+ 6)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 6+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM07=SUM07+FACODD*VALSYM(IOFFS1+ 7)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 7+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM08=SUM08+FACODD*VALSYM(IOFFS1+ 8)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 8+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM09=SUM09+FACODD*VALSYM(IOFFS1+ 9)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALSYM(IOFFS1+ 9+NFSYM0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM10=SUM10+FACODD*PHIL(I  )*VSYMM(1,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(1,2)*PHIR(I+1)
      SUM11=SUM11+FACODD*PHIL(I  )*VSYMM(2,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(2,2)*PHIR(I+1)
      SUM12=SUM12+FACODD*PHIL(I  )*VSYMM(3,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(3,2)*PHIR(I+1)
      SUM13=SUM13+FACODD*PHIL(I  )*VSYMM(4,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(4,2)*PHIR(I+1)
      SUM14=SUM14+FACODD*PHIL(I  )*VSYMM(5,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(5,2)*PHIR(I+1)
      SUM15=SUM15+FACODD*PHIL(I  )*VSYMM(6,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(6,2)*PHIR(I+1)
      SUM16=SUM16+FACODD*PHIL(I  )*VSYMM(7,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(7,2)*PHIR(I+1)
      SUM17=SUM17+FACODD*PHIL(I  )*VSYMM(8,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(8,2)*PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*VSYMM(9,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VSYMM(9,2)*PHIR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*VALSYM(IOFFS1+27)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+27+NFSYM0)*PHIR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*VALSYM(IOFFS1+28)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+28+NFSYM0)*PHIR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*VALSYM(IOFFS1+29)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+29+NFSYM0)*PHIR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*VALSYM(IOFFS1+30)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+30+NFSYM0)*PHIR(I+1)
      SUM23=SUM23+FACODD*PHIL(I  )*VALSYM(IOFFS1+31)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+31+NFSYM0)*DERR(I+1)
      SUM24=SUM24+FACODD*PHIL(I  )*VALSYM(IOFFS1+32)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+32+NFSYM0)*DERR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*VALSYM(IOFFS1+33)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+33+NFSYM0)*DERR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*VALSYM(IOFFS1+34)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+34+NFSYM0)*DERR(I+1)
      SUM27=SUM27+FACODD*PHIL(I  )*VALSYM(IOFFS1+35)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+35+NFSYM0)*DERR(I+1)
      SUM28=SUM28+FACODD*PHIL(I  )*VALSYM(IOFFS1+36)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+36+NFSYM0)*DERR(I+1)
      SUM29=SUM29+FACODD*PHIL(I  )*VALSYM(IOFFS1+37)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+37+NFSYM0)*DERR(I+1)
      SUM30=SUM30+FACODD*PHIL(I  )*VALSYM(IOFFS1+38)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+38+NFSYM0)*DERR(I+1)
      SUM31=SUM31+FACODD*PHIL(I  )*VALSYM(IOFFS1+39)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALSYM(IOFFS1+39+NFSYM0)*DERR(I+1)
      SUM32=SUM32+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 1+NFSYMJ)*PHIR(I+1)
      SUM33=SUM33+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 2)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 2+NFSYMJ)*PHIR(I+1)
      SUM34=SUM34+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 3)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 3+NFSYMJ)*PHIR(I+1)
      SUM35=SUM35+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 4)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 4+NFSYMJ)*PHIR(I+1)
      SUM36=SUM36+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 5)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 5+NFSYMJ)*PHIR(I+1)
      SUM37=SUM37+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 6)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 6+NFSYMJ)*PHIR(I+1)
      SUM38=SUM38+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 7)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 7+NFSYMJ)*PHIR(I+1)
      SUM39=SUM39+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 8)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 8+NFSYMJ)*PHIR(I+1)
      SUM40=SUM40+FACODD*PHIL(I  )*ROTSYM(IOFFS2+ 9)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+ 9+NFSYMJ)*PHIR(I+1)
      SUM41=SUM41+FACODD*PHIL(I  )*ROTSYM(IOFFS2+10)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+10+NFSYMJ)*PHIR(I+1)
      SUM42=SUM42+FACODD*PHIL(I  )*ROTSYM(IOFFS2+11)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+11+NFSYMJ)*PHIR(I+1)
      SUM43=SUM43+FACODD*PHIL(I  )*ROTSYM(IOFFS2+12)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+12+NFSYMJ)*PHIR(I+1)
      SUM44=SUM44+FACODD*PHIL(I  )*ROTSYM(IOFFS2+13)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+13+NFSYMJ)*PHIR(I+1)
      SUM45=SUM45+FACODD*PHIL(I  )*ROTSYM(IOFFS2+14)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+14+NFSYMJ)*PHIR(I+1)
      SUM46=SUM46+FACODD*PHIL(I  )*ROTSYM(IOFFS2+15)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+15+NFSYMJ)*PHIR(I+1)
      SUM47=SUM47+FACODD*PHIL(I  )*ROTSYM(IOFFS2+16)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+16+NFSYMJ)*PHIR(I+1)
      SUM48=SUM48+FACODD*PHIL(I  )*ROTSYM(IOFFS2+17)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+17+NFSYMJ)*PHIR(I+1)
      SUM49=SUM49+FACODD*PHIL(I  )*ROTSYM(IOFFS2+18)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS2+18+NFSYMJ)*PHIR(I+1)
      SUM50=SUM50+FACODD*PHIL(I  )*(SQUAKO*ROTSYM(IOFFS2+19)
     1            -SQUALO)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*(SQUAKE
     2          *ROTSYM(IOFFS2+19+NFSYMJ)-SQUALE)*PHIR(I+1)
      SUM51=SUM51+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+20)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+20+NFSYMJ)
     2          *PHIR(I+1)
      SUM52=SUM52+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+21)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+21+NFSYMJ)
     2          *PHIR(I+1)
      SUM53=SUM53+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+22)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+22+NFSYMJ)
     2          *PHIR(I+1)
      SUM54=SUM54+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+23)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+23+NFSYMJ)
     2          *PHIR(I+1)
      SUM55=SUM55+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+24)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+24+NFSYMJ)
     2          *PHIR(I+1)
      SUM56=SUM56+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+25)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+25+NFSYMJ)
     2          *PHIR(I+1)
      SUM57=SUM57+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+26)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+26+NFSYMJ)
     2          *PHIR(I+1)
      SUM58=SUM58+FACODD*PHIL(I  )*SQUAKO*ROTSYM(IOFFS2+27)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTSYM(IOFFS2+27+NFSYMJ)
     2          *PHIR(I+1)
      IF (KP1 .EQ. 2) THEN
      ZUM01=ZUM01+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 1       )-ROTSYM(IOFFS2+10       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 1+NFSYMJ)-ROTSYM(IOFFS2+10+NFSYMJ))
      ZUM02=ZUM02+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 2       )-ROTSYM(IOFFS2+11       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 2+NFSYMJ)-ROTSYM(IOFFS2+11+NFSYMJ))
      ZUM03=ZUM03+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 3       )-ROTSYM(IOFFS2+12       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 3+NFSYMJ)-ROTSYM(IOFFS2+12+NFSYMJ))
      ZUM04=ZUM04+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 4       )-ROTSYM(IOFFS2+13       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 4+NFSYMJ)-ROTSYM(IOFFS2+13+NFSYMJ))
      ZUM05=ZUM05+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 5       )-ROTSYM(IOFFS2+14       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 5+NFSYMJ)-ROTSYM(IOFFS2+14+NFSYMJ))
      ZUM06=ZUM06+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 6       )-ROTSYM(IOFFS2+15       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 6+NFSYMJ)-ROTSYM(IOFFS2+15+NFSYMJ))
      ZUM07=ZUM07+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 7       )-ROTSYM(IOFFS2+16       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 7+NFSYMJ)-ROTSYM(IOFFS2+16+NFSYMJ))
      ZUM08=ZUM08+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 8       )-ROTSYM(IOFFS2+17       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 8+NFSYMJ)-ROTSYM(IOFFS2+17+NFSYMJ))
      ZUM09=ZUM09+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTSYM(IOFFS2+ 9       )-ROTSYM(IOFFS2+18       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTSYM(IOFFS2+ 9+NFSYMJ)-ROTSYM(IOFFS2+18+NFSYMJ))
      ENDIF
      SUM59=SUM59+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+40)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+40+NFSYM0)*PHIR(I+1)
      SUM60=SUM60+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+41)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+41+NFSYM0)*PHIR(I+1)
      SUM61=SUM61+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+42)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+42+NFSYM0)*PHIR(I+1)
      SUM62=SUM62+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+43)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+43+NFSYM0)*PHIR(I+1)
      SUM63=SUM63+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+44)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+44+NFSYM0)*PHIR(I+1)
      SUM64=SUM64+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+45)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+45+NFSYM0)*PHIR(I+1)
      SUM65=SUM65+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+46)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+46+NFSYM0)*PHIR(I+1)
      SUM66=SUM66+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+47)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+47+NFSYM0)*PHIR(I+1)
      SUM67=SUM67+FACODD*SOO*PHIL(I)*VALSYM(IOFFS1+48)*PHIR(I)+
     1      FACEVE*SOE*PHIL(I+1)*VALSYM(IOFFS1+48+NFSYM0)*PHIR(I+1)
      SUM68=SUM68+FACODD*PHIL(I  )*DSYMM(1,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(1,2)*PHIR(I+1)
      SUM69=SUM69+FACODD*PHIL(I  )*DSYMM(2,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(2,2)*PHIR(I+1)
      SUM70=SUM70+FACODD*PHIL(I  )*DSYMM(3,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(3,2)*PHIR(I+1)
      SUM71=SUM71+FACODD*PHIL(I  )*DSYMM(4,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(4,2)*PHIR(I+1)
      SUM72=SUM72+FACODD*PHIL(I  )*DSYMM(5,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(5,2)*PHIR(I+1)
      SUM73=SUM73+FACODD*PHIL(I  )*DSYMM(6,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(6,2)*PHIR(I+1)
      SUM74=SUM74+FACODD*PHIL(I  )*DSYMM(7,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(7,2)*PHIR(I+1)
      SUM75=SUM75+FACODD*PHIL(I  )*DSYMM(8,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(8,2)*PHIR(I+1)
      SUM76=SUM76+FACODD*PHIL(I  )*DSYMM(9,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DSYMM(9,2)*PHIR(I+1)
1100  CONTINUE
      IF (INDEX1 .EQ. INDEX2) THEN
             SUM12 = SUM12 - W11
             SUM13 = SUM13 - W13
             SUM14 = SUM14 - W111
             SUM15 = SUM15 - W113
             SUM16 = SUM16 - W1111
             SUM17 = SUM17 - W1113
             SUM18 = SUM18 - W1133
      ENDIF
      NUMSYM=NUMSYM+1
      IOFFS=(NUMSYM-1)*NZERSY
      IOFSO=(NUMSYM-1)*NSPOSY
      IOFDI=(NUMSYM-1)*NDIPSY
      ACCARR(IOFFS+ 1)=SUM01
      ACCARR(IOFFS+ 2)=SUM02
      ACCARR(IOFFS+ 3)=SUM03
      ACCARR(IOFFS+ 4)=SUM04
      ACCARR(IOFFS+ 5)=SUM05
      ACCARR(IOFFS+ 6)=SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
      ACCARR(IOFFS+23)=SUM23
      ACCARR(IOFFS+24)=SUM24
      ACCARR(IOFFS+25)=SUM25
      ACCARR(IOFFS+26)=SUM26
      ACCARR(IOFFS+27)=SUM27
      ACCARR(IOFFS+28)=SUM28
      ACCARR(IOFFS+29)=SUM29
      ACCARR(IOFFS+30)=SUM30
      ACCARR(IOFFS+31)=SUM31
      ACCARR(IOFFS+32)=SUM32
      ACCARR(IOFFS+33)=SUM33
      ACCARR(IOFFS+34)=SUM34
      ACCARR(IOFFS+35)=SUM35
      ACCARR(IOFFS+36)=SUM36
      ACCARR(IOFFS+37)=SUM37
      ACCARR(IOFFS+38)=SUM38
      ACCARR(IOFFS+39)=SUM39
      ACCARR(IOFFS+40)=SUM40
      ACCARR(IOFFS+41)=SUM41
      ACCARR(IOFFS+42)=SUM42
      ACCARR(IOFFS+43)=SUM43
      ACCARR(IOFFS+44)=SUM44
      ACCARR(IOFFS+45)=SUM45
      ACCARR(IOFFS+46)=SUM46
      ACCARR(IOFFS+47)=SUM47
      ACCARR(IOFFS+48)=SUM48
      ACCARR(IOFFS+49)=SUM49
      ACCARR(IOFFS+50)=SUM50
      ACCARR(IOFFS+51)=SUM51
      ACCARR(IOFFS+52)=SUM52
      ACCARR(IOFFS+53)=SUM53
      ACCARR(IOFFS+54)=SUM54
      ACCARR(IOFFS+55)=SUM55
      ACCARR(IOFFS+56)=SUM56
      ACCARR(IOFFS+57)=SUM57
      ACCARR(IOFFS+58)=SUM58
      ACCARR(IOFFS+59)=ZUM01
      ACCARR(IOFFS+60)=ZUM02
      ACCARR(IOFFS+61)=ZUM03
      ACCARR(IOFFS+62)=ZUM04
      ACCARR(IOFFS+63)=ZUM05
      ACCARR(IOFFS+64)=ZUM06
      ACCARR(IOFFS+65)=ZUM07
      ACCARR(IOFFS+66)=ZUM08
      ACCARR(IOFFS+67)=ZUM09
      SPOARR(IOFSO+1)=SUM59
      SPOARR(IOFSO+2)=SUM60
      SPOARR(IOFSO+3)=SUM61
      SPOARR(IOFSO+4)=SUM62
      SPOARR(IOFSO+5)=SUM63
      SPOARR(IOFSO+6)=SUM64
      SPOARR(IOFSO+7)=SUM65
      SPOARR(IOFSO+8)=SUM66
      SPOARR(IOFSO+9)=SUM67
C
      DIPZAC(IOFDI+1)=SUM68
      DIPZAC(IOFDI+2)=SUM69
      DIPZAC(IOFDI+3)=SUM70
      DIPZAC(IOFDI+4)=SUM71
      DIPZAC(IOFDI+5)=SUM72
      DIPZAC(IOFDI+6)=SUM73
      DIPZAC(IOFDI+7)=SUM74
      DIPZAC(IOFDI+8)=SUM75
      DIPZAC(IOFDI+9)=SUM76
C
1200  CONTINUE
1400  CONTINUE
1410  CONTINUE
      IDUMMY=NUMSYM
      NUMSYM=NUMSYM*NZERSY
      NUSOSY=IDUMMY*NSPOSY
      NUDISY=IDUMMY*NDIPSY 
      WRITE (NFILST) (ACCARR(L), L=1,NUMSYM)
      WRITE (NFIL29) (SPOARR(L), L=1,NUSOSY)
      WRITE (NFILDI) (DIPZAC(L), L=1,NUDISY)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9002)
      IF (SYMM) RETURN
      IOFFS0=NFSYM0*V2MXP1*V2MXP1
C
C*********************************************************************
C
C THIS IS THE END OF THE CALCULATION FOR THE SYMMETRICAL MOLECULE.
C WE NOW CALCULATE INTEGRALS FOR THE UNSYMMETRICAL CASE.
C
C*********************************************************************
C
C START LOOP OVER K FOR CALCULATING THE DELTAK=0 MATRIX ELEMENTS
C
      NUMASY=0
      DO 2810 KP1=1,JMAXP1
      KVAL = KP1 - 1
      INDB=KVAL*NSTINT
      SQUAR0=DFLOAT((KP1-1)*(KP1-1))                   
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 2800 INDEX1=1,V2MXP1
C
      IREC1=(KP1-1)*V2MXP1+INDEX1
      READ (NFILBN,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 2600 INDEX2=1,V2MXP1
      IREC2=(KP1-1)*V2MXP1+INDEX2
      READ (NFILBN,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
      SUM36=0.0D+00
      SUM37=0.0D+00
      SUM38=0.0D+00
      SUM39=0.0D+00
      SUM40=0.0D+00
      SUM41=0.0D+00
      ZUM01=0.0D+00
      ZUM02=0.0D+00
      ZUM03=0.0D+00
      ZUM04=0.0D+00
      ZUM05=0.0D+00
      ZUM06=0.0D+00
      SUM42=0.0D+00
      SUM43=0.0D+00
      SUM44=0.0D+00
      SUM45=0.0D+00
      SUM46=0.0D+00
      SUM47=0.0D+00
      SUM48=0.0D+00
      SUM49=0.0D+00
      SUM50=0.0D+00
      SUM51=0.0D+00
      SUM52=0.0D+00
      SUM53=0.0D+00
  
C
      DO 2500 I=1,NSTINT,2
      INDR=INDB+I
      IOFFS1=(I-1)*NFSYM0
      IOFFS2=(I-1)*NFSYMJ
      IOFFA1=(I-1)*NFASY0
      IOFFA2=(I-1)*NFASYJ
      IF (NSURF .EQ. 1) THEN
        SQUAKO=SQUAR0+AMLZ11(I)*COSGM(INDR)**2
     1               +AMLZ22(I)*SINGM(INDR)**2
     1        +4.0D+00*AMLZ12(I)*SINGM(INDR)*COSGM(INDR)*(KP1-1)
        SQUAKE=SQUAR0+AMLZ11(I+1)*COSGM(INDR+1)**2
     1               +AMLZ22(I+1)*SINGM(INDR+1)**2
     1        +4.0D+00*AMLZ12(I+1)*SINGM(INDR+1)*COSGM(INDR+1)*(KP1-1)
        SOO=-2.0D+00*COSGM(INDR)*SINGM(INDR)*AMLZ12(I)
        SOE=-2.0D+00*COSGM(INDR+1)*SINGM(INDR+1)*AMLZ12(I+1)
      ELSE
        SQUAKO=SQUAR0+AMLZ22(I)*COSGM(INDR)**2
     1               +AMLZ11(I)*SINGM(INDR)**2
     1        -4.0D+00*AMLZ12(I)*SINGM(INDR)*COSGM(INDR)*(KP1-1)
        SQUAKE=SQUAR0+AMLZ22(I+1)*COSGM(INDR+1)**2
     1               +AMLZ11(I+1)*SINGM(INDR+1)**2
     1        -4.0D+00*AMLZ12(I+1)*SINGM(INDR+1)*COSGM(INDR+1)*(KP1-1)
        SOO= 2.0D+00*COSGM(INDR)*SINGM(INDR)*AMLZ12(I)
        SOE= 2.0D+00*COSGM(INDR+1)*SINGM(INDR+1)*AMLZ12(I+1)
      ENDIF
      FO1=COSGM(INDR)**2-SINGM(INDR)**2
      FE1=COSGM(INDR+1)**2-SINGM(INDR+1)**2
      DO 933 IPT=1,2
      IOFFSS=IOFFS1+(IPT-1)*NFSYM0
      IOFFAA=IOFFA1+(IPT-1)*NFASY0
      VSYMM(1,IPT)=VALSYM(IOFFSS+10)
      IF (NSURF .EQ. 1) THEN
             DSYMM(1,IPT)=VALSYM(IOFFSS+48+1)*COSGM(INDR+IPT-1)**2
     1                   +VALSYM(IOFFSS+57+1)*SINGM(INDR+IPT-1)**2
             DO 926 LL=2,9
             DSYMM(LL,IPT)=VALSYM(IOFFSS+48+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+57+LL)*SINGM(INDR+IPT-1)**2
926          VSYMM(LL,IPT)=VALSYM(IOFFSS+ 9+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+17+LL)*SINGM(INDR+IPT-1)**2
      ELSE
             DSYMM(1,IPT)=VALSYM(IOFFSS+57+1)*COSGM(INDR+IPT-1)**2
     1                   +VALSYM(IOFFSS+48+1)*SINGM(INDR+IPT-1)**2
             DO 927 LL=2,9
             DSYMM(LL,IPT)=VALSYM(IOFFSS+57+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+48+LL)*SINGM(INDR+IPT-1)**2
927          VSYMM(LL,IPT)=VALSYM(IOFFSS+17+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALSYM(IOFFSS+ 9+LL)*SINGM(INDR+IPT-1)**2
      ENDIF
      IF (NSURF .EQ. 1) THEN
             DO 928 LL=1,6
             DASYM(LL,IPT)=VALASY(IOFFAA+35+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+41+LL)*SINGM(INDR+IPT-1)**2
928          VASYM(LL,IPT)=VALASY(IOFFAA+ 6+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+12+LL)*SINGM(INDR+IPT-1)**2
      ELSE
             DO 929 LL=1,6
             DASYM(LL,IPT)=VALASY(IOFFAA+41+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+35+LL)*SINGM(INDR+IPT-1)**2
929          VASYM(LL,IPT)=VALASY(IOFFAA+12+LL)*COSGM(INDR+IPT-1)**2
     1                    +VALASY(IOFFAA+ 6+LL)*SINGM(INDR+IPT-1)**2
      ENDIF
      CALL TR15A(VSYMM(1,IPT),VASYM(1,IPT))
      CALL TR15A(DSYMM(1,IPT),DASYM(1,IPT))
C
      DO 932 LL=1,6
932   VASYM(LL,IPT)=VASYM(LL,IPT)+CONPSE*VALASY(IOFFAA+LL)
     1             *DGKDR(INDR+IPT-1)**2
933   CONTINUE
C
      SUM01=SUM01+FACODD*VALASY(IOFFA1+ 1)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 1+NFASY0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM02=SUM02+FACODD*VALASY(IOFFA1+ 2)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 2+NFASY0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM03=SUM03+FACODD*VALASY(IOFFA1+ 3)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 3+NFASY0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM04=SUM04+FACODD*VALASY(IOFFA1+ 4)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 4+NFASY0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM05=SUM05+FACODD*VALASY(IOFFA1+ 5)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 5+NFASY0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM06=SUM06+FACODD*VALASY(IOFFA1+ 6)*(DERL(I  )*DERR(I  )
     1                          +GRHO(I  )*PHIL(I  )*PHIR(I  ))
     2          +FACEVE*VALASY(IOFFA1+ 6+NFASY0)*(DERL(I+1)*DERR(I+1)
     3                          +GRHO(I+1)*PHIL(I+1)*PHIR(I+1))
      SUM07=SUM07+FACODD*PHIL(I  )*VASYM(1,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(1,2)*PHIR(I+1)
      SUM08=SUM08+FACODD*PHIL(I  )*VASYM(2,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(2,2)*PHIR(I+1)
      SUM09=SUM09+FACODD*PHIL(I  )*VASYM(3,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(3,2)*PHIR(I+1)
      SUM10=SUM10+FACODD*PHIL(I  )*VASYM(4,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(4,2)*PHIR(I+1)
      SUM11=SUM11+FACODD*PHIL(I  )*VASYM(5,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(5,2)*PHIR(I+1)
      SUM12=SUM12+FACODD*PHIL(I  )*VASYM(6,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VASYM(6,2)*PHIR(I+1)
      SUM13=SUM13+FACODD*PHIL(I  )*VALASY(IOFFA1+19)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+19+NFASY0)*PHIR(I+1)
      SUM14=SUM14+FACODD*PHIL(I  )*VALASY(IOFFA1+20)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+20+NFASY0)*PHIR(I+1)
      SUM15=SUM15+FACODD*PHIL(I  )*VALASY(IOFFA1+21)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+21+NFASY0)*DERR(I+1)
      SUM16=SUM16+FACODD*PHIL(I  )*VALASY(IOFFA1+22)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+22+NFASY0)*DERR(I+1)
      SUM17=SUM17+FACODD*PHIL(I  )*VALASY(IOFFA1+23)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+23+NFASY0)*DERR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*VALASY(IOFFA1+24)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+24+NFASY0)*DERR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*VALASY(IOFFA1+25)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+25+NFASY0)*DERR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*VALASY(IOFFA1+26)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+26+NFASY0)*DERR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*VALASY(IOFFA1+27)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+27+NFASY0)*DERR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*VALASY(IOFFA1+28)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+28+NFASY0)*DERR(I+1)
      SUM23=SUM23+FACODD*PHIL(I  )*VALASY(IOFFA1+29)*DERR(I  )
     1          +FACEVE*PHIL(I+1)*VALASY(IOFFA1+29+NFASY0)*DERR(I+1)
      SUM24=SUM24+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 1+NFASYJ)*PHIR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 2)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 2+NFASYJ)*PHIR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 3)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 3+NFASYJ)*PHIR(I+1)
      SUM27=SUM27+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 4)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 4+NFASYJ)*PHIR(I+1)
      SUM28=SUM28+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 5)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 5+NFASYJ)*PHIR(I+1)
      SUM29=SUM29+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 6)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 6+NFASYJ)*PHIR(I+1)
      SUM30=SUM30+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 7)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 7+NFASYJ)*PHIR(I+1)
      SUM31=SUM31+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 8)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 8+NFASYJ)*PHIR(I+1)
      SUM32=SUM32+FACODD*PHIL(I  )*ROTASY(IOFFA2+ 9)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+ 9+NFASYJ)*PHIR(I+1)
      SUM33=SUM33+FACODD*PHIL(I  )*ROTASY(IOFFA2+10)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+10+NFASYJ)*PHIR(I+1)
      SUM34=SUM34+FACODD*PHIL(I  )*ROTASY(IOFFA2+11)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+11+NFASYJ)*PHIR(I+1)
      SUM35=SUM35+FACODD*PHIL(I  )*ROTASY(IOFFA2+12)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFA2+12+NFASYJ)*PHIR(I+1)
      SUM36=SUM36+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+13)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+13+NFASYJ)
     2          *PHIR(I+1)
      SUM37=SUM37+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+14)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+14+NFASYJ)
     2          *PHIR(I+1)
      SUM38=SUM38+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+15)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+15+NFASYJ)
     2          *PHIR(I+1)
      SUM39=SUM39+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+16)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+16+NFASYJ)
     2          *PHIR(I+1)
      SUM40=SUM40+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+17)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+17+NFASYJ)
     2          *PHIR(I+1)
      SUM41=SUM41+FACODD*PHIL(I  )*SQUAKO*ROTASY(IOFFA2+18)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*SQUAKE*ROTASY(IOFFA2+18+NFASYJ)
     2          *PHIR(I+1)
      IF (KP1 .EQ. 2) THEN
      ZUM01=ZUM01+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 1       )-ROTASY(IOFFA2+ 7       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 1+NFASYJ)-ROTASY(IOFFA2+ 7+NFASYJ))
      ZUM02=ZUM02+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 2       )-ROTASY(IOFFA2+ 8       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 2+NFASYJ)-ROTASY(IOFFA2+ 8+NFASYJ))
      ZUM03=ZUM03+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 3       )-ROTASY(IOFFA2+ 9       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 3+NFASYJ)-ROTASY(IOFFA2+ 9+NFASYJ))
      ZUM04=ZUM04+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 4       )-ROTASY(IOFFA2+10       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 4+NFASYJ)-ROTASY(IOFFA2+10+NFASYJ))
      ZUM05=ZUM05+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 5       )-ROTASY(IOFFA2+11       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 5+NFASYJ)-ROTASY(IOFFA2+11+NFASYJ))
      ZUM06=ZUM06+FACODD*FO1*PHIL(I  )*PHIR(I  )
     1           *(ROTASY(IOFFA2+ 6       )-ROTASY(IOFFA2+12       ))
     1          +FACEVE*FE1*PHIL(I+1)*PHIR(I+1)
     1           *(ROTASY(IOFFA2+ 6+NFASYJ)-ROTASY(IOFFA2+12+NFASYJ))
      ENDIF
      SUM42=SUM42+FACODD*PHIL(I)*SOO*VALASY(IOFFA1+30)*PHIR(I)
     1          +FACEVE*SOE*PHIL(I+1)*VALASY(IOFFA1+30+NFASY0)
     2          *PHIR(I+1)
      SUM43=SUM43+FACODD*PHIL(I)*SOO*VALASY(IOFFA1+31)*PHIR(I)
     1          +FACEVE*SOE*PHIL(I+1)*VALASY(IOFFA1+31+NFASY0)
     2          *PHIR(I+1)
      SUM44=SUM44+FACODD*PHIL(I)*SOO*VALASY(IOFFA1+32)*PHIR(I)
     1          +FACEVE*SOE*PHIL(I+1)*VALASY(IOFFA1+32+NFASY0)
     2          *PHIR(I+1)
      SUM45=SUM45+FACODD*PHIL(I)*SOO*VALASY(IOFFA1+33)*PHIR(I)
     1          +FACEVE*SOE*PHIL(I+1)*VALASY(IOFFA1+33+NFASY0)
     2          *PHIR(I+1)
      SUM46=SUM46+FACODD*PHIL(I)*SOO*VALASY(IOFFA1+34)*PHIR(I)
     1          +FACEVE*SOE*PHIL(I+1)*VALASY(IOFFA1+34+NFASY0)
     2          *PHIR(I+1)
      SUM47=SUM47+FACODD*PHIL(I)*SOO*VALASY(IOFFA1+35)*PHIR(I)
     1          +FACEVE*SOE*PHIL(I+1)*VALASY(IOFFA1+35+NFASY0)
     2          *PHIR(I+1)
C
      SUM48=SUM48+FACODD*PHIL(I  )*DASYM(1,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DASYM(1,2)*PHIR(I+1)
      SUM49=SUM49+FACODD*PHIL(I  )*DASYM(2,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DASYM(2,2)*PHIR(I+1)
      SUM50=SUM50+FACODD*PHIL(I  )*DASYM(3,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DASYM(3,2)*PHIR(I+1)
      SUM51=SUM51+FACODD*PHIL(I  )*DASYM(4,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DASYM(4,2)*PHIR(I+1)
      SUM52=SUM52+FACODD*PHIL(I  )*DASYM(5,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DASYM(5,2)*PHIR(I+1)
      SUM53=SUM53+FACODD*PHIL(I  )*DASYM(6,1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*DASYM(6,2)*PHIR(I+1)
C
2500  CONTINUE
      IF (INDEX1 .EQ. INDEX2) THEN
             SUM08 = SUM08 - W33
             SUM09 = SUM09 - W333
             SUM10 = SUM10 - W133
             SUM11 = SUM11 - W3333
             SUM12 = SUM12 - W1333
      ENDIF
      NUMASY=NUMASY+1
      IOFFS=(NUMASY-1)*NZERAS
      IOFSO=(NUMASY-1)*NSPOAS
      IOFDI=(NUMASY-1)*NDIPAS
      ACCARR(IOFFS+ 1)=SUM01
      ACCARR(IOFFS+ 2)=SUM02
      ACCARR(IOFFS+ 3)=SUM03
      ACCARR(IOFFS+ 4)=SUM04
      ACCARR(IOFFS+ 5)=SUM05
      ACCARR(IOFFS+ 6)=SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
      ACCARR(IOFFS+23)=SUM23
      ACCARR(IOFFS+24)=SUM24
      ACCARR(IOFFS+25)=SUM25
      ACCARR(IOFFS+26)=SUM26
      ACCARR(IOFFS+27)=SUM27
      ACCARR(IOFFS+28)=SUM28
      ACCARR(IOFFS+29)=SUM29
      ACCARR(IOFFS+30)=SUM30
      ACCARR(IOFFS+31)=SUM31
      ACCARR(IOFFS+32)=SUM32
      ACCARR(IOFFS+33)=SUM33
      ACCARR(IOFFS+34)=SUM34
      ACCARR(IOFFS+35)=SUM35
      ACCARR(IOFFS+36)=SUM36
      ACCARR(IOFFS+37)=SUM37
      ACCARR(IOFFS+38)=SUM38
      ACCARR(IOFFS+39)=SUM39
      ACCARR(IOFFS+40)=SUM40
      ACCARR(IOFFS+41)=SUM41
      ACCARR(IOFFS+42)=ZUM01
      ACCARR(IOFFS+43)=ZUM02
      ACCARR(IOFFS+44)=ZUM03
      ACCARR(IOFFS+45)=ZUM04
      ACCARR(IOFFS+46)=ZUM05
      ACCARR(IOFFS+47)=ZUM06
      SPOARR(IOFSO+1)=SUM42
      SPOARR(IOFSO+2)=SUM43
      SPOARR(IOFSO+3)=SUM44
      SPOARR(IOFSO+4)=SUM45
      SPOARR(IOFSO+5)=SUM46
      SPOARR(IOFSO+6)=SUM47
C
      DIPZAC(IOFDI+1)=SUM48
      DIPZAC(IOFDI+2)=SUM49
      DIPZAC(IOFDI+3)=SUM50
      DIPZAC(IOFDI+4)=SUM51
      DIPZAC(IOFDI+5)=SUM52
      DIPZAC(IOFDI+6)=SUM53
C
2600  CONTINUE
2800  CONTINUE
2810  CONTINUE
      IDUMMY=NUMASY
      NUMASY=NUMASY*NZERAS
      NUSOAS=IDUMMY*NSPOAS
      NUDIAS=IDUMMY*NDIPAS
      WRITE (NFILST) (ACCARR(L), L=1,NUMASY)
      WRITE (NFIL29) (SPOARR(L), L=1,NUSOAS)
      WRITE (NFILDI) (DIPZAC(L), L=1,NUDIAS)
      IF (IPRINT .NE. 0) WRITE (NFIL6,9003)
      RETURN
9001  FORMAT(1H0,' RENTEL.INT.INF   DK=0 INTEGRATION ROUTINE ENTERED'/)
9002  FORMAT(1H0,' RENTEL.INT.INF   SYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=0'/)
9003  FORMAT(1H0,' RENTEL.INT.INF   UNSYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=0'/)
      END
C
C
      SUBROUTINE INTONE ( ROTSYM , ROTASY ,
     1                   COSGM , SINGM , DGKDR,
     1                   PHIL   , DERL   , PHIR   , DERR   ,
     1                   AMLZ12 , ACCARR ,
     1                   NFILST ,          NFILBN ,
     1                   KFSYMJ , KFASYJ ,
     1                   LENACC , NUMSYM , NUMASY ,
     1                   NONESY , NONEAS,
     2                   DIPAC,LENDIP,
     3                   NDIPSY,NDIPAS,
     4                   NFILD1 )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10) 
C
      REAL*8 DIPAC(LENDIP),
     1       DSYMM(9,2),
     2       DASYM(6,2)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 PHIL(NSTINT),
     1      DERL(NSTINT),PHIR(NSTINT),DERR(NSTINT),
     1      COSGM(NSTINT*JMAXP1) , SINGM(NSTINT*JMAXP1) ,
     1      ROTSYM(KFSYMJ),ROTASY(KFASYJ) , DGKDR(NSTINT*JMAXP1),
     1      AMLZ12 (NSTINT)
      REAL*8  SUM01,SUM02,SUM03,SUM04,SUM05,SUM06,SUM07,SUM08,SUM09,
     1 SUM10,SUM11,SUM12,SUM13,SUM14,SUM15,SUM16,SUM17,SUM18,SUM19,
     2 SUM20,SUM21,SUM22,SUM23,SUM24,SUM25,SUM26,SUM27,SUM28,SUM29,
     3 SUM30,SUM31,ACCARR(LENACC)
      REAL*8 FACODD,FACEVE
      INTEGER INDEX1,INDEX2,
     1       IOFFS,IOFFS0,IEND,JOFFS,KOFFSO,KOFFSE,NFCT
C
      include 'isotop.h'
      include 'value.h'
      include 'lzcomp.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9001)
      FACOD0=2.0D+00*HSTEP/3.0D+00
      FACEV0=4.0D+00*HSTEP/3.0D+00
      ECOEF1=(U1-U3)/SQRT((U1+U3)**2-4.0E0*U13**2)
      ECOEF2=SQRT((U1+U3-2.0E0*U13)/(U1+U3+2.0E0*U13))
      F2COEF=(M/(U1*U3-U13**2))
     1	    *((PLANCK*AVOGNO*1.0D+16)/(4.0D+00*PI*PI*VELLGT))
C
      IF (NSURF .EQ. 1) THEN
	   XFACT=-2.0D+00
      ELSE
	   XFACT= 2.0D+00
      ENDIF
C
      DO 800 I=1,NSTINT
      RHO=DFLOAT(I)*HSTEP
      CORANG=1.0D+00-COS(RHO)
800   AMLZ12(I)=XFACT*(XLAMB-(((XLZI4*CORANG+XLZI3)*CORANG+XLZI2)
     1         *CORANG+XLZI1)*CORANG)

      REWIND NFIL46
      REWIND NFIL47
      REWIND NFIL49
      READ (NFIL46) (COSGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL47) (SINGM(L), L=1,JMAXP1*NSTINT)
      READ (NFIL49) (DGKDR(L), L=1,JMAXP1*NSTINT)
C
C START LOOP OVER K FOR CALCULATING DELTAK=1 MATRIX ELEMENTS
C
      NUMSYM=0
      DO 1410 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB=K1VAL*NSTINT
C
C
      DO 1405 KDEL=-1,1,2
      K2P1=K1P1+KDEL
      XKK=DFLOAT(K1P1+K2P1-2)
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 1405
      K2VAL = K2P1 - 1
      INDB2 = K2VAL * NSTINT
C
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 1400 INDEX1=1,V2MXP1
C
      IREC1=(K1P1-1)*V2MXP1+INDEX1
      READ (NFILBN,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 1200 INDEX2=1,V2MXP1
C
      IREC2=(K2P1-1)*V2MXP1+INDEX2
      READ (NFILBN,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
C
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
C
      DO 1100 I=1,NSTINT,2
      INDR=INDB+I
      INDR2=INDB2+I
      IOFFS=(I-1)*NFSYMJ
      IOFFA=(I-1)*NFASYJ
      DO 111 IPT=1,2
      IOFFS= IOFFS + (IPT-1)*NFSYMJ
      IOFFA= IOFFA + (IPT-1)*NFASYJ
        DO 112 LL=1,9
          IF (NSURF.EQ.1) THEN
            DSYMM(LL,IPT)=1/SQRT(2.00)*(
     1        -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     2                            *ROTSYM(IOFFS+53+LL)
     2        -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     3                            *ROTSYM(IOFFS+62+LL)
     3        +KDEL*ROTSYM(IOFFS+71+LL)*
     4        (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     5        -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
          ENDIF
          IF (NSURF.EQ.2) THEN
            DSYMM(LL,IPT)=1/SQRT(2.00)*(
     1        -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))*
     2         ROTSYM(IOFFS+53+LL)
     2        -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     3         *ROTSYM(IOFFS+62+LL)
     3        +KDEL*ROTSYM(IOFFS+71+LL)*
     4        (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     5          -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
          ENDIF
112     CONTINUE
        IF (.NOT.SYMM) THEN
          DO 113 LL=1,6
            IF (NSURF.EQ.1) THEN
              DASYM(LL,IPT)=1/SQRT(2.00)*(
     1          -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     2          *ROTASY(IOFFA+40+LL)
     2          -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     3          *ROTASY(IOFFA+46+LL)
     3          +KDEL*ROTASY(IOFFA+52+LL)*
     4          (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     5           -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
            ENDIF
            IF (NSURF.EQ.2) THEN
              DASYM(LL,IPT)=1/SQRT(2.00)*(
     1          -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     2          *ROTASY(IOFFA+40+LL)
     2          -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     3          *ROTASY(IOFFA+46+LL)
     3          +KDEL*ROTASY(IOFFA+52+LL)*
     4          (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     5          -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
            ENDIF
113       CONTINUE
        ENDIF
        IF (SYMM) THEN
          CALL TR15SS(DSYMM(1,IPT))
        ELSE
          CALL  TR15A(DSYMM(1,IPT),DASYM(1,IPT))
        ENDIF
111   CONTINUE
      IOFFS=(I-1)*NFSYMJ
      IOFFA=(I-1)*NFASYJ
      FACODD=FACOD0*(COSGM(INDR)*COSGM(INDR2)+SINGM(INDR)
     1      *SINGM(INDR2))
      FACEVE=FACEV0*(COSGM(INDR+1)*COSGM(INDR2+1)+SINGM(INDR+1)
     1      *SINGM(INDR2+1))
      FACTKO=XKK*FACODD+FACOD0*AMLZ12(I)*(COSGM(INDR)*SINGM(INDR2)
     1      +SINGM(INDR)*COSGM(INDR2))
      FACTKE=XKK*FACEVE+FACEV0*AMLZ12(I+1)*(COSGM(INDR+1)*SINGM(INDR2+1)
     1      +SINGM(INDR+1)*COSGM(INDR2+1))
      FACXRO=FACOD0*(COSGM(INDR2)*SINGM(INDR)-COSGM(INDR)*SINGM(INDR2))
     1       *(DGKDR(INDR)+DGKDR(INDR2))
      FACXRE=FACEV0*(COSGM(INDR2+1)*SINGM(INDR+1)-COSGM(INDR+1)
     1       *SINGM(INDR2+1))*(DGKDR(INDR+1)+DGKDR(INDR2+1))
      SUM01=SUM01+PHIL(I  )*ROTSYM(IOFFS+28)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+28+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM02=SUM02+PHIL(I  )*ROTSYM(IOFFS+29)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+29+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM03=SUM03+PHIL(I  )*ROTSYM(IOFFS+30)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+30+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM04=SUM04+PHIL(I  )*ROTSYM(IOFFS+31)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+31+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM05=SUM05+PHIL(I  )*ROTSYM(IOFFS+32)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+32+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM06=SUM06+PHIL(I  )*ROTSYM(IOFFS+33)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+33+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM07=SUM07+PHIL(I  )*ROTSYM(IOFFS+34)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+34+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM08=SUM08+PHIL(I  )*ROTSYM(IOFFS+35)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTSYM(IOFFS+35+NFSYMJ)*FACTKE
     1          *PHIR(I+1)
      SUM09=SUM09+FACODD*ROTSYM(IOFFS+36)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+36+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+36)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+36+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM10=SUM10+FACODD*ROTSYM(IOFFS+37)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+37+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+37)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+37+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM11=SUM11+FACODD*ROTSYM(IOFFS+38)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+38+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+38)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+38+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM12=SUM12+FACODD*ROTSYM(IOFFS+39)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+39+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+39)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+39+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM13=SUM13+FACODD*ROTSYM(IOFFS+40)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+40+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+40)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+40+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM14=SUM14+FACODD*ROTSYM(IOFFS+41)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+41+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+41)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+41+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM15=SUM15+FACODD*ROTSYM(IOFFS+42)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+42+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+42)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+42+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM16=SUM16+FACODD*ROTSYM(IOFFS+43)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+43+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+43)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+43+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM17=SUM17+FACODD*ROTSYM(IOFFS+44)*(DERR(I)*PHIL(I)-DERL(I)
     1       *PHIR(I))
     2       +FACEVE*ROTSYM(IOFFS+44+NFSYMJ)*(DERR(I+1)*PHIL(I+1)
     1       -DERL(I+1)*PHIR(I+1))
     3       +FACXRO*ROTSYM(IOFFS+44)*PHIL(I)*PHIR(I)
     4       +FACXRE*ROTSYM(IOFFS+44+NFSYMJ)*PHIL(I+1)*PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*ROTSYM(IOFFS+45)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+45+NFSYMJ)*PHIR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*ROTSYM(IOFFS+46)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+46+NFSYMJ)*PHIR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*ROTSYM(IOFFS+47)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+47+NFSYMJ)*PHIR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*ROTSYM(IOFFS+48)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+48+NFSYMJ)*PHIR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*ROTSYM(IOFFS+49)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+49+NFSYMJ)*PHIR(I+1)
      SUM23=SUM23+FACODD*PHIL(I  )*ROTSYM(IOFFS+50)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+50+NFSYMJ)*PHIR(I+1)
      SUM24=SUM24+FACODD*PHIL(I  )*ROTSYM(IOFFS+51)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+51+NFSYMJ)*PHIR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*ROTSYM(IOFFS+52)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+52+NFSYMJ)*PHIR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*ROTSYM(IOFFS+53)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+53+NFSYMJ)*PHIR(I+1)
C
      SUM27=SUM27+
     1      FACOD0*PHIL(I  )*DSYMM(1,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(1,2)*PHIR(I+1)
      SUM28=SUM28+
     1      FACOD0*PHIL(I  )*DSYMM(2,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(2,2)*PHIR(I+1)
      SUM29=SUM29+
     1      FACOD0*PHIL(I  )*DSYMM(3,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(3,2)*PHIR(I+1)
      SUM30=SUM30+
     1      FACOD0*PHIL(I  )*DSYMM(4,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(4,2)*PHIR(I+1)
      SUM31=SUM31+
     1      FACOD0*PHIL(I  )*DSYMM(5,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(5,2)*PHIR(I+1)
      SUM32=SUM32+
     1      FACOD0*PHIL(I  )*DSYMM(6,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(6,2)*PHIR(I+1)
      SUM33=SUM33+
     1      FACOD0*PHIL(I  )*DSYMM(7,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(7,2)*PHIR(I+1)
      SUM34=SUM34+
     1      FACOD0*PHIL(I  )*DSYMM(8,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(8,2)*PHIR(I+1)
      SUM35=SUM35+
     1      FACOD0*PHIL(I  )*DSYMM(9,1)*PHIR(I  )+
     2      FACEV0*PHIL(I+1)*DSYMM(9,2)*PHIR(I+1)
C
1100  CONTINUE
      NUMSYM=NUMSYM+1
      IOFFS=(NUMSYM-1)*NONESY
      IOFDI=(NUMSYM-1)*NDIPSY
      ACCARR(IOFFS+ 1)=SUM01
      ACCARR(IOFFS+ 2)=SUM02
      ACCARR(IOFFS+ 3)=SUM03
      ACCARR(IOFFS+ 4)=SUM04
      ACCARR(IOFFS+ 5)=SUM05
      ACCARR(IOFFS+ 6)=SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
      ACCARR(IOFFS+23)=SUM23
      ACCARR(IOFFS+24)=SUM24
      ACCARR(IOFFS+25)=SUM25
      ACCARR(IOFFS+26)=SUM26
C
      DIPAC(IOFDI+1)=SUM27
      DIPAC(IOFDI+2)=SUM28
      DIPAC(IOFDI+3)=SUM29
      DIPAC(IOFDI+4)=SUM30
      DIPAC(IOFDI+5)=SUM31
      DIPAC(IOFDI+6)=SUM32
      DIPAC(IOFDI+7)=SUM33
      DIPAC(IOFDI+8)=SUM34
      DIPAC(IOFDI+9)=SUM35
C
1200  CONTINUE
1400  CONTINUE
1405  CONTINUE
1410  CONTINUE
      WRITE (NFILST) (ACCARR(L), L=1,NUMSYM*NONESY)
      WRITE (NFILD1) (DIPAC(L) , L=1,NUMSYM*NDIPSY)
      NUMSYM=NUMSYM*NONESY
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9002)
      IF (SYMM) RETURN
      IOFFS0=NFSYM0*V2MXP1*V2MXP1
C
C*********************************************************************
C
C THIS THE THE END OF THE CALCULATION FOR THE SYMMETRICAL MOLECULE.
C WE NOW CALCULATE INTEGRALS FOR THE UNSYMMETRICAL CASE.
C
C*********************************************************************
C
C START LOOP OVER K FOR CALCULATING THE DELTA K=1 MATRIX ELEMENTS
C
      NUMASY=0
      DO 2810 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB= K1VAL * NSTINT
C
C
      DO 2805 KDEL=-1,1,2
      K2P1=K1P1+KDEL
      XKK=DFLOAT(K1P1+K2P1-2)
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 2805
      K2VAL = K2P1 - 1
      INDB2 = K2VAL * NSTINT
C
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 2800 INDEX1=1,V2MXP1
C
      IREC1=(K1P1-1)*V2MXP1+INDEX1
      READ (NFILBN,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 2600 INDEX2=1,V2MXP1
      IREC2=(K2P1-1)*V2MXP1+INDEX2
      READ (NFILBN,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM01=0.0D+00
      SUM02=0.0D+00
      SUM03=0.0D+00
      SUM04=0.0D+00
      SUM05=0.0D+00
      SUM06=0.0D+00
      SUM07=0.0D+00
      SUM08=0.0D+00
      SUM09=0.0D+00
      SUM10=0.0D+00
      SUM11=0.0D+00
      SUM12=0.0D+00
      SUM13=0.0D+00
      SUM14=0.0D+00
      SUM15=0.0D+00
      SUM16=0.0D+00
      SUM17=0.0D+00
      SUM18=0.0D+00
      SUM19=0.0D+00
      SUM20=0.0D+00
      SUM21=0.0D+00
      SUM22=0.0D+00
C
      SUM23=0.0D+00
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
C
      DO 2500 I=1,NSTINT,2
      IOFFA=(I-1)*NFASYJ
      IOFFS=(I-1)*NFSYMJ
      INDR=INDB+I
      INDR2=INDB2+I
C
      DO 211 IPT=1,2
        IOFFA = IOFFA + (IPT-1) * NFASYJ
        IOFFS = IOFFS + (IPT-1) * NFSYMJ
        DO 212 LL=1,9
          IF (NSURF.EQ.1) THEN
            DSYMM(LL,IPT)=1/SQRT(2.00)*(
     1        -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     2        *ROTSYM(IOFFS+53+LL)
     2        -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     3        *ROTSYM(IOFFS+62+LL)
     3        +KDEL*ROTSYM(IOFFS+71+LL)*
     4        (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))-
     3       SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
          ENDIF
          IF (NSURF.EQ.2) THEN
            DSYMM(LL,IPT)=1/SQRT(2.00)*(
     1        -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     2        *ROTSYM(IOFFS+53+LL)
     2        -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     3        *ROTSYM(IOFFS+62+LL)
     3        +KDEL*ROTSYM(IOFFS+71+LL)*
     4        (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     5        -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
          ENDIF
212     CONTINUE
        DO 213 LL=1,6
          IF (NSURF.EQ.1) THEN
            DASYM(LL,IPT)=1/SQRT(2.00)*(
     1        -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     2        *ROTASY(IOFFA+40+LL)
     2        -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     3        *ROTASY(IOFFA+46+LL)
     3        +KDEL*ROTASY(IOFFA+52+LL)*
     4        (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     4        -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
          ENDIF
          IF (NSURF.EQ.2) THEN
            DASYM(LL,IPT)=1/SQRT(2.00)*(
     1        -SINGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     2        *ROTASY(IOFFA+40+LL)
     2        -COSGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))
     3        *ROTASY(IOFFA+46+LL)
     3        +KDEL*ROTASY(IOFFA+52+LL)*
     4        (COSGM(INDR+(IPT-1))*SINGM(INDR2+(IPT-1))
     5        -SINGM(INDR+(IPT-1))*COSGM(INDR2+(IPT-1))))
          ENDIF
213     CONTINUE
        CALL TR15A(DSYMM(1,IPT),DASYM(1,IPT))
211   CONTINUE
C
      IOFFS=(I-1)*NFASYJ
C
      FACODD=FACOD0*(COSGM(INDR)*COSGM(INDR2)+SINGM(INDR)*SINGM(INDR2))
      FACEVE=FACEV0*(COSGM(INDR+1)*COSGM(INDR2+1)+SINGM(INDR+1)
     1      *SINGM(INDR2+1))
      FACTKO=XKK*FACODD+FACOD0*AMLZ12(I)*(COSGM(INDR)*SINGM(INDR2)
     1      +SINGM(INDR)*COSGM(INDR2))
      FACTKE=XKK*FACEVE+FACEV0*AMLZ12(I+1)*(COSGM(INDR+1)*SINGM(INDR2+1)
     1      +SINGM(INDR+1)*COSGM(INDR2+1))
      FACXRO=FACOD0*(COSGM(INDR2)*SINGM(INDR)-COSGM(INDR)*SINGM(INDR2))
     1       *(DGKDR(INDR)+DGKDR(INDR2))
      FACXRE=FACEV0*(COSGM(INDR2+1)*SINGM(INDR+1)-COSGM(INDR+1)
     1       *SINGM(INDR2+1))*(DGKDR(INDR+1)+DGKDR(INDR2+1))
      SUM01=SUM01+PHIL(I  )*ROTASY(IOFFS+19)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+19+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM02=SUM02+PHIL(I  )*ROTASY(IOFFS+20)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+20+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM03=SUM03+PHIL(I  )*ROTASY(IOFFS+21)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+21+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM04=SUM04+PHIL(I  )*ROTASY(IOFFS+22)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+22+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM05=SUM05+PHIL(I  )*ROTASY(IOFFS+23)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+23+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM06=SUM06+PHIL(I  )*ROTASY(IOFFS+24)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+24+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM07=SUM07+PHIL(I  )*ROTASY(IOFFS+25)*FACTKO*PHIR(I  )
     1          +PHIL(I+1)*ROTASY(IOFFS+25+NFASYJ)*FACTKE
     1          *PHIR(I+1)
      SUM08=SUM08+FACODD*(ROTASY(IOFFS+26)*(PHIL(I)*DERR(I)
     1           -DERL(I)*PHIR(I)))
     2           +FACEVE*(ROTASY(IOFFS+NFASYJ+26)*(PHIL(I+1)*DERR(I+1)
     1           -DERL(I+1)*PHIR(I+1)))
     3           +FACXRO*ROTASY(IOFFS+26)*PHIL(I)*PHIR(I)
     4           +FACXRE*ROTASY(IOFFS+26+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM09=SUM09+FACODD*(ROTASY(IOFFS+27)*(PHIL(I)*DERR(I)
     1           -DERL(I)*PHIR(I)))
     2           +FACEVE*(ROTASY(IOFFS+NFASYJ+27)*(PHIL(I+1)*DERR(I+1)
     1           -DERL(I+1)*PHIR(I+1)))
     3           +FACXRO*ROTASY(IOFFS+27)*PHIL(I)*PHIR(I)
     4           +FACXRE*ROTASY(IOFFS+27+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM10=SUM10+FACODD*(ROTASY(IOFFS+28)*(PHIL(I)*DERR(I)
     1           -DERL(I)*PHIR(I)))
     2           +FACEVE*(ROTASY(IOFFS+NFASYJ+28)*(PHIL(I+1)*DERR(I+1)
     1           -DERL(I+1)*PHIR(I+1)))
     3           +FACXRO*ROTASY(IOFFS+28)*PHIL(I)*PHIR(I)
     4           +FACXRE*ROTASY(IOFFS+28+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM11=SUM11+FACODD*(ROTASY(IOFFS+29)*(PHIL(I)*DERR(I)
     1           -DERL(I)*PHIR(I)))
     2           +FACEVE*(ROTASY(IOFFS+NFASYJ+29)*(PHIL(I+1)*DERR(I+1)
     1           -DERL(I+1)*PHIR(I+1)))
     3           +FACXRO*ROTASY(IOFFS+29)*PHIL(I)*PHIR(I)
     4           +FACXRE*ROTASY(IOFFS+29+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM12=SUM12+FACODD*(ROTASY(IOFFS+30)*(PHIL(I)*DERR(I)
     1           -DERL(I)*PHIR(I)))
     2           +FACEVE*(ROTASY(IOFFS+NFASYJ+30)*(PHIL(I+1)*DERR(I+1)
     1           -DERL(I+1)*PHIR(I+1)))
     3           +FACXRO*ROTASY(IOFFS+30)*PHIL(I)*PHIR(I)
     4           +FACXRE*ROTASY(IOFFS+30+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM13=SUM13+FACODD*(ROTASY(IOFFS+31)*(PHIL(I)*DERR(I)
     1           -DERL(I)*PHIR(I)))
     2           +FACEVE*(ROTASY(IOFFS+NFASYJ+31)*(PHIL(I+1)*DERR(I+1)
     1           -DERL(I+1)*PHIR(I+1)))
     3           +FACXRO*ROTASY(IOFFS+31)*PHIL(I)*PHIR(I)
     4           +FACXRE*ROTASY(IOFFS+31+NFASYJ)*PHIL(I+1)*PHIR(I+1)
      SUM14=SUM14+FACODD*PHIL(I  )*ROTASY(IOFFS+32)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+32+NFASYJ)*PHIR(I+1)
      SUM15=SUM15+FACODD*PHIL(I  )*ROTASY(IOFFS+33)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+33+NFASYJ)*PHIR(I+1)
      SUM16=SUM16+FACODD*PHIL(I  )*ROTASY(IOFFS+34)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+34+NFASYJ)*PHIR(I+1)
      SUM17=SUM17+FACODD*PHIL(I  )*ROTASY(IOFFS+35)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+35+NFASYJ)*PHIR(I+1)
      SUM18=SUM18+FACODD*PHIL(I  )*ROTASY(IOFFS+36)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+36+NFASYJ)*PHIR(I+1)
      SUM19=SUM19+FACODD*PHIL(I  )*ROTASY(IOFFS+37)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+37+NFASYJ)*PHIR(I+1)
      SUM20=SUM20+FACODD*PHIL(I  )*ROTASY(IOFFS+38)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+38+NFASYJ)*PHIR(I+1)
      SUM21=SUM21+FACODD*PHIL(I  )*ROTASY(IOFFS+39)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+39+NFASYJ)*PHIR(I+1)
      SUM22=SUM22+FACODD*PHIL(I  )*ROTASY(IOFFS+40)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+40+NFASYJ)*PHIR(I+1)
C
      SUM23=SUM23
     1     +FACOD0*PHIL(I  )*DASYM(1,1)*PHIR(I  )
     1     +FACEV0*PHIL(I+1)*DASYM(1,2)*PHIR(I+1)
      SUM24=SUM24
     1     +FACOD0*PHIL(I  )*DASYM(2,1)*PHIR(I  )
     1     +FACEV0*PHIL(I+1)*DASYM(2,2)*PHIR(I+1)
      SUM25=SUM25
     1     +FACOD0*PHIL(I  )*DASYM(3,1)*PHIR(I  )
     1     +FACEV0*PHIL(I+1)*DASYM(3,2)*PHIR(I+1)
      SUM26=SUM26
     1     +FACOD0*PHIL(I  )*DASYM(4,1)*PHIR(I  )
     1     +FACEV0*PHIL(I+1)*DASYM(4,2)*PHIR(I+1)
      SUM27=SUM27
     1     +FACOD0*PHIL(I  )*DASYM(5,1)*PHIR(I  )
     1     +FACEV0*PHIL(I+1)*DASYM(5,2)*PHIR(I+1)
      SUM28=SUM28
     1     +FACOD0*PHIL(I  )*DASYM(6,1)*PHIR(I  )
     1     +FACEV0*PHIL(I+1)*DASYM(6,2)*PHIR(I+1)
C
2500  CONTINUE
      NUMASY=NUMASY+1
      IOFFS=(NUMASY-1)*NONEAS
      IOFDI=(NUMASY-1)*NDIPAS
      ACCARR(IOFFS+ 1)=SUM01
      ACCARR(IOFFS+ 2)=SUM02
      ACCARR(IOFFS+ 3)=SUM03
      ACCARR(IOFFS+ 4)=SUM04
      ACCARR(IOFFS+ 5)=SUM05
      ACCARR(IOFFS+ 6)=SUM06
      ACCARR(IOFFS+ 7)=SUM07
      ACCARR(IOFFS+ 8)=SUM08
      ACCARR(IOFFS+ 9)=SUM09
      ACCARR(IOFFS+10)=SUM10
      ACCARR(IOFFS+11)=SUM11
      ACCARR(IOFFS+12)=SUM12
      ACCARR(IOFFS+13)=SUM13
      ACCARR(IOFFS+14)=SUM14
      ACCARR(IOFFS+15)=SUM15
      ACCARR(IOFFS+16)=SUM16
      ACCARR(IOFFS+17)=SUM17
      ACCARR(IOFFS+18)=SUM18
      ACCARR(IOFFS+19)=SUM19
      ACCARR(IOFFS+20)=SUM20
      ACCARR(IOFFS+21)=SUM21
      ACCARR(IOFFS+22)=SUM22
C
      DIPAC(IOFDI+1)=SUM23
      DIPAC(IOFDI+2)=SUM24
      DIPAC(IOFDI+3)=SUM25
      DIPAC(IOFDI+4)=SUM26
      DIPAC(IOFDI+5)=SUM27
      DIPAC(IOFDI+6)=SUM28
C
2600  CONTINUE
2800  CONTINUE
2805  CONTINUE
2810  CONTINUE
      WRITE (NFILST) (ACCARR(L), L=1,NUMASY*NONEAS)
      WRITE (NFILD1) (DIPAC(L) , L=1,NUMASY*NDIPAS)
      NUMASY=NUMASY*NONEAS
      IF (IPRINT .NE. 0) WRITE (NFIL6,9003)
      RETURN
9001  FORMAT(1H0,' RENTEL.INT.INF   DK=1 INTEGRATION ROUTINE ENTERED'/)
9002  FORMAT(1H0,' RENTEL.INT.INF   SYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=1'/)
9003  FORMAT(1H0,' RENTEL.INT.INF   UNSYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=1'/)
      END
C
C
      SUBROUTINE INTTWO ( ROTSYM , ROTASY , COSGM , SINGM ,
     1                   PHIL   , DERL   , PHIR   , DERR   , ACCARR ,
     1                   NFILST ,          NFILBN ,
     1                   KFSYMJ , KFASYJ ,
     1                   LENACC , NUMSYM , NUMASY ,
     1                   NTWOSY , NTWOAS )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 PHIL(NSTINT),
     1      DERL(NSTINT),PHIR(NSTINT),DERR(NSTINT),
     1      COSGM(NSTINT*JMAXP1) , SINGM(NSTINT*JMAXP1) ,
     1      ROTSYM(KFSYMJ),ROTASY(KFASYJ)
      REAL*8  SUM01,SUM02,SUM03,SUM04,SUM05,SUM06,SUM07,SUM08,SUM09,
     1 SUM10,SUM11,SUM12,SUM13,SUM14,SUM15,SUM16,SUM17,SUM18,SUM19,
     2 SUM20,SUM21,SUM22,SUM23,SUM24,SUM25,SUM26,SUM27,SUM28,SUM29,
     3 SUM30,SUM31,ACCARR(LENACC)
      REAL*8 FACODD,FACEVE
      INTEGER INDEX1,INDEX2,
     1       IOFFS,IOFFS0,IEND,JOFFS,KOFFSO,KOFFSE,NFCT
C
      include 'isotop.h'
      include 'value.h'
      include 'lzcomp.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
C
C       LOAD ARRAYS NEEDED FOR RHO-DEPENDENT VALUES
C
      REWIND NFIL46
      REWIND NFIL47
      JMAXPNS = JMAXP1 * NSTINT
      NSTINT2 = NSTINT
      READ (NFIL46)     (COSGM(L), L=1,JMAXPNS)
      READ (NFIL47)     (SINGM(L), L=1,JMAXPNS)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9001)
      FACOD0=2.0D+00*HSTEP/3.0D+00
      FACEV0=4.0D+00*HSTEP/3.0D+00
      ECOEF1=(U1-U3)/SQRT((U1+U3)**2-4.0E0*U13**2)
      ECOEF2=SQRT((U1+U3-2.0E0*U13)/(U1+U3+2.0E0*U13))
      F2COEF=(M/(U1*U3-U13**2))
     1	    *((PLANCK*AVOGNO*1.0D+16)/(4.0D+00*PI*PI*VELLGT))
C
C START LOOP OVER K FOR CALCULATING DELTAK=2 MATRIX ELEMENTS
C
      NUMSYM=0
      DO 1410 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB= K1VAL*NSTINT
C
C
      DO 1405 KDEL=-2,2,4
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 1405
      K2VAL = K2P1 - 1
      INDB2=K2VAL*NSTINT
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 1400 INDEX1=1,V2MXP1
C
      IREC1=(K1P1-1)*V2MXP1+INDEX1
      READ (NFILBN,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 1200 INDEX2=1,V2MXP1
C
      IREC2=(K2P1-1)*V2MXP1+INDEX2
      READ (NFILBN,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
      SUM36=0.0D+00
      SUM37=0.0D+00
      SUM38=0.0D+00
      SUM39=0.0D+00
      SUM40=0.0D+00
      SUM41=0.0D+00
      SUM42=0.0D+00
      SUM43=0.0D+00
      SUM44=0.0D+00
      SUM45=0.0D+00
      SUM46=0.0D+00
      SUM47=0.0D+00
      SUM48=0.0D+00
      SUM49=0.0D+00
C
      DO 1100 I=1,NSTINT,2
      INDR=INDB+I
      INDR2=INDB2+I
      IOFFS=(I-1)*NFSYMJ
      FACODD=FACOD0*(COSGM(INDR)*COSGM(INDR2)+SINGM(INDR)*SINGM(INDR2))
      FACEVE=FACEV0*(COSGM(INDR+1)*COSGM(INDR2+1)+SINGM(INDR+1)
     1          *SINGM(INDR2+1))
      SUM32=SUM32+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 1+NFSYMJ)*PHIR(I+1)
      SUM33=SUM33+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 2)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 2+NFSYMJ)*PHIR(I+1)
      SUM34=SUM34+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 3)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 3+NFSYMJ)*PHIR(I+1)
      SUM35=SUM35+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 4)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 4+NFSYMJ)*PHIR(I+1)
      SUM36=SUM36+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 5)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 5+NFSYMJ)*PHIR(I+1)
      SUM37=SUM37+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 6)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 6+NFSYMJ)*PHIR(I+1)
      SUM38=SUM38+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 7)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 7+NFSYMJ)*PHIR(I+1)
      SUM39=SUM39+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 8)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 8+NFSYMJ)*PHIR(I+1)
      SUM40=SUM40+FACODD*PHIL(I  )*ROTSYM(IOFFS+ 9)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+ 9+NFSYMJ)*PHIR(I+1)
      SUM41=SUM41+FACODD*PHIL(I  )*ROTSYM(IOFFS+10)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+10+NFSYMJ)*PHIR(I+1)
      SUM42=SUM42+FACODD*PHIL(I  )*ROTSYM(IOFFS+11)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+11+NFSYMJ)*PHIR(I+1)
      SUM43=SUM43+FACODD*PHIL(I  )*ROTSYM(IOFFS+12)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+12+NFSYMJ)*PHIR(I+1)
      SUM44=SUM44+FACODD*PHIL(I  )*ROTSYM(IOFFS+13)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+13+NFSYMJ)*PHIR(I+1)
      SUM45=SUM45+FACODD*PHIL(I  )*ROTSYM(IOFFS+14)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+14+NFSYMJ)*PHIR(I+1)
      SUM46=SUM46+FACODD*PHIL(I  )*ROTSYM(IOFFS+15)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+15+NFSYMJ)*PHIR(I+1)
      SUM47=SUM47+FACODD*PHIL(I  )*ROTSYM(IOFFS+16)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+16+NFSYMJ)*PHIR(I+1)
      SUM48=SUM48+FACODD*PHIL(I  )*ROTSYM(IOFFS+17)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+17+NFSYMJ)*PHIR(I+1)
      SUM49=SUM49+FACODD*PHIL(I  )*ROTSYM(IOFFS+18)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTSYM(IOFFS+18+NFSYMJ)*PHIR(I+1)
1100  CONTINUE
      NUMSYM=NUMSYM+1
      IOFFS=(NUMSYM-1)*NTWOSY
      ACCARR(IOFFS+ 1)=SUM32
      ACCARR(IOFFS+ 2)=SUM33
      ACCARR(IOFFS+ 3)=SUM34
      ACCARR(IOFFS+ 4)=SUM35
      ACCARR(IOFFS+ 5)=SUM36
      ACCARR(IOFFS+ 6)=SUM37
      ACCARR(IOFFS+ 7)=SUM38
      ACCARR(IOFFS+ 8)=SUM39
      ACCARR(IOFFS+ 9)=SUM40
      ACCARR(IOFFS+10)=SUM41
      ACCARR(IOFFS+11)=SUM42
      ACCARR(IOFFS+12)=SUM43
      ACCARR(IOFFS+13)=SUM44
      ACCARR(IOFFS+14)=SUM45
      ACCARR(IOFFS+15)=SUM46
      ACCARR(IOFFS+16)=SUM47
      ACCARR(IOFFS+17)=SUM48
      ACCARR(IOFFS+18)=SUM49
1200  CONTINUE
1400  CONTINUE
1405  CONTINUE
1410  CONTINUE
      NUMSYM=NUMSYM*NTWOSY
      WRITE (NFILST) (ACCARR(L), L=1,NUMSYM)
C
      IF (IPRINT .NE. 0) WRITE (NFIL6,9002)
      IF (SYMM) RETURN
      IOFFS0=NFSYM0*V2MXP1*V2MXP1
C
C*********************************************************************
C
C THIS THE THE END OF THE CALCULATION FOR THE SYMMETRICAL MOLECULE.
C WE NOW CALCULATE INTEGRALS FOR THE UNSYMMETRICAL CASE.
C
C*********************************************************************
C
C START LOOP OVER K FOR CALCULATING THE DELTAK=2 MATRIX ELEMENTS
C
      NUMASY=0
      DO 2810 K1P1=1,JMAXP1
      K1VAL = K1P1 - 1
      INDB=K1VAL*NSTINT
C
C
      DO 2805 KDEL=-2,2,4
      K2P1=K1P1+KDEL
      IF (K2P1 .LT. 1 .OR. K2P1 .GT. JMAXP1) GOTO 2805
      K2VAL = K2P1 - 1
      INDB2= K2VAL*NSTINT
C
C
C START LOOP OVER V2(LEFT) FOR THE CALCULATION OF MATRIX ELEMENTS
C
      DO 2800 INDEX1=1,V2MXP1
C
      IREC1=(K1P1-1)*V2MXP1+INDEX1
      READ (NFILBN,REC=IREC1) (PHIL(I),I=1,NSTINT),
     1                       (DERL(I),I=1,NSTINT)
C
      DO 2600 INDEX2=1,V2MXP1
      IREC2=(K2P1-1)*V2MXP1+INDEX2
      READ (NFILBN,REC=IREC2) (PHIR(I),I=1,NSTINT),
     1                       (DERR(I),I=1,NSTINT)
C
      SUM24=0.0D+00
      SUM25=0.0D+00
      SUM26=0.0D+00
      SUM27=0.0D+00
      SUM28=0.0D+00
      SUM29=0.0D+00
      SUM30=0.0D+00
      SUM31=0.0D+00
      SUM32=0.0D+00
      SUM33=0.0D+00
      SUM34=0.0D+00
      SUM35=0.0D+00
C
      DO 2500 I=1,NSTINT,2
      INDR=INDB+I
      INDR2=INDB2+I
      IOFFS=(I-1)*NFASYJ
      FACODD=FACOD0*(COSGM(INDR)*COSGM(INDR2)+SINGM(INDR)*SINGM(INDR2))
      FACEVE=FACEV0*(COSGM(INDR+1)*COSGM(INDR2+1)+SINGM(INDR+1)
     1          *SINGM(INDR2+1))
      SUM24=SUM24+FACODD*PHIL(I  )*ROTASY(IOFFS+ 1)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 1+NFASYJ)*PHIR(I+1)
      SUM25=SUM25+FACODD*PHIL(I  )*ROTASY(IOFFS+ 2)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 2+NFASYJ)*PHIR(I+1)
      SUM26=SUM26+FACODD*PHIL(I  )*ROTASY(IOFFS+ 3)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 3+NFASYJ)*PHIR(I+1)
      SUM27=SUM27+FACODD*PHIL(I  )*ROTASY(IOFFS+ 4)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 4+NFASYJ)*PHIR(I+1)
      SUM28=SUM28+FACODD*PHIL(I  )*ROTASY(IOFFS+ 5)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 5+NFASYJ)*PHIR(I+1)
      SUM29=SUM29+FACODD*PHIL(I  )*ROTASY(IOFFS+ 6)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 6+NFASYJ)*PHIR(I+1)
      SUM30=SUM30+FACODD*PHIL(I  )*ROTASY(IOFFS+ 7)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 7+NFASYJ)*PHIR(I+1)
      SUM31=SUM31+FACODD*PHIL(I  )*ROTASY(IOFFS+ 8)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 8+NFASYJ)*PHIR(I+1)
      SUM32=SUM32+FACODD*PHIL(I  )*ROTASY(IOFFS+ 9)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+ 9+NFASYJ)*PHIR(I+1)
      SUM33=SUM33+FACODD*PHIL(I  )*ROTASY(IOFFS+10)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+10+NFASYJ)*PHIR(I+1)
      SUM34=SUM34+FACODD*PHIL(I  )*ROTASY(IOFFS+11)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+11+NFASYJ)*PHIR(I+1)
      SUM35=SUM35+FACODD*PHIL(I  )*ROTASY(IOFFS+12)*PHIR(I  )
     1          +FACEVE*PHIL(I+1)*ROTASY(IOFFS+12+NFASYJ)*PHIR(I+1)
2500  CONTINUE
      NUMASY=NUMASY+1
      IOFFS=(NUMASY-1)*NTWOAS
      ACCARR(IOFFS+ 1)=SUM24
      ACCARR(IOFFS+ 2)=SUM25
      ACCARR(IOFFS+ 3)=SUM26
      ACCARR(IOFFS+ 4)=SUM27
      ACCARR(IOFFS+ 5)=SUM28
      ACCARR(IOFFS+ 6)=SUM29
      ACCARR(IOFFS+ 7)=SUM30
      ACCARR(IOFFS+ 8)=SUM31
      ACCARR(IOFFS+ 9)=SUM32
      ACCARR(IOFFS+10)=SUM33
      ACCARR(IOFFS+11)=SUM34
      ACCARR(IOFFS+12)=SUM35
2600  CONTINUE
2800  CONTINUE
2805  CONTINUE
2810  CONTINUE
      NUMASY=NUMASY*NTWOAS
      WRITE (NFILST) (ACCARR(L), L=1,NUMASY)
      IF (IPRINT .NE. 0) WRITE (NFIL6,9003)
      RETURN
9001  FORMAT(1H0,' RENTEL.INT.INF   DK=2 INTEGRATION ROUTINE ENTERED'/)
9002  FORMAT(1H0,' RENTEL.INT.INF   SYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=2'/)
9003  FORMAT(1H0,' RENTEL.INT.INF   UNSYMMETRIC MOLECULE INTEGRALS CA',
     1            'LCULATED FOR DK=2'/)
      END
C
C
C
      DOUBLE PRECISION FUNCTION XMURR ( VALRHO )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 14.03.1994
C AUTHOR      : PER JENSEN (WITH HELP FROM R. BEARDSWORTH)
C UPDATES     :
C LANGUAGE    : FORTRAN
C             :
C
C     SUBROUTINE CALCULATES THE VALUES OF VA(RHO), VB(RHO),
C     AND MUZZ(RHO)= F2(RHO)/IPP(RHO).
C
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8 B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(128) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(9,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 I0,I0P,I0PP,IRRVAL,IRRP,IRRPP
      REAL*8 CE,SE,C2R,S2R,CRME,SRME,ECOEF1,ECOEF2,
     1      F1VAL,F2VAL,GVAL,V0VAL,F2COEF,CRHOE
C
      include 'isotop.h'
      include 'value.h'
      include 'molcul.h'
      include 'rentel.h'
      include 'integ.h'
      include 'dimen.h'
      include 'lsfit.h'
      include 'rensys.h'
      include 'bcoeff.h'
      include 'crcoef.h'
      include 'morse.h'
      include 'modim.h'
      include 'lzcomp.h'
C
      CR=COS(VALRHO)
C
      XIRR=(U1*U3-U13*U13*CR*CR)/(U1+U3+2.0E+00*U13*CR)/M
      XMURR=1.0D+00/XIRR
C
      RETURN
      END
